<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unified Command Center (Final Perfected)</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <!-- FontAwesome (Required for Campaign Wizard) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        primary: '#9c00ad',
                        'primary-light': '#b52cc4',
                        'primary-dark': '#4a0052',
                        secondary: '#fdf1ff',
                        tertiary: '#fdf9fd',
                        'primary-green': '#206e4d',
                        'lemon-green': '#84cc16',
                        'primary-red': '#b11d15',
                        'primary-orange': '#f97316',
                        'secondary-green': '#f7fffc',
                        'secondary-red': '#f5dedd',
                    },
                    boxShadow: {
                        'soft': '0 4px 20px rgba(0, 0, 0, 0.05)',
                        'card': '0 2px 8px rgba(0, 0, 0, 0.04)',
                        'popup': '0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <style>
        /* ================= CODE 1 CSS (DASHBOARD UTILITIES) ================= */
        .hidden { display: none !important; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        
        .dropdown-enter { opacity: 0; transform: scale(0.95) translateY(-10px); pointer-events: none; transition: all 0.2s ease; display: none; }
        .dropdown-active { opacity: 1; transform: scale(1) translateY(0); pointer-events: auto; display: block; }
        
        .submenu { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; opacity: 0; }
        .submenu.open { max-height: 200px; opacity: 1; }
        .arrow-rotate { transition: transform 0.3s; }
        .open .arrow-rotate { transform: rotate(180deg); }

        .drawer { transition: transform 0.3s ease-in-out; transform: translateX(100%); }
        .drawer.open { transform: translateX(0); }
        .overlay { transition: opacity 0.3s ease; opacity: 0; pointer-events: none; }
        .overlay.open { opacity: 1; pointer-events: auto; }

        .cal-view { display: none; animation: fadeIn 0.2s; height: 100%; }
        .cal-view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Toast and Modal Animations */
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-bounce-in { animation: bounceIn 0.4s ease-out; }
        @keyframes bounceIn { 0% { opacity: 0; transform: scale(0.9); } 70% { transform: scale(1.02); } 100% { opacity: 1; transform: scale(1); } }

        .chart-tooltip { opacity: 0; transition: opacity 0.1s; pointer-events: none; }
        .chart-dot { opacity: 0; transition: opacity 0.1s; pointer-events: none; }
        .chart-container:hover .chart-tooltip { opacity: 1; }
        .chart-container:hover .chart-dot { opacity: 1; }
        
        .scatter-tooltip { opacity: 0; transition: opacity 0.2s; pointer-events: none; }
        .scatter-point:hover + .scatter-tooltip { opacity: 1; }

        .icon-tooltip {
            visibility: hidden; opacity: 0; position: absolute; top: 100%; right: 0;
            background-color: #1f2937; color: white; padding: 8px 12px; border-radius: 6px;
            font-size: 11px; white-space: nowrap; z-index: 50; transform: translateY(5px);
            transition: all 0.2s; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .group:hover .icon-tooltip { visibility: visible; opacity: 1; transform: translateY(0); }

        @keyframes float-icon { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        .animate-float-icon { animation: float-icon 3s ease-in-out infinite; }

        /* Error Toast (Top Center & Black) */
        .error-toast {
            position: fixed; top: 8%; left: 50%; transform: translateX(-50%) translateY(-20px);
            background-color: #000000; color: white;
            padding: 16px 32px; border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            font-weight: 600; font-size: 16px;
            display: flex; align-items: center; gap: 12px;
            opacity: 0; pointer-events: none;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 10000;
        }
        .error-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

        /* FINAL: Performance Campaign Creator & Smart Shopping Page Styles */
        .perf-creator-wrapper { 
            display: flex; flex-direction: column; height: 100%; 
            background-color: #f8fafc;
        }
        .perf-creator-header {
            padding: 20px 32px; font-size: 18px; font-weight: 700; color: #1e293b;
            border-bottom: 1px solid #f1f5f9; background: #fff; flex-shrink: 0;
        }
        .perf-creator-body {
            flex-grow: 1; display: flex; flex-direction: column; align-items: center; /* Centered */
            padding: 48px 32px; overflow-y: auto;
        }
        .perf-creator-footer {
            padding: 20px 32px; border-top: 1px solid #f1f5f9; background: #fff;
            text-align: center; flex-shrink: 0;
        }
        .type-selection-container { display: flex; gap: 32px; }
        .type-card {
            width: 320px; padding: 24px; border-radius: 12px;
            border: 2px solid #e2e8f0 !important; background: #fff;
            cursor: pointer; position: relative; transition: all 0.2s ease;
        }
        .type-card:hover { border-color: #ced4da !important; }
        .type-card.selected { 
    border-color: #9c00ad !important; /* Force Purple Border */
    background-color: #fdf1ff !important; 
    box-shadow: 0 4px 14px 0 rgba(156, 0, 173, 0.1) !important; 
}
        .radio-check {
            position: absolute; top: 16px; left: 16px; width: 24px; height: 24px;
            border-radius: 50%; border: 2px solid #d1d5db; background: #fff;
            display: flex; align-items: center; justify-content: center;
        }
        /* Style for the icon itself */
        .radio-check .tick {
            font-size: 14px;
            font-weight: 900;
            color: transparent; /* Hide by default */
        }

        /* --- THE FIX --- */
        /* When the card is selected, force the border to be purple */
        .type-card.selected .radio-check {
            border-color: #9c00ad !important;
        }
        /* When the card is selected, force the icon inside to be purple */
        .type-card.selected .radio-check .tick {
            color: #9c00ad !important;
        }
        .type-card-img { height: 120px; margin: 16px 0; }
        .type-card-img img { height: 100%; width: 100%; object-fit: contain; }
        .type-card h4 { font-size: 16px; font-weight: 700; color: #1e293b; }
        .type-card p { font-size: 13px; color: #64748b; margin-top: 8px; line-height: 1.6; }

        .ss-page-layout { display: grid; grid-template-columns: 1fr 280px; gap: 32px; height: 100%; }
        .ss-main-content { overflow-y: auto; padding: 32px; }
        .ss-right-sidebar { background-color: #fff; border-left: 1px solid #f1f5f9; padding: 24px; overflow-y: auto; }
        .ss-banner { padding: 32px; background: linear-gradient(120deg, #4c1d95, #7c3aed); color: white; border-radius: 12px; margin-bottom: 32px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; text-align: center;}
        .ss-banner-item { border-left: 1px solid rgba(255,255,255,0.2); padding: 0 24px; }
        .ss-banner-item:first-child { border-left: none; }
        .ss-card { background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px; margin-bottom: 32px; }
        .ss-card h4 { font-size: 16px; font-weight: 700; color: #1e293b; margin-bottom: 24px; }
        .ss-input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; }
        .input-group-clean { margin-bottom: 16px; }
        .input-label { display: block; font-size: 13px; font-weight: 600; color: #334155; margin-bottom: 8px; }
        .clean-input { width: 100%; border: none; border-bottom: 2px solid #e2e8f0; padding: 12px 0; font-size: 15px; color: #0f172a; outline: none; background: transparent; transition: all 0.2s; }
        .clean-input:focus { border-bottom-color: var(--primary); }
        .ss-simulation-slider { display: grid; grid-template-columns: 120px 1fr 100px; align-items: center; gap: 16px; margin-bottom: 16px; font-size: 13px; color: #475569; }
        .slider-track { height: 6px; background: #e2e8f0; border-radius: 3px; position: relative; }
        .slider-progress { height: 100%; background: var(--primary); border-radius: 3px; position: relative; }
        .slider-thumb { width: 18px; height: 18px; border-radius: 50%; background: #fff; border: 5px solid var(--primary); position: absolute; top: 50%; right: 0; transform: translate(50%, -50%); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .ss-sidebar-item { display: flex; align-items: center; gap: 16px; padding: 16px; border-radius: 8px; cursor: pointer; border: 1px solid transparent; transition: all 0.2s; }
        .ss-sidebar-item:hover { background-color: #f8fafc; }
        .ss-sidebar-item.active { background-color: #fdf1ff; border-color: #e9d5ff; }
        .sidebar-status { font-size: 10px; font-weight: 700; padding: 2px 8px; border-radius: 10px; margin-left: auto; }
        .status-auto { background-color: #dcfce7; color: #166534; }
        .status-not-set { background-color: #fee2e2; color: #991b1b; }

     /* ================= CODE 2 CSS (CAMPAIGN WIZARD - CORRECTED) ================= */
        /* Wrapper to isolate Wizard Styles */
        :root {
            --cc-primary-color: #9c00ad; --cc-secondary-color: #fdf1ff; --cc-tertiary-color: #fdf9fd;
            --cc-primary-red: #b11d15; --cc-primary-green: #206e4d; --cc-text-dark: #2c3e50;
            --cc-text-light: #798795; --cc-border-color: #e4e7eb; --cc-background-color: #f8f9fa;
        }

        .wizard-wrapper {
            font-family: 'Inter', sans-serif; 
            background-color: var(--cc-background-color);
            color: var(--cc-text-dark); 
            padding: 24px;
            height: calc(100vh - 64px); /* Fixed height based on viewport minus header */
            max-height: calc(100vh - 64px);
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            overflow: hidden; /* Prevent wrapper from scrolling, let inner container scroll */
        }

        .cc-module-container { max-width: 1400px; margin: auto; width: 100%; display: flex; flex-direction: column; flex: 1; overflow: hidden; min-height: 0; }
        .cc-button { padding: 10px 20px; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: background-color 0.2s ease; }
        .placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; color: var(--cc-text-light); padding: 40px; min-height: 200px; }
        .placeholder i { font-size: 40px; margin-bottom: 16px; }

/* Error Toast Notification */
        /* Error Toast (Top Center & Black) */
        .error-toast {
            position: fixed; top: 8%; left: 50%; transform: translateX(-50%) translateY(-20px);
            background-color: #000000; color: white;
            padding: 16px 32px; border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            font-weight: 600; font-size: 16px;
            display: flex; align-items: center; gap: 12px;
            opacity: 0; pointer-events: none;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 10000;
        }
        .error-toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }    
/* Wizard Stepper */
        .cc-header { background-color: #ffffff; padding: 16px 24px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 24px; flex-shrink: 0; }
        .cc-stepper { display: flex; align-items: center; }
        .cc-step { display: flex; align-items: center; gap: 12px; padding: 8px 16px; color: var(--cc-text-light); font-weight: 600; font-size: 14px; position: relative; border-bottom: 3px solid transparent; }
        .cc-step.active { color: var(--cc-primary-color); border-bottom-color: var(--cc-primary-color); }
        .step-content { display: none; height: 100%; overflow-y: auto; }
        .step-content.active { display: block; animation: fadeIn 0.3s ease; }
        
        /* THE FIX: Main content area takes remaining space and handles scrolling */
        .cc-steps-container { 
            flex: 1; 
            overflow-y: auto; 
            min-height: 0; /* Important for flex child scrolling */
            padding-right: 5px; /* Prevent scrollbar overlap */
            max-height: 100%; /* Ensure it doesn't exceed parent */
        }
        
        .cc-footer { display: flex; justify-content: space-between; margin-top: 24px; flex-shrink: 0; padding-bottom: 20px; }

        /* Wizard Inventory Step */
/* NEW: Tree Table Styles */
        .inventory-parent-row { background-color: #f9fafb; cursor: pointer; transition: background 0.2s; }
        .inventory-parent-row:hover { background-color: #f3f4f6; }
        .inventory-parent-row td { font-weight: 700; color: #374151; border-bottom: 1px solid #e5e7eb; }
        .inventory-child-row { background-color: #ffffff; animation: fadeIn 0.2s ease; }
        .inventory-child-row td:first-child { padding-left: 40px !important; }
        .expand-icon { transition: transform 0.2s; color: #9ca3af; margin-right: 8px; }
        .inventory-parent-row.expanded .expand-icon { transform: rotate(90deg); color: var(--cc-primary-color); }
        .inventory-workspace { display: grid; grid-template-columns: 270px 1fr 340px; gap: 24px; align-items: flex-start; }
        .inventory-column { background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .inventory-column-header { padding: 16px; border-bottom: 1px solid var(--cc-border-color); }
        .inventory-column-header h3 { margin: 0; font-size: 16px; display: flex; align-items: center; gap: 8px; }
        .inventory-column-header .count-badge { background-color: var(--cc-secondary-color); color: var(--cc-primary-color); font-size: 12px; padding: 4px 8px; border-radius: 12px; font-weight: 700; }
        .inventory-column-content { padding: 16px; }
        .page-card { border: 1px solid var(--cc-border-color); border-radius: 6px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s ease; }
        .page-card:hover { border-color: var(--cc-primary-color); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .page-card.selected { border-color: var(--cc-primary-color); background-color: var(--cc-secondary-color); border-width: 2px; padding: 15px; }
        .page-card-header { display: flex; align-items: center; gap: 12px; font-size: 16px; font-weight: 700; }
        .page-card-stats { margin-top: 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px; color: var(--cc-text-light); }
        .page-card-stats strong { color: var(--cc-text-dark); font-weight: 600; }
        .inventory-summary { position: sticky; top: 0; }
        .summary-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--cc-border-color); }
        .summary-item:last-child { border: none; }
        .summary-item-info { font-size: 14px; }
        .summary-item .remove-btn { color: var(--cc-primary-red); cursor: pointer; font-size: 16px; }
        .inventory-table-wrapper { max-height: 400px; overflow-y: scroll; position: relative; }
        .inventory-controls { position: sticky; top: 0; background-color: #ffffff; z-index: 11; padding-bottom: 16px; }
        .search-wrapper { position: relative; flex-grow: 1; }
        .search-wrapper i { position: absolute; top: 50%; left: 12px; transform: translateY(-50%); color: var(--cc-text-light); }
        #inventory-search { width: 100%; padding: 10px 10px 10px 35px; border: 1px solid var(--cc-border-color); border-radius: 6px; font-size: 14px; box-sizing: border-box; }
        .inventory-table { width: 100%; border-collapse: collapse; }
        .inventory-table thead th { position: sticky; top: 0; background-color: #ffffff; z-index: 10; }
        .inventory-table th { color: var(--cc-text-light); font-weight: 600; padding: 12px; text-align: left; border-bottom: 1px solid var(--cc-border-color); font-size: 14px; }
        .inventory-table th.sortable { cursor: pointer; } .inventory-table th.sortable:hover { color: var(--cc-text-dark); }
        .inventory-table th .sort-icon { margin-left: 8px; color: var(--cc-border-color); } .inventory-table th.active .sort-icon { color: var(--cc-primary-color); }
        .inventory-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--cc-border-color); font-size: 14px; }
        .inventory-thumb { width: 40px; height: 40px; border-radius: 4px; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center; color: var(--cc-text-light); }
        .tag { background-color: #eee; color: #555; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500;}
        .select-btn { background-color: transparent; color: var(--cc-primary-color); border: 1px solid var(--cc-primary-color); padding: 6px 16px; border-radius: 6px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .select-btn:hover { background-color: var(--cc-secondary-color); }
        .selected-status { color: var(--cc-primary-green); font-weight: 700; display: flex; align-items: center; gap: 6px; }
        .delete-icon { color: var(--cc-text-light); cursor: pointer; font-size: 16px; margin-left: 20px; } .delete-icon:hover { color: var(--cc-primary-red); }
        .action-col { text-align: center; }
        .pagination-controls { display: flex; justify-content: space-between; align-items: center; padding-top: 16px; font-size: 14px; color: var(--cc-text-light); }
        .pagination-buttons button { background: #fff; border: 1px solid var(--cc-border-color); color: var(--cc-text-dark); padding: 6px 12px; margin: 0 2px; border-radius: 4px; cursor: pointer; }
        .pagination-buttons button.active { background-color: var(--cc-primary-color); color: #fff; border-color: var(--cc-primary-color); }
        
        /* Wizard Targeting Step */
        .targeting-page-content { background-color: #ffffff; padding: 24px 32px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .targeting-accordion .accordion-item { border: 1px solid var(--cc-border-color); border-radius: 8px; margin-bottom: 16px; transition: all 0.3s ease; }
        .targeting-accordion .accordion-item.open { box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-color: var(--cc-primary-color); }
        .accordion-header { display: flex; align-items: center; padding: 20px; cursor: pointer; }
        .accordion-icon { font-size: 24px; color: var(--cc-primary-color); margin-right: 20px; width: 30px; text-align: center; }
        .accordion-title-block { flex-grow: 1; } .accordion-title-block h4 { margin: 0; font-size: 16px; } .accordion-title-block p { margin: 4px 0 0; font-size: 14px; color: var(--cc-text-light); }
        .accordion-summary { font-size: 14px; font-weight: 600; color: var(--cc-primary-green); }
        .accordion-badge { background-color: #eee; color: var(--cc-text-dark); font-weight: 600; padding: 6px 12px; border-radius: 16px; font-size: 12px; margin-left: 16px; }
        .accordion-badge.manual { background-color: var(--cc-secondary-color); color: var(--cc-primary-color); }
        .accordion-arrow { font-size: 16px; margin-left: 24px; transition: transform 0.3s ease; } .accordion-item.open .accordion-arrow { transform: rotate(180deg); }
        .accordion-content { display: none; padding: 0 24px 24px 24px; border-top: 1px solid var(--cc-border-color); }
        .generic-tabs { display: flex; border-bottom: 1px solid var(--cc-border-color); margin-bottom: 16px; }
        .generic-tab { padding: 10px 16px; cursor: pointer; font-weight: 600; border-bottom: 3px solid transparent; }
        .generic-tab.active { color: var(--cc-primary-color); border-bottom-color: var(--cc-primary-color); }
        .form-input { width: 100%; border: 1px solid var(--cc-border-color); border-radius: 6px; padding: 8px 12px; font-size: 14px; box-sizing: border-box; }
        .form-select { width: 100%; border: 1px solid var(--cc-border-color); border-radius: 6px; padding: 8px 12px; font-size: 14px; background-color: #fff; }
        
        .geo-location-content { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; padding-top: 24px; }
        .geo-column h5 { margin: 0 0 12px 0; font-size: 14px; }
        .location-input-wrapper { display: flex; align-items: center; gap: 8px; }
        .location-input-wrapper .icon { font-size: 16px; } .location-input-wrapper .plus { color: var(--cc-primary-green); } .location-input-wrapper .minus { color: var(--cc-primary-red); }
        .location-input { width: 100%; border: none; border-bottom: 1px solid var(--cc-border-color); padding: 8px 0; font-size: 14px; } .location-input:focus { outline: none; border-bottom-color: var(--cc-primary-color); }
        .location-pills { margin-top: 16px; display: flex; flex-wrap: wrap; gap: 8px; min-height: 30px; }
        .location-pill { display: flex; align-items: center; gap: 6px; background-color: var(--cc-secondary-color); color: var(--cc-primary-color); padding: 6px 12px; border-radius: 16px; font-size: 13px; font-weight: 600; }
        .location-pill.exclude { background-color: #f5dedd; color: var(--cc-primary-red); } .location-pill .remove-pill { cursor: pointer; }
        
        .audience-content { display: grid; grid-template-columns: 2fr 1fr; gap: 32px; padding-top: 24px; }
        .audience-list { max-height: 250px; overflow-y: auto; }
        .audience-item { display: flex; align-items: center; padding: 12px; border-radius: 6px; cursor: pointer; } .audience-item:hover { background-color: #f9f9f9; }
        .audience-item input { margin-right: 12px; } .audience-item p { margin: 0; font-size: 12px; color: var(--cc-text-light); }
        .audience-reach-panel { text-align: center; background-color: var(--cc-tertiary-color); padding: 24px; border-radius: 8px; } .audience-reach-panel h5 { margin: 0 0 16px 0; }
        .audience-reach-gauge { width: 150px; height: 75px; border-top-left-radius: 150px; border-top-right-radius: 150px; background: conic-gradient(from -90deg, #b11d15, #ffeb3b, #206e4d); position: relative; margin: auto; }
        .audience-reach-gauge::after { content: ''; position: absolute; left: 10px; right: 10px; top: 10px; bottom: 0; background: var(--cc-tertiary-color); border-top-left-radius: 140px; border-top-right-radius: 140px; }
        .reach-needle { width: 2px; height: 65px; background: var(--cc-text-dark); position: absolute; left: 50%; bottom: 0; transform-origin: bottom center; transition: transform 0.5s ease; z-index: 2; }
        .reach-value { font-size: 24px; font-weight: 700; margin-top: 16px; }
        
        .rule-builder .rule-row { display: grid; grid-template-columns: 1fr 1fr 1fr auto; align-items: center; gap: 12px; margin-bottom: 12px; }
        .rule-builder .remove-rule-btn, .rule-builder .add-rule-btn { color: var(--cc-text-light); cursor: pointer; font-size: 16px; } .rule-builder .add-rule-btn { color: var(--cc-primary-color); }
        .keyword-content { padding-top: 24px; } .keyword-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .keyword-table { width: 100%; border-collapse: collapse; } .keyword-table th, .keyword-table td { text-align: left; padding: 12px; border-bottom: 1px solid var(--cc-border-color); }
        .toggle-switch { width: 40px; height: 22px; background: #ccc; border-radius: 11px; position: relative; cursor: pointer; transition: background-color 0.3s; }
        .toggle-switch.checked { background-color: var(--cc-primary-green); }
        .toggle-switch .slider { position: absolute; top: 2px; left: 2px; width: 18px; height: 18px; background: #fff; border-radius: 50%; transition: 0.3s; }
        .toggle-switch.checked .slider { transform: translateX(18px); }
        
        .product-catalog-content { padding-top: 24px; }
        .upload-area { border: 2px dashed var(--cc-border-color); border-radius: 8px; padding: 40px; text-align: center; margin-top: 16px; cursor: pointer; transition: background-color 0.2s ease, border-color 0.2s ease; }
        .upload-area:hover { background-color: var(--cc-tertiary-color); border-color: var(--cc-primary-color); }
        .upload-area i { font-size: 40px; color: var(--cc-primary-color); } .upload-area p { margin: 16px 0 8px 0; font-weight: 600; pointer-events: none; } .upload-area a { color: var(--cc-primary-color); font-weight: 600; text-decoration: none; pointer-events: none; }

        /* Wizard Ads Step */
/* NEW: Ad Card Styles */
        .ad-card { border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: #fff; transition: all 0.2s ease; display: flex; flex-direction: column; }
        .ad-card:hover { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); transform: translateY(-2px); }
        
        .ad-image-wrapper { position: relative; height: 180px; background-color: #f3f4f6; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .ad-image-wrapper img { width: 100%; height: 100%; object-fit: cover; }
        
        .card-expand-icon { position: absolute; top: 10px; right: 10px; width: 24px; height: 24px; background-color: rgba(0,0,0,0.6); color: white; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: background 0.2s; opacity: 0; }
        .ad-card:hover .card-expand-icon { opacity: 1; }
        .card-expand-icon:hover { background-color: rgba(0,0,0,0.8); }

        .ad-card-footer { padding: 12px; border-top: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; background-color: #fff; }
        
        .ad-status-indicator { display: flex; align-items: center; gap: 6px; font-size: 11px; font-weight: 700; }
        .status-yellow { color: #d97706; } /* Under Review */
        .status-green { color: #16a34a; }  /* Approved */
        .status-red { color: #dc2626; }    /* Rejected */

        .ad-actions { display: flex; gap: 10px; }
        .action-icon-btn { color: #6b7280; cursor: pointer; font-size: 16px; transition: color 0.2s; }
        .action-icon-btn:hover { color: var(--cc-primary-color); }
        .ads-workspace { display: grid; grid-template-columns: 300px 1fr; background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); min-height: 60vh; }
        .inventory-nav-panel { border-right: 1px solid var(--cc-border-color); padding: 16px; }
        .inventory-nav-list { list-style: none; margin: 0; padding: 0; }
        .inventory-nav-item .item-header { display: flex; align-items: center; padding: 12px; border-radius: 6px; cursor: pointer; }
        .inventory-nav-item .item-header:hover { background-color: #f9f9f9; } .inventory-nav-item.active > .item-header { background-color: var(--cc-tertiary-color); }
        .inventory-nav-item .item-icon { color: var(--cc-text-light); margin-right: 12px; } .inventory-nav-item .item-info { flex-grow: 1; }
        .inventory-nav-item .item-info h5 { margin: 0; font-size: 14px; }
        .inventory-nav-item .item-info p { margin: 2px 0 0; font-size: 12px; color: var(--cc-text-light); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .inventory-nav-item .expand-arrow { transition: transform 0.2s ease; margin-left: auto; } .inventory-nav-item.open > .item-header .expand-arrow { transform: rotate(90deg); }
        .ad-type-list { list-style: none; padding-left: 30px; display: none; } .inventory-nav-item.open > .ad-type-list { display: block; }
        .ad-type-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; border-radius: 6px; cursor: pointer; font-size: 14px; }
        .ad-type-item:hover { background-color: #f9f9f9; } .ad-type-item.active { background-color: var(--cc-secondary-color); color: var(--cc-primary-color); font-weight: 600; }
        .ad-type-item .ad-count { font-size: 12px; background-color: var(--cc-border-color); color: var(--cc-text-light); padding: 2px 8px; border-radius: 10px; }
        .ad-type-item.active .ad-count { background-color: var(--cc-primary-color); color: #fff; }
        .ad-details-panel { padding: 24px 32px; } .ad-details-panel h3 { margin: 0; } .ad-details-panel .panel-desc { color: var(--cc-text-light); font-size: 14px; margin-top: 4px; }
        
        /* Wizard Modal (Redesigned & Spacious) */
        .modal-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 100; display: none; backdrop-filter: blur(4px); }
        
        .modal { 
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            background: #fff; border-radius: 12px; z-index: 101; 
            width: 1200px; max-width: 95vw; height: 85vh; /* Much Larger */
            display: none; flex-direction: column; overflow: hidden; /* Flex column for sticky header/footer */
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .modal-header { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 20px 32px; border-bottom: 1px solid #f1f5f9; background: #fff; 
        }
        .modal-header h4 { margin: 0; font-size: 18px; font-weight: 700; color: #1e293b; }
        .modal-header .close-btn { font-size: 24px; cursor: pointer; color: #94a3b8; transition: color 0.2s; }
        .modal-header .close-btn:hover { color: #ef4444; }

        /* Split Body */
        .modal-body-split { 
            display: grid; grid-template-columns: 1fr 1fr; 
            flex: 1; overflow: hidden; /* Takes remaining height */
        }

        /* Left Panel (Inputs) */
        .modal-left-panel { 
            padding: 40px; /* Spacious Padding */
            overflow-y: auto; 
            background-color: #fff;
        }

        /* Right Panel (Preview) */
        .modal-right-panel { 
            background-color: #f8fafc; /* Light Gray Canvas */
            border-left: 1px solid #f1f5f9; 
            padding: 40px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative;
        }
        
        /* Form Elements */
        .input-group-clean { margin-bottom: 32px; } /* More vertical gap */
        .input-label { display: block; font-size: 13px; font-weight: 600; color: #334155; margin-bottom: 8px; }
        .input-label span { color: #cbd5e1; font-weight: 400; font-size: 11px; float: right; }
        
        .clean-input { 
            width: 100%; border: none; border-bottom: 2px solid #e2e8f0; 
            padding: 12px 0; font-size: 15px; color: #0f172a; outline: none; background: transparent; transition: all 0.2s; 
        }
        .clean-input:focus { border-bottom-color: var(--cc-primary-color); }
        .clean-input::placeholder { color: #cbd5e1; }

        /* Upload Grid */
        .upload-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px; }
        .upload-card { border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; transition: all 0.2s; }
        .upload-card:hover { border-color: var(--cc-primary-color); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        
        .upload-dashed { 
            height: 160px; /* Taller */
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            background-color: #fff; cursor: pointer;
        }
        .upload-dashed:hover { background-color: #fdf1ff; }
/* Upload Actions (Delete/Replace) */
        .upload-action-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center; gap: 10px;
            z-index: 10;
        }
        .upload-card:hover .upload-action-overlay.has-file { display: flex; }
        .icon-btn-sm { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; border: 1px solid #e2e8f0; background: white; }
        .icon-btn-sm:hover { transform: scale(1.1); }
        .btn-delete { color: #ef4444; border-color: #fecaca; }
        .btn-replace { color: var(--cc-primary-color); border-color: #e9d5ff; }
        .upload-meta { background: #f8fafc; padding: 10px 16px; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; font-size: 11px; font-weight: 600; color: #64748b; }

        /* Preview Mockup */
        .preview-label { position: absolute; top: 24px; left: 24px; font-size: 12px; font-weight: 700; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        .device-mockup { 
            width: 320px; background: #fff; border-radius: 16px; 
            box-shadow: 0 20px 40px -5px rgba(0,0,0,0.1); border: 4px solid #fff; overflow: hidden;
        }
        .mockup-header { padding: 16px; border-bottom: 1px solid #f1f5f9; display: flex; align-items: center; gap: 12px; color: #64748b; font-size: 12px; }
        .mockup-body { padding: 16px; }

        .modal-footer { padding: 20px 32px; border-top: 1px solid #f1f5f9; text-align: right; background: #fff; flex-shrink: 0; }
        
        /* Wizard Config & Calendar */
        .config-workspace { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; align-items: flex-start; }
        .config-card { background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); padding: 24px; }
        .config-card h4 { margin: 0 0 20px 0; font-size: 16px; display: flex; align-items: center; gap: 8px; }
        .config-main .form-group label { display: flex; align-items: center; gap: 6px; } .config-main .form-group label .info-icon { color: var(--cc-text-light); cursor: help; }
        .config-main .form-input:focus { outline: none; border-color: var(--cc-primary-color); box-shadow: 0 0 0 2px var(--cc-secondary-color); }
        .config-main .form-input.read-only { background-color: #f5f5f5; cursor: not-allowed; }
        .config-main .helper-text { font-size: 12px; color: var(--cc-text-light); margin-top: 6px; }
        .date-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .date-input-wrapper { position: relative; }
        .date-input-wrapper .calendar-icon { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--cc-text-light); cursor: pointer; }
        
        /* Wizard Specific Popup Calendar */
        .calendar-popup { display: none; position: absolute; top: 105%; left: 0; z-index: 100; width: 300px; background: #fff; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); padding: 16px; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .calendar-nav { background: none; border: none; cursor: pointer; font-size: 18px; color: var(--cc-text-light); } .calendar-nav:disabled { color: #ccc; cursor: not-allowed; }
        .calendar-title { font-weight: 600; cursor: pointer; }
        .calendar-grid, .month-grid, .year-list { display: grid; }
        .calendar-grid { grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-grid div { text-align: center; padding: 8px; border-radius: 4px; cursor: pointer; }
        .calendar-grid .day-name { font-size: 12px; font-weight: 600; color: var(--cc-text-light); cursor: default; }
        .calendar-grid .day:not(.disabled):hover { background-color: var(--cc-tertiary-color); }
        .calendar-grid .day.disabled { color: #ccc; cursor: not-allowed; background-color: #fff; }
        .calendar-grid .day.selected { background-color: var(--cc-primary-color); color: #fff; }
        .month-grid { grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .month-grid .month { text-align: center; padding: 12px; border-radius: 4px; cursor: pointer; }
        .month-grid .month:not(.disabled):hover { background-color: var(--cc-tertiary-color); }
        .month-grid .month.selected { background-color: var(--cc-primary-color); color: #fff; }
        .month-grid .month.disabled { color: #ccc; cursor: not-allowed; background-color: #fff; }
        .year-list { max-height: 220px; overflow-y: auto; }
        .year-list .year { text-align: center; padding: 8px; border-radius: 4px; cursor: pointer; }
        .year-list .year:not(.disabled):hover { background-color: var(--cc-tertiary-color); }
        .year-list .year.selected { background-color: var(--cc-primary-color); color: #fff; font-weight: 600; }
        .year-list .year.disabled { color: #ccc; cursor: not-allowed; background-color: #fff; }
        
        .budget-inputs { display: grid; grid-template-columns: 1fr auto 1fr; gap: 12px; align-items: center; }
        .budget-swap-btn { height: 30px; width: 30px; border-radius: 50%; border: 1px solid var(--cc-border-color); background: #fff; cursor: pointer; color: var(--cc-text-light); transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; }
        .budget-swap-btn:hover { color: var(--cc-primary-color); border-color: var(--cc-primary-color); }
        
        .summary-panel .summary-item { display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--cc-border-color); }
        .summary-panel .summary-item:last-child { border-bottom: none; }
        .summary-panel .summary-item .label { font-weight: 600; display: flex; align-items: center; gap: 6px; }
        .summary-panel .summary-item .value { font-weight: 600; font-size: 18px; }
        .summary-panel .summary-item .desc { font-size: 13px; color: var(--cc-text-light); text-align: right; } .summary-panel .summary-item .desc i { margin-right: 6px; }

        /* UPDATED: Uniform Grid Layout */
        .ad-thumbnails-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); 
            gap: 24px; 
            margin-top: 24px; 
            align-items: stretch; 
        }

        /* Card Styles */
        .ad-card { 
            border: 1px solid #e5e7eb; 
            border-radius: 8px; 
            overflow: hidden; 
            background: #fff; 
            transition: all 0.2s ease; 
            display: flex; 
            flex-direction: column; 
            height: 100%; 
        }
        .ad-card:hover { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); transform: translateY(-2px); }
        
        .ad-image-wrapper { position: relative; height: 200px; background-color: #f3f4f6; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .ad-image-wrapper img { width: 100%; height: 100%; object-fit: cover; }
        
        /* New Ad Button (Matches Card Dimensions) */
        .add-new-ad-btn { 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            width: 100%; 
            height: 100%; 
            min-height: 250px; 
            border: 2px dashed #e5e7eb; 
            border-radius: 8px; 
            cursor: pointer; 
            color: #9ca3af; 
            transition: all 0.2s ease; 
            background-color: #f9fafb;
        }
        .add-new-ad-btn:hover { border-color: var(--cc-primary-color); color: var(--cc-primary-color); background-color: var(--cc-tertiary-color); }
        .add-new-ad-btn i { font-size: 32px; margin-bottom: 12px; }
/* --- FONT STYLE FIXES (Match Screenshots) --- */
        /* 1. Global Wizard Headers */
        .wizard-wrapper h2 { font-weight: 700; color: #111827; letter-spacing: -0.5px; }
        
        /* 2. Step 1: Inventory Fonts */
        .inventory-column-header h3 { font-weight: 700; color: #1f2937; }
        .page-card-header { font-weight: 700; color: #111827; }
        .page-card-stats strong { font-weight: 700; color: #374151; }
        .inventory-table th { font-weight: 600; color: #374151; }
        .summary-item-info strong { font-weight: 600; color: #1f2937; }

        /* 3. Step 2: Targeting Fonts */
        .accordion-title-block h4 { font-weight: 700; color: #1f2937; }
        .accordion-summary { font-weight: 600; }
        .accordion-badge { font-weight: 700; }
        .audience-item h4 { font-weight: 600; color: #1f2937; }

        /* 4. Step 3: Ads Fonts */
        .inventory-nav-item .item-info h5 { font-weight: 600; color: #374151; }
        .inventory-nav-item.active .item-info h5 { font-weight: 700; color: #111827; }
        .ad-details-panel h3 { font-weight: 700; color: #111827; }
        .ad-thumbnail .thumb-info h6 { font-weight: 600; }

        /* 5. Step 4: Config Fonts */
        .config-card h4 { font-weight: 700; color: #1f2937; }
        .form-group label { font-weight: 600; color: #374151; }
        .summary-panel .summary-item .label { font-weight: 600; color: #4b5563; }
        .summary-panel .summary-item .value { font-weight: 700; color: #111827; }
/* --- WIZARD SPLIT LAYOUT (OPTION B) --- */
.wizard-body-split {
    display: flex;
    height: 100%;
    overflow: hidden;
    background-color: #f8fafc;
}

/* Left Sidebar (Table of Contents) */
.wizard-sidebar {
    width: 260px;
    background: #fff;
    border-right: 1px solid #e2e8f0;
    padding: 24px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.wiz-toc-header {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    color: #94a3b8;
    margin-bottom: 12px;
    letter-spacing: 0.05em;
}

.wiz-toc-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 14px;
    border-radius: 6px;
    color: #64748b;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.wiz-toc-item:hover {
    background-color: #f1f5f9;
    color: #334155;
}

.wiz-toc-item.active {
    background-color: #fdf1ff;
    color: #9c00ad;
    border-left: 3px solid #9c00ad;
}

.wiz-toc-icon { font-size: 16px; }

/* Right Content Area */
.wizard-content-area {
    flex: 1;
    overflow-y: auto;
    padding: 32px 48px;
    scroll-behavior: smooth;
}

/* Content Cards */
.wiz-section-card {
    background: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.03);
}

.wiz-card-title {
    font-size: 15px;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid #f1f5f9;
}
/* --- FIXED APP LAYOUT (RESPECTING SIDEBAR & HEADER) --- */

.wizard-wrapper {
    /* Position ABSOLUTE inside the main content area */
    position: absolute !important; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%;
    background-color: #f8fafc;
    z-index: 40; /* Sits on top of the Overview/Performance tables */
    padding: 0 !important;
    margin: 0 !important;
    display: flex;
    flex-direction: column;
}

/* Flex Container manages the vertical stack (Header - Body - Footer) */
.cc-module-container {
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
}

/* 1. WIZARD HEADER: Fixed Height */
.cc-header {
    flex: 0 0 auto; /* Don't shrink */
    background: #fff;
    border-bottom: 1px solid #e2e8f0;
    padding: 16px 32px;
}

/* 2. WIZARD BODY: Fills remaining space, No Scroll here */
.cc-steps-container {
    flex: 1;
    overflow: hidden; /* Important: Stop global scroll */
    position: relative;
}

.step-content {
    height: 100%;
}

.wizard-body-split {
    display: flex;
    height: 100%;
    overflow: hidden;
}

/* 3. LEFT SIDEBAR: Independent Scroll */
.wizard-sidebar {
    width: 260px;
    height: 100%;
    overflow-y: auto;
    flex-shrink: 0;
    background: #fff;
    border-right: 1px solid #e2e8f0;
    padding: 24px;
    padding-bottom: 100px; /* Space for scrolling */
}

/* 4. RIGHT CONTENT: Independent Scroll */
.wizard-content-area {
    flex: 1;
    height: 100%;
    overflow-y: auto;
    padding: 32px 48px;
    scroll-behavior: smooth;
    padding-bottom: 120px; /* Extra space so content isn't cut off */
}

/* 5. FOOTER: Fixed at Bottom */
.cc-footer {
    flex: 0 0 auto; /* Don't shrink */
    background: #fff;
    border-top: 1px solid #e2e8f0;
    padding: 16px 32px;
    z-index: 50;
}

/* Spacing Tweaks */
.input-group-clean { margin-bottom: 16px; }
.wiz-section-card { margin-bottom: 24px; }

    </style>
</head>
<body class="bg-gray-50 text-gray-800 flex h-screen overflow-hidden text-sm">

    <!-- ================= 1. LEFT SIDEBAR ================= -->
    <aside class="w-64 bg-primary text-white flex flex-col flex-shrink-0 shadow-xl z-50">
        <!-- Brand Selector (FIXED: 5 BRANDS RESTORED) -->
        <div class="px-5 pt-6 pb-4 border-b border-white/10 relative dropdown-container">
            <div class="text-[10px] uppercase text-white/50 font-bold mb-2 tracking-wider">Select Brand:</div>
            <div onclick="toggleId('brandDropdown')" class="flex items-start gap-3 cursor-pointer hover:opacity-80 transition w-full group">
                <div class="w-8 h-8 rounded bg-white text-primary flex items-center justify-center text-sm font-bold mt-0.5">F</div>
                <div class="leading-tight">
                    <div class="font-bold text-sm" id="brandHeaderName">Faces Canada</div>
                    <div class="text-xs text-white/70" id="brandHeaderCount">383</div>
                </div>
                <i class="ri-arrow-down-s-line ml-auto opacity-70 mt-1 group-hover:text-white"></i>
            </div>
            <div id="brandDropdown" class="dropdown-enter absolute top-16 left-2 w-56 bg-white text-gray-800 rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                <div class="max-h-[250px] overflow-y-auto">
                    <div onclick="selectBrand('Alps Goodness', 120)" class="px-4 py-2 hover:bg-purple-50 cursor-pointer border-b border-gray-50 text-xs">Alps Goodness (120)</div>
                    <div onclick="selectBrand('Stay Quirky', 85)" class="px-4 py-2 hover:bg-purple-50 cursor-pointer border-b border-gray-50 text-xs">Stay Quirky (85)</div>
                    <div onclick="selectBrand('Faces Canada', 383)" class="px-4 py-2 bg-purple-50 font-bold cursor-pointer border-b border-gray-50 text-xs text-primary">Faces Canada (383)</div>
                    <div onclick="selectBrand('Mamaearth', 620)" class="px-4 py-2 hover:bg-purple-50 cursor-pointer border-b border-gray-50 text-xs">Mamaearth (620)</div>
                    <div onclick="selectBrand('Lakme', 480)" class="px-4 py-2 hover:bg-purple-50 cursor-pointer border-b border-gray-50 text-xs">Lakme (480)</div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 overflow-y-auto py-2 space-y-1 px-4">
            <!-- 1. Overview -->
            <a href="#" onclick="navigateTo('overview', 'nav-overview', 'Home / <span class=\'text-primary font-bold\'>Overview</span>')" id="nav-overview" class="nav-item flex items-center justify-between px-4 py-3 text-white font-bold bg-white/10 rounded-lg transition group mb-1 shadow-inner">
                <div class="flex items-center gap-3"><i class="ri-home-line text-lg"></i> <span class="font-medium">Overview</span></div>
            </a>
            <!-- 2. Campaign (Expanded) -->
            <div class="bg-white/5 rounded-lg pb-2 group open">
                <div onclick="toggleSubmenu('campSub')" class="flex items-center justify-between px-4 py-3 text-white font-bold rounded-lg transition cursor-pointer">
                    <div class="flex items-center gap-3"><i class="ri-megaphone-line text-lg"></i> <span>Campaign</span></div>
                    <i class="ri-arrow-up-s-line arrow-rotate" style="transform: rotate(180deg);"></i>
                </div>
                <div id="campSub" class="submenu pl-12 pr-2 space-y-1 open" style="max-height: 200px; opacity: 1;">
                    <!-- Awareness Sub-Menu (Visibility & Takeover) -->
                    <div class="relative">
                        <div onclick="toggleSubmenu('awarenessSub')" class="nav-sub-item flex items-center justify-between px-2 py-2 text-xs text-white/60 hover:text-white hover:bg-white/10 rounded transition cursor-pointer select-none">
                            <span>Awareness</span>
                            <i class="ri-arrow-down-s-line arrow-rotate transition-transform duration-300" style="transform: rotate(0deg);"></i>
                        </div>
                        <div id="awarenessSub" class="submenu pl-4 space-y-1 overflow-hidden transition-all duration-300" style="max-height: 0px; opacity: 0;">
                            <a href="#" onclick="navigateTo('awareness'); updateAwarenessView(this, 'Visibility')" class="awareness-link block px-2 py-2 text-xs text-white/50 hover:text-white hover:bg-white/5 rounded transition">Visibility</a>
                            <a href="#" onclick="navigateTo('awareness'); updateAwarenessView(this, 'Takeover')" class="awareness-link block px-2 py-2 text-xs text-white/50 hover:text-white hover:bg-white/5 rounded transition">Takeover</a>
                        </div>
                    </div>
                    <!-- Performance Sub-Menu (With Active Logic) -->
                    <div class="relative">
                        <div onclick="toggleSubmenu('perfSub')" class="nav-sub-item flex items-center justify-between px-2 py-2 text-xs text-white/60 hover:text-white hover:bg-white/10 rounded transition cursor-pointer select-none">
                            <span>Performance</span>
                            <i class="ri-arrow-down-s-line arrow-rotate transition-transform duration-300"></i>
                        </div>
                        <div id="perfSub" class="submenu pl-4 space-y-1 overflow-hidden transition-all duration-300" style="max-height: 0; opacity: 0;">
                            <!-- Added 'this' to the onclick function -->
                            <a href="#" onclick="navigateTo('performance'); updatePerfView(this, 'Smart Shopping')" class="perf-link block px-2 py-2 text-xs text-white/50 hover:text-white hover:bg-white/5 rounded transition">Smart Shopping</a>
                            <a href="#" onclick="navigateTo('performance'); updatePerfView(this, 'Search Only')" class="perf-link block px-2 py-2 text-xs text-white/50 hover:text-white hover:bg-white/5 rounded transition">Search Only</a>
                        </div>
                                        </div>
                    <!-- Bundles (Fixed Packages) -->
                    <a href="#" onclick="navigateTo('bundles', '', 'Home / Campaigns / <span class=\'text-primary font-bold\'>Bundles</span>')" class="block px-2 py-2 text-xs text-white/50 hover:text-white hover:bg-white/5 rounded transition">
                        Bundles
                    </a>

                    
                </div>
            </div>
            <!-- 3. Balance & Manage -->
            <a href="#" onclick="navigateTo('balance', 'nav-balance', 'Home / <span class=\'text-primary font-bold\'>Balance & Manage</span>')" id="nav-balance" class="nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group mt-1">
                <div class="flex items-center gap-3"><i class="ri-wallet-3-line text-lg"></i> Balance & Manage</div>
            </a>
            <!-- 4. Transaction -->
            <a href="#" onclick="navigateTo('transactions', 'nav-transactions', 'Home / <span class=\'text-primary font-bold\'>Transactions</span>')" id="nav-transactions" class="nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group">
                <div class="flex items-center gap-3"><i class="ri-exchange-dollar-line text-lg"></i> Transaction</div>
            </a>
            <!-- 5. Change History -->
            <a href="#" onclick="navigateTo('history', 'nav-history', 'Home / <span class=\'text-primary font-bold\'>Change History</span>')" id="nav-history" class="nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group">
                <div class="flex items-center gap-3"><i class="ri-history-line text-lg"></i> Change History</div>
            </a>
            <!-- 6. Creatives -->
            <a href="#" onclick="navigateTo('creatives', 'nav-creatives', 'Home / <span class=\'text-primary font-bold\'>Creatives</span>')" id="nav-creatives" class="nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group">
                <div class="flex items-center gap-3"><i class="ri-image-line text-lg"></i> Creatives</div>
            </a>
            <!-- 7. Reports -->
            <a href="#" onclick="navigateTo('reports', 'nav-reports', 'Home / <span class=\'text-primary font-bold\'>Reports</span>')" id="nav-reports" class="nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group">
                <div class="flex items-center gap-3"><i class="ri-file-chart-line text-lg"></i> Reports</div>
            </a>
             <!-- 8. Settings -->
             <a href="#" onclick="navigateTo('settings', 'nav-settings', 'Home / <span class=\'text-primary font-bold\'>Settings</span>')" id="nav-settings" class="nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group">
                <div class="flex items-center gap-3"><i class="ri-settings-3-line text-lg"></i> Settings</div>
            </a>
        </nav>

        <!-- Sidebar Footer (View Switcher Bottom) -->
        <div class="p-4 border-t border-white/10 bg-primary-dark">
            <div onclick="toggleUserView()" class="flex items-center gap-3 cursor-pointer hover:opacity-80">
                <div id="userViewIcon" class="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center font-bold">R</div>
                <div>
                    <div id="userViewTitle" class="text-xs font-bold">Retailer View</div>
                    <div id="userViewSwitchText" class="text-[10px] opacity-70">Switch to Advertiser</div>
                </div>
                <i class="ri-exchange-line ml-auto opacity-50"></i>
            </div>
        </div>
    </aside>

    <!-- ================= 2. MAIN CONTENT ================= -->
    <div class="flex-1 flex flex-col overflow-hidden bg-gray-50 relative">
        
        <!-- Top Header (FIXED: Date Calendar Restored + View Switcher) -->
        <div class="bg-white h-16 border-b border-gray-200 flex justify-between items-center px-8 flex-shrink-0 shadow-sm z-40">
            <div class="flex items-center gap-4 w-1/2">
                <div class="text-gray-400 text-xs font-medium" id="breadcrumb-container">Home / <span class="text-primary font-bold">Overview</span></div>
                <div class="h-4 w-px bg-gray-200"></div>
                <div class="relative w-64">
                    <i class="ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    <input type="text" placeholder="Search..." class="pl-9 pr-4 py-1.5 border border-gray-200 rounded-lg text-xs w-full focus:outline-none focus:border-primary bg-gray-50">
                </div>
            </div>
            <div class="flex items-center gap-5">
                <div class="relative dropdown-container">
                    <div onclick="toggleId('viewModeDropdown')" class="flex items-center gap-2 bg-white border border-gray-200 px-3 py-1.5 rounded-full cursor-pointer hover:border-gray-300 select-none shadow-sm whitespace-nowrap">
                        <div id="viewModeIconTop" class="w-5 h-5 bg-primary text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0">R</div>
                        <span id="viewModeTextTop" class="text-xs font-medium text-gray-700">Retailer</span>
                        <i class="ri-arrow-down-s-fill text-gray-400"></i>
                    </div>
                    <div id="viewModeDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-48 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                        <div onclick="selectView('Retailer')" class="px-4 py-2 hover:bg-purple-50 text-gray-600 hover:text-primary text-xs cursor-pointer flex items-center gap-2"><i class="ri-store-2-line"></i> View as: Retailer</div>
                        <div onclick="selectView('Advertiser')" class="px-4 py-2 hover:bg-purple-50 text-gray-600 hover:text-primary text-xs cursor-pointer flex items-center gap-2"><i class="ri-advertisement-line"></i> View as: Advertiser</div>
                    </div>
                </div>
                <div onclick="toggleAIDrawer()" class="relative group p-2 hover:bg-purple-50 rounded-full transition cursor-pointer">
                    <i class="ri-sparkling-2-fill text-xl text-primary animate-pulse"></i> 
                </div>
                <!-- INBOX DROPDOWN -->
<div class="relative dropdown-container">
    <!-- 1. Bell Icon Button -->
    <button onclick="toggleId('inboxDropdown')" class="text-gray-400 hover:text-primary relative group transition-colors">
        <i class="ri-notification-3-line text-xl"></i>
        <!-- Changed Tooltip to 'Inbox' -->
        <div class="icon-tooltip">Inbox</div>
    </button>

    <!-- 2. The Popup Window -->
    <div id="inboxDropdown" class="dropdown-enter absolute top-full right-0 mt-3 w-80 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
        
        <!-- Header -->
        <div class="px-4 py-3 border-b border-gray-50 flex justify-between items-center bg-white">
            <div class="flex items-center gap-1 cursor-pointer hover:bg-gray-50 px-2 py-1 rounded transition">
                <h3 class="font-bold text-base text-gray-900">Inbox</h3>
                <i class="ri-arrow-down-s-fill text-gray-400 text-xs"></i>
            </div>
            
            <!-- Three Dots Menu -->
            <div class="relative">
                <button onclick="event.stopPropagation(); document.getElementById('inboxOptionsMenu').classList.toggle('hidden')" class="text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition">
                    <i class="ri-more-fill text-lg"></i>
                </button>
                <!-- Nested Options Menu (Hidden by default) -->
                <div id="inboxOptionsMenu" class="hidden absolute top-8 right-0 w-48 bg-white rounded-lg shadow-xl border border-gray-100 z-[60] p-1.5 animate-fade-in">
                    <button class="w-full text-left px-3 py-2 text-xs font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 rounded flex items-center gap-3 transition">
                        <i class="ri-check-double-line text-gray-400"></i> Mark all as read
                    </button>
                    <button class="w-full text-left px-3 py-2 text-xs font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 rounded flex items-center gap-3 transition">
                        <i class="ri-archive-line text-gray-400"></i> Archive all
                    </button>
                    <button class="w-full text-left px-3 py-2 text-xs font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 rounded flex items-center gap-3 transition">
                        <i class="ri-inbox-archive-line text-gray-400"></i> Archive read
                    </button>
                </div>
            </div>
        </div>

        <!-- Body (Empty State) -->
        <div class="h-72 flex flex-col items-center justify-center p-6 text-center bg-white">
            <div class="w-16 h-16 mb-4 opacity-20">
                <!-- Using Remix Icon similar to the screenshot box -->
                <svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full text-gray-400">
                    <path d="M4 16V4H20V16H4ZM4 18C4 18.5523 4.44772 19 5 19H19C19.5523 19 20 18.5523 20 18V18C20 19.6569 18.6569 21 17 21H7C5.34315 21 4 19.6569 4 18V18ZM6 6H18V14H6V6ZM12 17C13.6569 17 15 15.6569 15 14H9C9 15.6569 10.3431 17 12 17Z"></path>
                </svg>
            </div>
            <p class="text-xs text-gray-300 font-medium">No notifications</p>
        </div>
    </div>
</div>
                <button class="text-gray-400 hover:text-primary relative group"><i class="ri-history-line text-xl"></i><div class="icon-tooltip">History</div></button>
                <button class="text-gray-400 hover:text-primary relative group"><i class="ri-time-line text-xl"></i><div class="icon-tooltip">Transactions</div></button>
                
<!-- NEW: BALANCE & MANAGE SECTION (FIXED) -->
                <div class="flex items-center gap-4 mr-2 border-r border-gray-200 pr-4 h-8">
                    <div class="flex flex-col items-end justify-center">
                        <span class="text-[10px] text-gray-400 font-bold uppercase tracking-wider leading-tight">Balance</span>
                        <span class="text-base font-black text-gray-900 leading-none whitespace-nowrap"> 19,98,662</span>
                    </div>
                    <button onclick="navigateTo('balance', 'nav-balance')" class="border border-primary text-primary hover:bg-purple-50 px-4 py-1.5 rounded-lg text-xs font-bold transition h-fit shadow-sm whitespace-nowrap">
                        Manage
                    </button>
                </div>               
<!-- REPLACED CALENDAR DROPDOWN -->
<div class="relative dropdown-container">
    <div onclick="toggleId('dateDropdown')" class="flex items-center gap-2 bg-white border border-gray-200 px-3 py-1.5 rounded cursor-pointer hover:border-gray-300 text-xs font-medium select-none shadow-sm text-gray-600 whitespace-nowrap">
        <i class="ri-calendar-line"></i> <span id="dateRangeText">20 Nov - 26 Nov</span> <i class="ri-arrow-down-s-line"></i>
    </div>
    
    <div id="dateDropdown" class="dropdown-enter absolute top-full right-0 mt-3 w-[450px] bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50 !flex h-72">
        <!-- Presets -->
        <div class="w-1/3 border-r border-gray-100 bg-gray-50 p-2 space-y-1 overflow-y-auto">
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Today</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Yesterday</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Last 2 Days</div>
            <div class="px-3 py-2 text-xs font-bold text-white bg-primary shadow-sm rounded cursor-pointer">Last 7 Days</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Last 14 Days</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Last 28 Days</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Last Month</div>
        </div>
        
        <!-- Calendar Views -->
        <div class="w-2/3 p-4 flex flex-col">
            <div class="flex justify-between items-center mb-3">
                <div class="flex gap-1 text-sm font-bold text-gray-700">
                    <span onclick="switchCalView('months')" class="cursor-pointer hover:text-primary hover:bg-gray-100 px-1 rounded" id="calMonthLabel">November</span>
                    <span onclick="switchCalView('years')" class="cursor-pointer hover:text-primary hover:bg-gray-100 px-1 rounded" id="calYearLabel">2025</span>
                </div>
                <div class="flex gap-1">
                    <button onclick="calPrev()" class="p-1 hover:bg-gray-100 rounded"><i class="ri-arrow-left-s-line"></i></button>
                    <button onclick="calNext()" class="p-1 hover:bg-gray-100 rounded"><i class="ri-arrow-right-s-line"></i></button>
                </div>
            </div>
            <div id="viewDays" class="cal-view active h-full">
                <div class="grid grid-cols-7 gap-1 text-center text-[10px] text-gray-400 mb-1"><div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div></div>
                <div id="calendarGrid" class="grid grid-cols-7 gap-1 text-center text-xs text-gray-700"></div>
            </div>
            <div id="viewMonths" class="cal-view h-full">
                <div id="monthList" class="grid grid-cols-3 gap-2 h-full overflow-y-auto p-1"></div>
            </div>
            <div id="viewYears" class="cal-view h-full overflow-y-auto p-1">
                <div id="yearList" class="flex flex-col space-y-1"></div>
            </div>
        </div>
    </div>
</div>
                
                <!-- GLOBAL APPS MENU -->
<div class="relative dropdown-container">
    <!-- 1. The Trigger Icon (4 Circles) -->
    <button onclick="toggleId('globalAppsDropdown')" class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-purple-50 text-gray-500 hover:text-primary transition-all duration-200">
        <!-- SVG matching the 4-circle icon -->
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="7" cy="7" r="2.5"></circle>
            <circle cx="17" cy="7" r="2.5"></circle>
            <circle cx="7" cy="17" r="2.5"></circle>
            <circle cx="17" cy="17" r="2.5"></circle>
        </svg>
    </button>

    <!-- 2. The Dropdown Window -->
    <div id="globalAppsDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50 py-2">
        
        <!-- Notification Settings -->
<a href="#" class="flex items-center gap-3 px-5 py-3 hover:bg-gray-50 transition group">
    <!-- Custom Composite Icon (Bell + Gear) -->
    <div class="relative w-5 h-5 flex items-center justify-center">
        <i class="ri-notification-3-fill text-xl text-yellow-400"></i>
        <i class="ri-settings-3-fill text-[10px] text-primary-500 absolute -top-1 -right-1 bg-white rounded-full border border-white"></i>
    </div>
    <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900">Notification Settings</span>
</a>

        <!-- Reports -->
        <a href="#" onclick="navigateTo('reports', 'nav-reports')" class="flex items-center gap-3 px-5 py-3 hover:bg-gray-50 transition group">
            <i class="ri-file-text-fill text-xl text-primary-400"></i>
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900">Reports</span>
        </a>

        <!-- Change History -->
        <a href="#" onclick="navigateTo('history', 'nav-history')" class="flex items-center gap-3 px-5 py-3 hover:bg-gray-50 transition group">
            <i class="ri-history-line text-xl text-slate-500"></i>
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900">Change History</span>
        </a>

        <!-- Create Ticket -->
        <a href="#" class="flex items-center gap-3 px-5 py-3 hover:bg-gray-50 transition group">
            <i class="ri-ticket-2-fill text-xl text-red-400"></i>
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900">Create Ticket</span>
        </a>

        <!-- Help Center -->
        <a href="#" class="flex items-center gap-3 px-5 py-3 hover:bg-gray-50 transition group">
            <i class="ri-question-fill text-xl text-teal-500"></i>
            <span class="text-sm font-medium text-gray-700 group-hover:text-gray-900">Help Center</span>
        </a>
    </div>
</div>
            </div>
        </div>
      <!-- ================= PAGE CONTENT CONTAINER ================= -->
    <div class="flex-1 overflow-y-auto p-8 scroll-smooth">
        
        <!-- 1. OVERVIEW PAGE -->
        <div id="page-overview" class="page-section">
            <!-- HERO -->
            <div class="bg-secondary border border-primary/20 rounded-xl h-64 flex justify-between items-center shadow-soft relative overflow-hidden mb-6">
                <div class="relative z-10 w-1/2 h-full flex flex-col justify-center pl-12">
                    <h2 class="text-3xl font-bold text-gray-900 flex items-center gap-3"><i class="ri-rocket-line text-primary text-4xl"></i> Utilize your unspent money!</h2>
                    <p class="text-gray-600 text-lg mt-3 max-w-md">Reactivate paused campaigns or create new ones to maximize your Q4 revenue potential.</p>
                </div>
                <div class="relative z-10 w-1/2 h-full flex items-center justify-center pr-10">
                        <svg width="400" height="250" viewBox="0 0 400 250" fill="none" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="bgGradient" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#FFD1A9"/><stop offset="100%" stop-color="#E0BBE4"/></linearGradient><linearGradient id="shirtGradient" x1="0" y1="0" x2="1" y2="0"><stop offset="0%" stop-color="#EAAFC8"/><stop offset="50%" stop-color="#654EA3"/><stop offset="100%" stop-color="#F2D06B"/></linearGradient></defs><rect x="50" y="100" width="300" height="150" fill="url(#bgGradient)" rx="4" /><rect x="70" y="80" width="260" height="170" fill="white" stroke="black" stroke-width="2" rx="4"/><line x1="70" y1="100" x2="330" y2="100" stroke="black" stroke-width="2"/><g transform="translate(130, 70)"><path d="M40 70 L100 70 L90 130 L50 130 Z" fill="url(#shirtGradient)" /><path d="M50 130 L90 130 Q100 180 70 180 Q40 180 50 130" fill="#2c0b36"/><path d="M40 80 L20 50 L25 40" stroke="black" stroke-width="2" fill="white"/><path d="M100 80 L120 50 L115 40" stroke="black" stroke-width="2" fill="white"/><circle cx="70" cy="50" r="15" fill="white" stroke="black" stroke-width="2"/><path d="M55 50 Q60 30 80 40 Q85 60 70 60" fill="#2c0b36"/></g><g stroke="black" stroke-width="2" fill="none"><path d="M80 50 L100 50 L90 70 Z" transform="rotate(-30 90 60)" class="animate-float-icon"/><circle cx="90" cy="55" r="2" fill="black" class="animate-float-icon"/><path d="M250 40 Q260 30 270 40" transform="translate(0, 10)" class="animate-float-icon"/><rect x="120" y="20" width="15" height="25" rx="2" transform="rotate(-20 127 32)" class="animate-float-icon"/></g></svg>
                </div>
            </div>
            <!-- KPI & Graph Section -->
            <div class="grid grid-cols-12 gap-6 mb-6">
                <div class="col-span-4 flex flex-col gap-4 h-[420px]">
    <!-- KPI Card 1: Ad Impressions -->
    <div id="kpi-card-1" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary">
        <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(1, document.getElementById('kpi-title-1').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-1">Ad Impressions</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown1" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(1, 'Ad Impressions')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Ad Impressions</div>
                        <div onclick="updateKpiCard(1, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(1, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(1, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-1" class="text-2xl font-bold text-gray-900 mt-1">1.2M</div>
        </div>
        <div id="kpi-change-1" class="text-right text-xs font-bold text-primary-green bg-secondary-green px-2 py-1 rounded">+12.5%</div>
    </div>

    <!-- KPI Card 2: CTR -->
    <div id="kpi-card-2" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-lemon-green">
        <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(2, document.getElementById('kpi-title-2').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-2">CTR</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown2" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(2, 'CTR')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CTR</div>
                        <div onclick="updateKpiCard(2, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(2, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(2, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-2" class="text-2xl font-bold text-gray-900 mt-1">3.8%</div>
        </div>
        <div id="kpi-change-2" class="text-right text-xs font-bold text-primary-green bg-secondary-green px-2 py-1 rounded">+5.2%</div>
    </div>

    <!-- KPI Card 3: Ad Clicks -->
    <div id="kpi-card-3" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary-red">
            <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(3, document.getElementById('kpi-title-3').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-3">Ad Clicks</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown3" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(3, 'Ad Clicks')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Ad Clicks</div>
                        <div onclick="updateKpiCard(3, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(3, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(3, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-3" class="text-2xl font-bold text-gray-900 mt-1">45,000</div>
        </div>
        <div id="kpi-change-3" class="text-right text-xs font-bold text-primary-red bg-secondary-red px-2 py-1 rounded">-2.1%</div>
    </div>

    <!-- KPI Card 4: Tagged Product Revenue -->
    <div id="kpi-card-4" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary-orange">
            <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(4, document.getElementById('kpi-title-4').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-4">Tagged Product Revenue</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown4" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(4, 'Tagged Product Revenue')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Revenue</div>
                        <div onclick="updateKpiCard(4, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(4, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(4, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-4" class="text-2xl font-bold text-gray-900 mt-1"> 12.5L</div>
        </div>
        <div id="kpi-change-4" class="text-right text-xs font-bold text-gray-500 bg-gray-100 px-2 py-1 rounded">0.0%</div>
    </div>
</div>
                <div class="col-span-8 bg-white rounded-xl shadow-card border border-gray-100 p-6 chart-container h-[420px] flex flex-col">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-gray-800 text-lg">Performance Trends</h3>
                        <div class="flex bg-gray-100 p-1 rounded-lg">
                            <button onclick="updateGraph(this, 'day')" class="px-4 py-1 text-xs font-bold text-gray-900 bg-white shadow rounded-md transition">Day</button>
                            <button onclick="updateGraph(this, 'week')" class="px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition">Week</button>
                            <button onclick="updateGraph(this, 'month')" class="px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition">Month</button>
                        </div>
                    </div>
                    <div class="w-full flex-1 relative group cursor-crosshair">
                        <div class="absolute inset-0 flex flex-col justify-between text-gray-300 text-[10px] pb-8 pl-2">
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">100%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">75%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">50%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">25%</span></div>
                            <div class="border-b border-gray-200 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">0</span></div>
                        </div>
                        <svg class="w-full h-full absolute inset-0 z-10 pb-8 pl-8" preserveAspectRatio="none" viewBox="0 0 1000 200">
                            <path class="graph-line-1" fill="none" stroke="#9c00ad" stroke-width="2" d="M0,180 L150,120 L300,160 L450,40 L600,100 L800,20 L1000,80" />
                            <path class="graph-line-2" fill="none" stroke="#84cc16" stroke-width="2" d="M0,150 C200,180 300,50 500,100 S800,150 1000,60" />
                            <path class="graph-line-3" fill="none" stroke="#b11d15" stroke-width="2" d="M0,190 L200,180 L400,140 L600,120 L800,60 L1000,40" />
                            <path class="graph-line-4" fill="none" stroke="#f97316" stroke-width="2" d="M0,100 Q300,150 600,50 T1000,20" />
                        </svg>
                        <div class="absolute bottom-0 left-8 right-0 flex justify-between text-[10px] text-gray-400 font-medium pt-2"><span>Nov 20</span><span>Nov 21</span><span>Nov 22</span><span>Nov 23</span><span>Nov 24</span><span>Nov 25</span><span>Nov 26</span></div>
                    </div>
                </div>
            </div>
            <!-- Campaigns Table (Overview) - FULL 20 ROWS -->
            <div class="bg-white rounded-xl shadow-card border border-gray-100 flex flex-col mb-6">
                <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-xl">
                    <div class="flex items-center gap-4">
                        <h3 class="font-bold text-gray-800">Campaigns</h3>
                        <div class="flex bg-gray-200 rounded-lg p-0.5">
                            <button onclick="toggleCampaignView('list')" id="btnList" class="p-1.5 rounded-md text-gray-700 bg-white shadow-sm transition"><i class="ri-list-check"></i></button>
                            <button onclick="toggleCampaignView('chart')" id="btnChart" class="p-1.5 rounded-md text-gray-500 hover:text-gray-700 transition"><i class="ri-bubble-chart-line"></i></button>
                        </div>
                    </div>
                        <div class="flex gap-2">
                        <div class="relative dropdown-container">
                            <button onclick="toggleId('filterDropdown')" class="px-3 py-1.5 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-50 flex items-center gap-1"><i class="ri-filter-3-line"></i> Filter</button>
                            <div id="filterDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                                <div class="p-3">
                                    <div class="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2">Filter By Status</div>
                                    <div class="max-h-40 overflow-y-auto space-y-1">
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Active" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Active</span></label>
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Paused" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Paused</span></label>
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Draft" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Draft</span></label>
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Archived" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Archived</span></label>
                                    </div>
                                </div>
                                <div class="p-2 bg-gray-50 border-t border-gray-100 flex justify-end gap-2">
                                    <button onclick="clearFilters()" class="px-3 py-1 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-100">Clear</button>
                                    <button onclick="applyFilters()" class="px-3 py-1 bg-primary text-white rounded text-xs font-bold hover:bg-primary-light">Apply</button>
                                </div>
                            </div>
                        </div>
                        <div class="relative dropdown-container">
                            <button onclick="toggleId('viewDropdown')" class="px-3 py-1.5 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-50 flex items-center gap-1"><i id="currentViewIcon" class="ri-list-check"></i> <span id="currentViewLabel">List</span></button>
                            <div id="viewDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-40 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                                <div class="py-1">
                                    <div onclick="switchLayout('list')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer flex items-center gap-2"><i class="ri-list-check"></i> List View</div>
                                    <div onclick="switchLayout('grid')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer flex items-center gap-2"><i class="ri-grid-fill"></i> Grid View</div>
                                    <div onclick="switchLayout('comfortable')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer flex items-center gap-2"><i class="ri-layout-row-line"></i> Comfortable</div>
                                </div>
                            </div>
                        </div>
                        <button onclick="navigateTo('create-campaign', '', 'Home / <span class=\'text-primary font-bold\'>Create Campaign</span>')" class="flex items-center gap-1 px-4 py-1.5 bg-black text-white rounded text-xs font-bold shadow-md hover:bg-gray-800 transition"><i class="ri-add-line text-sm"></i> Create New Campaign</button>
                    </div>
                </div>
                <div class="overflow-x-auto block p-0" id="viewList">
                    <table class="w-full text-left border-collapse" id="campaignTable">
                        <thead><tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider"><th class="px-4 py-3 border-b">Status</th><th class="px-4 py-3 border-b">Name</th><th class="px-4 py-3 border-b">Type</th><th class="px-4 py-3 border-b text-right">Budget</th><th class="px-4 py-3 border-b text-right">Spend</th><th class="px-4 py-3 border-b text-right">Impr.</th><th class="px-4 py-3 border-b text-right">Clicks</th><th class="px-4 py-3 border-b text-right">CTR</th><th class="px-4 py-3 border-b text-center">Action</th></tr></thead>
                        <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Summer Sale</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">45k</td><td class="px-4 py-3 text-right">1.2M</td><td class="px-4 py-3 text-right">450</td><td class="px-4 py-3 text-right">3.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Winter Coll.</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">2k</td><td class="px-4 py-3 text-right">12k</td><td class="px-4 py-3 text-right">500K</td><td class="px-4 py-3 text-right">200</td><td class="px-4 py-3 text-right">2.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Brand Aware</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">1.5k</td><td class="px-4 py-3 text-right">8.4k</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">320</td><td class="px-4 py-3 text-right">4.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Ended"><td class="px-4 py-3"><span class="bg-gray-100 text-gray-500 px-2 py-1 rounded-md font-bold">Ended</span></td><td class="px-4 py-3 font-bold text-gray-500">Diwali Bash</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">95k</td><td class="px-4 py-3 text-right">3.5M</td><td class="px-4 py-3 text-right">800</td><td class="px-4 py-3 text-right">5.0%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Lipstick Launch</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">3.5k</td><td class="px-4 py-3 text-right">28k</td><td class="px-4 py-3 text-right">950K</td><td class="px-4 py-3 text-right">410</td><td class="px-4 py-3 text-right">3.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Eye Liner</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">2k</td><td class="px-4 py-3 text-right">14k</td><td class="px-4 py-3 text-right">400K</td><td class="px-4 py-3 text-right">180</td><td class="px-4 py-3 text-right">2.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Skin Care</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">4k</td><td class="px-4 py-3 text-right">32k</td><td class="px-4 py-3 text-right">600K</td><td class="px-4 py-3 text-right">290</td><td class="px-4 py-3 text-right">4.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Old Stock</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">1k</td><td class="px-4 py-3 text-right">5.6k</td><td class="px-4 py-3 text-right">150K</td><td class="px-4 py-3 text-right">8</td><td class="px-4 py-3 text-right">1.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Influencer</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">6k</td><td class="px-4 py-3 text-right">18k</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">410</td><td class="px-4 py-3 text-right">6.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Retargeting</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">3.2k</td><td class="px-4 py-3 text-right">22k</td><td class="px-4 py-3 text-right">720K</td><td class="px-4 py-3 text-right">350</td><td class="px-4 py-3 text-right">5.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Draft"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Holi Fest</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">10k</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Monsoon Sale</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">8k</td><td class="px-4 py-3 text-right">32k</td><td class="px-4 py-3 text-right">900K</td><td class="px-4 py-3 text-right">380</td><td class="px-4 py-3 text-right">3.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Black Friday</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">50k</td><td class="px-4 py-3 text-right">48k</td><td class="px-4 py-3 text-right">2.1M</td><td class="px-4 py-3 text-right">950</td><td class="px-4 py-3 text-right">4.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Archived"><td class="px-4 py-3"><span class="bg-red-50 text-red-600 px-2 py-1 rounded-md font-bold border border-red-100">Archived</span></td><td class="px-4 py-3 font-bold text-gray-400">2023 Clearance</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">120k</td><td class="px-4 py-3 text-right">4.5M</td><td class="px-4 py-3 text-right">1500</td><td class="px-4 py-3 text-right">2.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Cyber Monday</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">20k</td><td class="px-4 py-3 text-right">18k</td><td class="px-4 py-3 text-right">850K</td><td class="px-4 py-3 text-right">420</td><td class="px-4 py-3 text-right">5.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Valentine Special</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">12k</td><td class="px-4 py-3 text-right">45k</td><td class="px-4 py-3 text-right">1.1M</td><td class="px-4 py-3 text-right">500</td><td class="px-4 py-3 text-right">4.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused (Cap)"><td class="px-4 py-3"><span class="bg-yellow-50 text-yellow-600 px-2 py-1 rounded-md font-bold border border-yellow-100">Paused (Cap)</span></td><td class="px-4 py-3 font-bold">Eid Collection</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">200K</td><td class="px-4 py-3 text-right">90</td><td class="px-4 py-3 text-right">3.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Rakhi Special</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">7k</td><td class="px-4 py-3 text-right">21k</td><td class="px-4 py-3 text-right">650K</td><td class="px-4 py-3 text-right">310</td><td class="px-4 py-3 text-right">3.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Christmas Sale</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">30k</td><td class="px-4 py-3 text-right">150k</td><td class="px-4 py-3 text-right">3.2M</td><td class="px-4 py-3 text-right">1100</td><td class="px-4 py-3 text-right">4.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Flash Sale 2.0</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">4k</td><td class="px-4 py-3 text-right">16k</td><td class="px-4 py-3 text-right">450K</td><td class="px-4 py-3 text-right">220</td><td class="px-4 py-3 text-right">6.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="viewChart" class="hidden relative w-full h-[450px] font-sans">
                    <!-- Quadrant Labels -->
                    <div class="absolute top-6 left-16 bg-primary-50 border border-primary-100 text-primary-600 px-3 py-1 rounded text-xs font-bold z-10">Potential (Low Spend, High Perf)</div>
                    <div class="absolute top-6 right-6 bg-green-50 border border-green-100 text-green-600 px-3 py-1 rounded text-xs font-bold z-10">Winner (High Spend, High Perf)</div>
                    <div class="absolute bottom-12 left-16 bg-gray-50 border border-gray-200 text-gray-500 px-3 py-1 rounded text-xs font-bold z-10">Poor (Low Spend, Low Perf)</div>
                    <div class="absolute bottom-12 right-6 bg-orange-50 border border-orange-100 text-orange-600 px-3 py-1 rounded text-xs font-bold z-10">Bleeder (High Spend, Low Perf)</div>
                
                    <!-- SVG for Grid Lines ONLY -->
                    <svg class="absolute inset-0 w-full h-full z-0 pointer-events-none" viewBox="0 0 1000 400" preserveAspectRatio="none">
                        <line x1="50" y1="350" x2="980" y2="350" stroke="#e5e7eb" stroke-width="2" />
                        <line x1="50" y1="20" x2="50" y2="350" stroke="#e5e7eb" stroke-width="2" />
                        <line x1="515" y1="20" x2="515" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5" />
                        <line x1="50" y1="185" x2="980" y2="185" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5" />
                        <text x="35" y="350" text-anchor="end" class="text-[10px] fill-gray-400 font-medium">0%</text>
                        <text x="35" y="190" text-anchor="end" class="text-[10px] fill-gray-400 font-medium">3%</text>
                        <text x="35" y="30" text-anchor="end" class="text-[10px] fill-gray-400 font-medium">6%</text>
                        <text x="10" y="200" text-anchor="middle" transform="rotate(-90 10,200)" class="text-xs fill-gray-500 font-bold">CTR (%)</text>
                        <text x="50" y="370" text-anchor="middle" class="text-[10px] fill-gray-400 font-medium">0</text>
                        <text x="515" y="370" text-anchor="middle" class="text-[10px] fill-gray-400 font-medium">50k</text>
                        <text x="980" y="370" text-anchor="middle" class="text-[10px] fill-gray-400 font-medium">100k</text>
                        <text x="515" y="385" text-anchor="middle" class="text-xs fill-gray-500 font-bold">Total Spend ()</text>
                    </svg>

                    <!-- HTML Data Points -->
                    <div class="absolute rounded-full bg-gray-100 border-2 border-gray-200 z-0 opacity-50" style="left: 50%; top: 45%; width: 40px; height: 40px; transform: translate(-50%, -50%);"></div>
                    <div class="absolute rounded-full bg-gray-100 border-2 border-gray-200 z-0 opacity-50" style="left: 53%; top: 52.5%; width: 30px; height: 30px; transform: translate(-50%, -50%);"></div>
                    <div class="absolute rounded-full bg-gray-100 border-2 border-gray-200 z-0 opacity-50" style="left: 49%; top: 50%; width: 24px; height: 24px; transform: translate(-50%, -50%);"></div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 20%; top: 30%; transform: translate(-50%, -50%);">
                        <div class="w-10 h-10 rounded-full bg-[#74a58b]/80 border-2 border-[#487e63]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Brand Aware</span>
                    </div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 65%; top: 40%; transform: translate(-50%, -50%);">
                        <div class="w-[50px] h-[50px] rounded-full bg-[#74a58b]/80 border-2 border-[#487e63]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Summer Sale</span>
                    </div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 85%; top: 20%; transform: translate(-50%, -50%);">
                        <div class="w-[90px] h-[90px] rounded-full bg-[#cf7bd4]/80 border-2 border-[#9c00ad]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Diwali Bash</span>
                    </div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 25%; top: 70%; transform: translate(-50%, -50%);">
                        <div class="w-[30px] h-[30px] rounded-full bg-[#fca5a5]/80 border-2 border-[#ea580c]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Winter Coll.</span>
                    </div>
                </div>
                <div id="viewGrid" class="hidden p-6 grid grid-cols-2 gap-6"></div>
                <div id="viewComfortable" class="hidden p-6 grid grid-cols-1 gap-4"></div>
                <div class="p-3 bg-gray-50 rounded-b-xl border-t border-gray-100 text-center">
                    <button class="text-primary font-bold text-xs hover:underline">View All 25 Campaigns</button>
                </div>
            </div>
            <!-- Performance Summary Table (Overview) - FULL 10 ROWS -->
            <div class="bg-white rounded-xl shadow-card border border-gray-100 flex flex-col mb-10">
                <div class="p-4 border-b border-gray-100"><h3 class="font-bold text-gray-800 text-left">Performance Summary</h3></div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead><tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider"><th class="px-6 py-3">Name</th><th class="px-6 py-3">Spend</th><th class="px-6 py-3">Impr.</th><th class="px-6 py-3">Clicks</th><th class="px-6 py-3">CTR</th><th class="px-6 py-3">CPC</th><th class="px-6 py-3">CPM</th></tr></thead>
                        <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Summer Sale Blast</td><td class="px-6 py-3">45,000</td><td class="px-6 py-3">1.2M</td><td class="px-6 py-3">450</td><td class="px-6 py-3 font-bold">3.2%</td><td class="px-6 py-3">12.00</td><td class="px-6 py-3">150.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Winter Collection</td><td class="px-6 py-3">12,000</td><td class="px-6 py-3">500K</td><td class="px-6 py-3">200</td><td class="px-6 py-3 font-bold">2.8%</td><td class="px-6 py-3">15.00</td><td class="px-6 py-3">180.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Brand Awareness</td><td class="px-6 py-3">8,400</td><td class="px-6 py-3">800K</td><td class="px-6 py-3">320</td><td class="px-6 py-3 font-bold">4.1%</td><td class="px-6 py-3">9.00</td><td class="px-6 py-3">100.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Diwali Bash</td><td class="px-6 py-3">95,000</td><td class="px-6 py-3">3.5M</td><td class="px-6 py-3">800</td><td class="px-6 py-3 font-bold">5.0%</td><td class="px-6 py-3">10.00</td><td class="px-6 py-3">120.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Lipstick Launch</td><td class="px-6 py-3">28,400</td><td class="px-6 py-3">950K</td><td class="px-6 py-3">410</td><td class="px-6 py-3 font-bold">3.9%</td><td class="px-6 py-3">14.00</td><td class="px-6 py-3">130.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Eye Liner Promo</td><td class="px-6 py-3">14,200</td><td class="px-6 py-3">400K</td><td class="px-6 py-3">180</td><td class="px-6 py-3 font-bold">2.5%</td><td class="px-6 py-3">16.00</td><td class="px-6 py-3">140.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Skin Care Glow</td><td class="px-6 py-3">18,500</td><td class="px-6 py-3">600K</td><td class="px-6 py-3">290</td><td class="px-6 py-3 font-bold">4.5%</td><td class="px-6 py-3">11.00</td><td class="px-6 py-3">110.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Weekend Flash</td><td class="px-6 py-3">6,000</td><td class="px-6 py-3">300K</td><td class="px-6 py-3">150</td><td class="px-6 py-3 font-bold">5.5%</td><td class="px-6 py-3">18.00</td><td class="px-6 py-3">190.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">New Year Bash</td><td class="px-6 py-3">150,000</td><td class="px-6 py-3">5.0M</td><td class="px-6 py-3">1200</td><td class="px-6 py-3 font-bold">4.8%</td><td class="px-6 py-3">12.00</td><td class="px-6 py-3">160.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Abandoned Cart</td><td class="px-6 py-3">32,000</td><td class="px-6 py-3">800K</td><td class="px-6 py-3">550</td><td class="px-6 py-3 font-bold">7.1%</td><td class="px-6 py-3">7.00</td><td class="px-6 py-3">90.00</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

<!-- PERFORMANCE PAGE -->
        <div id="page-performance" class="page-section hidden">
            <!-- HERO: PERFORMANCE ADS (New Design) -->
            <div class="bg-gradient-to-r from-[#9c00ad] to-[#654ea3] text-white rounded-xl h-64 flex justify-between items-center shadow-lg relative overflow-hidden mb-6">
                <!-- Left Text -->
                <div class="relative z-10 w-1/2 h-full flex flex-col justify-center pl-12">
                    <div class="inline-block bg-white/20 backdrop-blur-sm border border-white/20 rounded-full px-3 py-1 text-[10px] font-bold uppercase tracking-wider w-fit mb-3">
                        <i class="ri-flashlight-fill text-yellow-300"></i> High Impact
                    </div>
                    <h2 class="text-3xl font-bold flex items-center gap-3">Supercharge Your Q4 Sales</h2>
                    <p class="text-indigo-100 text-lg mt-3 max-w-md">Maximize ROI with AI-driven targeting. Drive 3x more conversions this season.</p>
                    <div class="mt-6 flex gap-3">
                        <button onclick="navigateTo('create-campaign')" class="bg-white text-[#370b40] px-6 py-2.5 rounded-lg font-bold shadow-lg hover:bg-gray-100 transition flex items-center gap-2">
                            <i class="ri-rocket-2-fill"></i> Launch Ad
                        </button>
                        <button class="bg-transparent border border-white/30 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-white/10 transition">
                            View Insights
                        </button>
                    </div>
                </div>
                
                <!-- Right Illustration (Performance Graph) -->
                <div class="relative z-10 w-1/2 h-full flex items-center justify-center pr-10">
                    <svg width="350" height="200" viewBox="0 0 350 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Abstract Background -->
                        <circle cx="280" cy="100" r="80" fill="#ffffff" fill-opacity="0.05"/>
                        <circle cx="200" cy="150" r="60" fill="#ffffff" fill-opacity="0.05"/>
                        
                        <!-- Graph Line -->
                        <path d="M50 150 C 100 150, 120 100, 180 80 S 250 110, 320 40" stroke="#4ade80" stroke-width="4" stroke-linecap="round" stroke-dasharray="8 8" class="animate-pulse"/>
                        <path d="M50 150 L 320 150" stroke="white" stroke-opacity="0.2" stroke-width="2"/>
                        <path d="M50 150 L 50 40" stroke="white" stroke-opacity="0.2" stroke-width="2"/>
                        
                        <!-- Floating Widgets -->
                        <g transform="translate(240, 20)">
                            <rect width="90" height="50" rx="8" fill="white" shadow="lg"/>
                            <text x="10" y="20" font-family="sans-serif" font-size="8" fill="#666">Conversion Rate</text>
                            <text x="10" y="40" font-family="sans-serif" font-size="16" font-weight="bold" fill="#370b40">+24.8%</text>
                            <circle cx="75" cy="25" r="8" fill="#dcfce7"/>
                            <path d="M72 25 L 75 22 L 78 25" stroke="#166534" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M75 22 L 75 28" stroke="#166534" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </g>

                        <!-- Target Icon -->
                        <g transform="translate(160, 60)">
                             <circle cx="20" cy="20" r="20" fill="#facc15" fill-opacity="0.2" class="animate-float-icon"/>
                             <circle cx="20" cy="20" r="10" fill="#facc15" class="animate-float-icon"/>
                             <circle cx="20" cy="20" r="4" fill="#ffffff" class="animate-float-icon"/>
                        </g>
                    </svg>
                </div>
            </div>
            <!-- KPI & Graph Section -->
            <div class="grid grid-cols-12 gap-6 mb-6">
                <div class="col-span-4 flex flex-col gap-4 h-[420px]">
    <!-- KPI Card 1: Ad Impressions -->
    <div id="kpi-card-1" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary">
        <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(1, document.getElementById('kpi-title-1').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-1">Ad Impressions</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown1" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(1, 'Ad Impressions')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Ad Impressions</div>
                        <div onclick="updateKpiCard(1, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(1, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(1, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-1" class="text-2xl font-bold text-gray-900 mt-1">1.2M</div>
        </div>
        <div id="kpi-change-1" class="text-right text-xs font-bold text-primary-green bg-secondary-green px-2 py-1 rounded">+12.5%</div>
    </div>

    <!-- KPI Card 2: CTR -->
    <div id="kpi-card-2" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-lemon-green">
        <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(2, document.getElementById('kpi-title-2').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-2">CTR</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown2" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(2, 'CTR')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CTR</div>
                        <div onclick="updateKpiCard(2, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(2, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(2, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-2" class="text-2xl font-bold text-gray-900 mt-1">3.8%</div>
        </div>
        <div id="kpi-change-2" class="text-right text-xs font-bold text-primary-green bg-secondary-green px-2 py-1 rounded">+5.2%</div>
    </div>

    <!-- KPI Card 3: Ad Clicks -->
    <div id="kpi-card-3" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary-red">
            <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(3, document.getElementById('kpi-title-3').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-3">Ad Clicks</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown3" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(3, 'Ad Clicks')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Ad Clicks</div>
                        <div onclick="updateKpiCard(3, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(3, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(3, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-3" class="text-2xl font-bold text-gray-900 mt-1">45,000</div>
        </div>
        <div id="kpi-change-3" class="text-right text-xs font-bold text-primary-red bg-secondary-red px-2 py-1 rounded">-2.1%</div>
    </div>

    <!-- KPI Card 4: Tagged Product Revenue -->
    <div id="kpi-card-4" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary-orange">
            <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(4, document.getElementById('kpi-title-4').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-4">Tagged Product Revenue</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown4" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(4, 'Tagged Product Revenue')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Revenue</div>
                        <div onclick="updateKpiCard(4, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(4, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(4, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-4" class="text-2xl font-bold text-gray-900 mt-1"> 12.5L</div>
        </div>
        <div id="kpi-change-4" class="text-right text-xs font-bold text-gray-500 bg-gray-100 px-2 py-1 rounded">0.0%</div>
    </div>
</div>
                <div class="col-span-8 bg-white rounded-xl shadow-card border border-gray-100 p-6 chart-container h-[420px] flex flex-col">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-gray-800 text-lg">Performance Trends</h3>
                        <div class="flex bg-gray-100 p-1 rounded-lg">
                            <button onclick="updateGraph(this, 'day')" class="px-4 py-1 text-xs font-bold text-gray-900 bg-white shadow rounded-md transition">Day</button>
                            <button onclick="updateGraph(this, 'week')" class="px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition">Week</button>
                            <button onclick="updateGraph(this, 'month')" class="px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition">Month</button>
                        </div>
                    </div>
                    <div class="w-full flex-1 relative group cursor-crosshair">
                        <div class="absolute inset-0 flex flex-col justify-between text-gray-300 text-[10px] pb-8 pl-2">
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">100%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">75%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">50%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">25%</span></div>
                            <div class="border-b border-gray-200 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">0</span></div>
                        </div>
                        <svg class="w-full h-full absolute inset-0 z-10 pb-8 pl-8" preserveAspectRatio="none" viewBox="0 0 1000 200">
                            <path class="graph-line-1" fill="none" stroke="#9c00ad" stroke-width="2" d="M0,180 L150,120 L300,160 L450,40 L600,100 L800,20 L1000,80" />
                            <path class="graph-line-2" fill="none" stroke="#84cc16" stroke-width="2" d="M0,150 C200,180 300,50 500,100 S800,150 1000,60" />
                            <path class="graph-line-3" fill="none" stroke="#b11d15" stroke-width="2" d="M0,190 L200,180 L400,140 L600,120 L800,60 L1000,40" />
                            <path class="graph-line-4" fill="none" stroke="#f97316" stroke-width="2" d="M0,100 Q300,150 600,50 T1000,20" />
                        </svg>
                        <div class="absolute bottom-0 left-8 right-0 flex justify-between text-[10px] text-gray-400 font-medium pt-2"><span>Nov 20</span><span>Nov 21</span><span>Nov 22</span><span>Nov 23</span><span>Nov 24</span><span>Nov 25</span><span>Nov 26</span></div>
                    </div>
                </div>
            </div>
            <!-- Campaigns Table (Overview) - FULL 20 ROWS -->
            <div class="bg-white rounded-xl shadow-card border border-gray-100 flex flex-col mb-6">
                <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-xl">
    <div class="flex items-center gap-4">
        <h3 class="font-bold text-gray-800">Campaigns</h3>
    </div>
    <div class="flex gap-2">
        <div class="relative dropdown-container">
            <button onclick="toggleId('filterDropdownPerf')" class="px-3 py-1.5 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-50 flex items-center gap-1"><i class="ri-filter-3-line"></i> Filter</button>
        </div>
        <!-- FIXED: Added id="createPerfBtn" below -->
        <button id="createPerfBtn" onclick="openPerformanceCreator('smart-shopping')" class="flex items-center gap-1 px-4 py-1.5 bg-black text-white rounded text-xs font-bold shadow-md hover:bg-gray-800 transition"><i class="ri-add-line text-sm"></i> Create New Campaign</button>
    </div>
</div>
                <div class="overflow-x-auto block p-0" id="viewList">
                    <table class="w-full text-left border-collapse" style="table-layout: fixed; width: 100%;">
    <thead>
        <tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider">
            <!-- Locked Widths -->
            <th class="px-4 py-3 border-b" style="width: 12%;">Status</th>
            <th class="px-4 py-3 border-b" style="width: 23%;">Name</th>
            <th class="px-4 py-3 border-b" style="width: 10%;">Type</th>
            <th class="px-4 py-3 border-b text-right" style="width: 11%;">Budget</th>
            <th class="px-4 py-3 border-b text-right" style="width: 11%;">Spend</th>
            <th class="px-4 py-3 border-b text-right" style="width: 11%;">Impr.</th>
            <th class="px-4 py-3 border-b text-right" style="width: 11%;">Clicks</th>
            <th class="px-4 py-3 border-b text-right" style="width: 11%;">CTR</th>
            <th class="px-4 py-3 border-b text-center" style="width: 5%;">...</th>
        </tr>
    </thead>
    <tbody id="perfTableBody" class="text-xs text-gray-700 divide-y divide-gray-100">
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Summer Sale</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">45k</td><td class="px-4 py-3 text-right">1.2M</td><td class="px-4 py-3 text-right">450</td><td class="px-4 py-3 text-right">3.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Winter Coll.</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">2k</td><td class="px-4 py-3 text-right">12k</td><td class="px-4 py-3 text-right">500K</td><td class="px-4 py-3 text-right">200</td><td class="px-4 py-3 text-right">2.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Brand Aware</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">1.5k</td><td class="px-4 py-3 text-right">8.4k</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">320</td><td class="px-4 py-3 text-right">4.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Ended"><td class="px-4 py-3"><span class="bg-gray-100 text-gray-500 px-2 py-1 rounded-md font-bold">Ended</span></td><td class="px-4 py-3 font-bold text-gray-500">Diwali Bash</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">95k</td><td class="px-4 py-3 text-right">3.5M</td><td class="px-4 py-3 text-right">800</td><td class="px-4 py-3 text-right">5.0%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Lipstick Launch</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">3.5k</td><td class="px-4 py-3 text-right">28k</td><td class="px-4 py-3 text-right">950K</td><td class="px-4 py-3 text-right">410</td><td class="px-4 py-3 text-right">3.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Eye Liner</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">2k</td><td class="px-4 py-3 text-right">14k</td><td class="px-4 py-3 text-right">400K</td><td class="px-4 py-3 text-right">180</td><td class="px-4 py-3 text-right">2.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Skin Care</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">4k</td><td class="px-4 py-3 text-right">32k</td><td class="px-4 py-3 text-right">600K</td><td class="px-4 py-3 text-right">290</td><td class="px-4 py-3 text-right">4.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Old Stock</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">1k</td><td class="px-4 py-3 text-right">5.6k</td><td class="px-4 py-3 text-right">150K</td><td class="px-4 py-3 text-right">8</td><td class="px-4 py-3 text-right">1.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Influencer</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">6k</td><td class="px-4 py-3 text-right">18k</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">410</td><td class="px-4 py-3 text-right">6.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Retargeting</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">3.2k</td><td class="px-4 py-3 text-right">22k</td><td class="px-4 py-3 text-right">720K</td><td class="px-4 py-3 text-right">350</td><td class="px-4 py-3 text-right">5.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Draft"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Holi Fest</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">10k</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Monsoon Sale</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">8k</td><td class="px-4 py-3 text-right">32k</td><td class="px-4 py-3 text-right">900K</td><td class="px-4 py-3 text-right">380</td><td class="px-4 py-3 text-right">3.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Black Friday</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">50k</td><td class="px-4 py-3 text-right">48k</td><td class="px-4 py-3 text-right">2.1M</td><td class="px-4 py-3 text-right">950</td><td class="px-4 py-3 text-right">4.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Archived"><td class="px-4 py-3"><span class="bg-red-50 text-red-600 px-2 py-1 rounded-md font-bold border border-red-100">Archived</span></td><td class="px-4 py-3 font-bold text-gray-400">2023 Clearance</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">120k</td><td class="px-4 py-3 text-right">4.5M</td><td class="px-4 py-3 text-right">1500</td><td class="px-4 py-3 text-right">2.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Cyber Monday</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">20k</td><td class="px-4 py-3 text-right">18k</td><td class="px-4 py-3 text-right">850K</td><td class="px-4 py-3 text-right">420</td><td class="px-4 py-3 text-right">5.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Valentine Special</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">12k</td><td class="px-4 py-3 text-right">45k</td><td class="px-4 py-3 text-right">1.1M</td><td class="px-4 py-3 text-right">500</td><td class="px-4 py-3 text-right">4.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused (Cap)"><td class="px-4 py-3"><span class="bg-yellow-50 text-yellow-600 px-2 py-1 rounded-md font-bold border border-yellow-100">Paused (Cap)</span></td><td class="px-4 py-3 font-bold">Eid Collection</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">200K</td><td class="px-4 py-3 text-right">90</td><td class="px-4 py-3 text-right">3.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Rakhi Special</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">7k</td><td class="px-4 py-3 text-right">21k</td><td class="px-4 py-3 text-right">650K</td><td class="px-4 py-3 text-right">310</td><td class="px-4 py-3 text-right">3.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Christmas Sale</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">30k</td><td class="px-4 py-3 text-right">150k</td><td class="px-4 py-3 text-right">3.2M</td><td class="px-4 py-3 text-right">1100</td><td class="px-4 py-3 text-right">4.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Flash Sale 2.0</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">4k</td><td class="px-4 py-3 text-right">16k</td><td class="px-4 py-3 text-right">450K</td><td class="px-4 py-3 text-right">220</td><td class="px-4 py-3 text-right">6.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="viewGrid" class="hidden p-6 grid grid-cols-2 gap-6"></div>
                <div id="viewComfortable" class="hidden p-6 grid grid-cols-1 gap-4"></div>
                <div class="p-3 bg-gray-50 rounded-b-xl border-t border-gray-100 text-center">
                    <button class="text-primary font-bold text-xs hover:underline">View All 25 Campaigns</button>
                </div>
            </div>
            <!-- Performance Summary Table (Overview) - FULL 10 ROWS -->
            <div class="bg-white rounded-xl shadow-card border border-gray-100 flex flex-col mb-10">
                <div class="p-4 border-b border-gray-100">
                    <!-- Row 1: Title and Icons -->
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-gray-800 text-lg">Performance Summary</h3>
                        <div class="flex gap-3 text-gray-500">
                            <button class="hover:text-primary transition" title="Customize Columns"><i class="ri-layout-column-line text-lg"></i></button>
                            <button class="hover:text-primary transition" title="Download Report"><i class="ri-download-line text-lg"></i></button>
                        </div>
                    </div>

                    <!-- Row 2: Tabs -->
                    <div class="flex gap-6">
                        <button onclick="switchSummaryTab(this, 'product')" class="summary-tab active text-sm font-bold text-primary border-b-2 border-primary pb-1 transition">Product</button>
                        <button onclick="switchSummaryTab(this, 'category')" class="summary-tab text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 pb-1 transition">Category</button>
                        <button onclick="switchSummaryTab(this, 'keyword')" class="summary-tab text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 pb-1 transition">Keyword</button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead><tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider"><th class="px-6 py-3">Name</th><th class="px-6 py-3">Spend</th><th class="px-6 py-3">Impr.</th><th class="px-6 py-3">Clicks</th><th class="px-6 py-3">CTR</th><th class="px-6 py-3">CPC</th><th class="px-6 py-3">CPM</th></tr></thead>
                        <tbody id="summaryTableBody" class="text-xs text-gray-700 divide-y divide-gray-100">
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Summer Sale Blast</td><td class="px-6 py-3">45,000</td><td class="px-6 py-3">1.2M</td><td class="px-6 py-3">450</td><td class="px-6 py-3 font-bold">3.2%</td><td class="px-6 py-3">12.00</td><td class="px-6 py-3">150.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Winter Collection</td><td class="px-6 py-3">12,000</td><td class="px-6 py-3">500K</td><td class="px-6 py-3">200</td><td class="px-6 py-3 font-bold">2.8%</td><td class="px-6 py-3">15.00</td><td class="px-6 py-3">180.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Brand Awareness</td><td class="px-6 py-3">8,400</td><td class="px-6 py-3">800K</td><td class="px-6 py-3">320</td><td class="px-6 py-3 font-bold">4.1%</td><td class="px-6 py-3">9.00</td><td class="px-6 py-3">100.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Diwali Bash</td><td class="px-6 py-3">95,000</td><td class="px-6 py-3">3.5M</td><td class="px-6 py-3">800</td><td class="px-6 py-3 font-bold">5.0%</td><td class="px-6 py-3">10.00</td><td class="px-6 py-3">120.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Lipstick Launch</td><td class="px-6 py-3">28,400</td><td class="px-6 py-3">950K</td><td class="px-6 py-3">410</td><td class="px-6 py-3 font-bold">3.9%</td><td class="px-6 py-3">14.00</td><td class="px-6 py-3">130.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Eye Liner Promo</td><td class="px-6 py-3">14,200</td><td class="px-6 py-3">400K</td><td class="px-6 py-3">180</td><td class="px-6 py-3 font-bold">2.5%</td><td class="px-6 py-3">16.00</td><td class="px-6 py-3">140.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Skin Care Glow</td><td class="px-6 py-3">18,500</td><td class="px-6 py-3">600K</td><td class="px-6 py-3">290</td><td class="px-6 py-3 font-bold">4.5%</td><td class="px-6 py-3">11.00</td><td class="px-6 py-3">110.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Weekend Flash</td><td class="px-6 py-3">6,000</td><td class="px-6 py-3">300K</td><td class="px-6 py-3">150</td><td class="px-6 py-3 font-bold">5.5%</td><td class="px-6 py-3">18.00</td><td class="px-6 py-3">190.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">New Year Bash</td><td class="px-6 py-3">150,000</td><td class="px-6 py-3">5.0M</td><td class="px-6 py-3">1200</td><td class="px-6 py-3 font-bold">4.8%</td><td class="px-6 py-3">12.00</td><td class="px-6 py-3">160.00</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Abandoned Cart</td><td class="px-6 py-3">32,000</td><td class="px-6 py-3">800K</td><td class="px-6 py-3">550</td><td class="px-6 py-3 font-bold">7.1%</td><td class="px-6 py-3">7.00</td><td class="px-6 py-3">90.00</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

<!-- AWARENESS PAGE -->
        <div id="page-awareness" class="page-section hidden">
            <!-- HERO: AWARENESS ADS BANNER -->
            <div class="bg-gradient-to-r from-[#9c00ad] to-[#6c0981] text-white rounded-xl h-64 flex justify-between items-center shadow-lg relative overflow-hidden mb-6">
                <!-- Left Text -->
                <div class="relative z-10 w-1/2 h-full flex flex-col justify-center pl-12">
                    <div class="inline-block bg-white/10 backdrop-blur-sm border border-white/20 rounded-full px-3 py-1 text-[10px] font-bold uppercase tracking-wider w-fit mb-3 flex items-center gap-2">
                        <i class="ri-broadcast-fill text-blue-300"></i> Brand Visibility
                    </div>
                    <h2 class="text-3xl font-bold flex items-center gap-3" id="awareness-banner-title">Boost Your Brand Reach</h2>
                    <p class="text-slate-300 text-lg mt-3 max-w-md" id="awareness-banner-desc">Reach millions of new customers. Increase recall with high-impact visuals.</p>
                </div>
                
                <!-- Right Illustration (for Visibility) -->
                <div id="awareness-banner-illustration" class="relative z-10 w-1/2 h-full flex items-center justify-center pr-10">
                    <svg width="350" height="200" viewBox="0 0 350 200" fill="none">
                        <circle cx="260" cy="100" r="80" stroke="white" stroke-opacity="0.1" stroke-width="1"/>
                        <circle cx="260" cy="100" r="60" stroke="white" stroke-opacity="0.1" stroke-width="1"/>
                        <circle cx="260" cy="100" r="40" stroke="white" stroke-opacity="0.2" stroke-width="1"/>
                        <circle cx="260" cy="100" r="15" fill="#3b82f6"/>
                        <path d="M260 92 L 260 108 M 252 100 L 268 100" stroke="white" stroke-width="3" stroke-linecap="round"/>
                        <line x1="260" y1="100" x2="180" y2="60" stroke="white" stroke-opacity="0.2" stroke-dasharray="4 4"/>
                        <line x1="260" y1="100" x2="180" y2="140" stroke="white" stroke-opacity="0.2" stroke-dasharray="4 4"/>
                        <g transform="translate(140, 40)">
                            <rect width="90" height="45" rx="8" fill="white" shadow="lg"/>
                            <text x="10" y="18" font-family="sans-serif" font-size="8" fill="#666" font-weight="bold">NEW USERS</text>
                            <text x="10" y="38" font-family="sans-serif" font-size="16" font-weight="bold" fill="#0f172a">+12.5k</text>
                            <circle cx="75" cy="22" r="6" fill="#bfdbfe"/>
                        </g>
                    </svg>
                </div>

                <!-- Right: February 2026 Mini Calendar (for Takeover - hidden by default) -->
                <div id="awareness-banner-calendar" class="relative z-10 w-1/2 h-full flex items-center justify-center pr-6 hidden">
                    <div class="bg-white/10 backdrop-blur-md rounded-xl p-4 border border-white/20" style="min-width: 320px;">
                        <div class="flex items-center justify-between mb-3">
                            <div class="text-sm font-bold">February 2026</div>
                            <div class="flex gap-2 text-[9px]">
                                <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-gray-300"></span>BAU</span>
                                <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-yellow-400"></span>Weekend</span>
                                <span class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-red-400 animate-pulse"></span>Sale</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-7 gap-1 text-center text-[10px]">
                            <div class="text-white/50 font-bold py-1">S</div>
                            <div class="text-white/50 font-bold py-1">M</div>
                            <div class="text-white/50 font-bold py-1">T</div>
                            <div class="text-white/50 font-bold py-1">W</div>
                            <div class="text-white/50 font-bold py-1">T</div>
                            <div class="text-white/50 font-bold py-1">F</div>
                            <div class="text-white/50 font-bold py-1">S</div>
                            <div class="py-1.5 rounded bg-yellow-400/30 text-yellow-200 font-bold">1</div>
                            <div class="py-1.5 rounded bg-white/5">2</div>
                            <div class="py-1.5 rounded bg-white/5">3</div>
                            <div class="py-1.5 rounded bg-white/5">4</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">5</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">6</div>
                            <div class="py-1.5 rounded bg-red-500/60 text-white font-bold ring-2 ring-red-400 animate-pulse">7</div>
                            <div class="py-1.5 rounded bg-red-500/60 text-white font-bold ring-2 ring-red-400 animate-pulse">8</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">9</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">10</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">11</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">12</div>
                            <div class="py-1.5 rounded bg-red-500/40 text-red-200 font-bold ring-2 ring-red-400/50">13</div>
                            <div class="py-1.5 rounded bg-red-500/60 text-white font-bold ring-2 ring-red-400 animate-pulse">14</div>
                            <div class="py-1.5 rounded bg-red-500/60 text-white font-bold ring-2 ring-red-400 animate-pulse">15</div>
                            <div class="py-1.5 rounded bg-white/5">16</div>
                            <div class="py-1.5 rounded bg-white/5">17</div>
                            <div class="py-1.5 rounded bg-white/5">18</div>
                            <div class="py-1.5 rounded bg-white/5">19</div>
                            <div class="py-1.5 rounded bg-white/5">20</div>
                            <div class="py-1.5 rounded bg-yellow-400/30 text-yellow-200 font-bold">21</div>
                            <div class="py-1.5 rounded bg-yellow-400/30 text-yellow-200 font-bold">22</div>
                            <div class="py-1.5 rounded bg-white/5">23</div>
                            <div class="py-1.5 rounded bg-white/5">24</div>
                            <div class="py-1.5 rounded bg-white/5">25</div>
                            <div class="py-1.5 rounded bg-white/5">26</div>
                            <div class="py-1.5 rounded bg-white/5">27</div>
                            <div class="py-1.5 rounded bg-yellow-400/30 text-yellow-200 font-bold">28</div>
                        </div>
                        <div class="mt-3 text-[10px] text-white/70 flex items-center gap-2">
                            <i class="ri-fire-fill text-red-400"></i>
                            <span><strong class="text-white">IHB Sale:</strong> Feb 515  High demand period</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- KPI & Graph Section -->
            <div class="grid grid-cols-12 gap-6 mb-6">
                <div class="col-span-4 flex flex-col gap-4 h-[420px]">
    <!-- KPI Card 1: Ad Impressions -->
    <div id="kpi-card-1" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary">
        <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(1, document.getElementById('kpi-title-1').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-1">Ad Impressions</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown1" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(1, 'Ad Impressions')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Ad Impressions</div>
                        <div onclick="updateKpiCard(1, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(1, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(1, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(1, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-1" class="text-2xl font-bold text-gray-900 mt-1">1.2M</div>
        </div>
        <div id="kpi-change-1" class="text-right text-xs font-bold text-primary-green bg-secondary-green px-2 py-1 rounded">+12.5%</div>
    </div>

    <!-- KPI Card 2: CTR -->
    <div id="kpi-card-2" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-lemon-green">
        <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(2, document.getElementById('kpi-title-2').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-2">CTR</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown2" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(2, 'CTR')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CTR</div>
                        <div onclick="updateKpiCard(2, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(2, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(2, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(2, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-2" class="text-2xl font-bold text-gray-900 mt-1">3.8%</div>
        </div>
        <div id="kpi-change-2" class="text-right text-xs font-bold text-primary-green bg-secondary-green px-2 py-1 rounded">+5.2%</div>
    </div>

    <!-- KPI Card 3: Ad Clicks -->
    <div id="kpi-card-3" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary-red">
            <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(3, document.getElementById('kpi-title-3').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-3">Ad Clicks</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown3" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(3, 'Ad Clicks')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Ad Clicks</div>
                        <div onclick="updateKpiCard(3, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(3, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(3, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(3, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-3" class="text-2xl font-bold text-gray-900 mt-1">45,000</div>
        </div>
        <div id="kpi-change-3" class="text-right text-xs font-bold text-primary-red bg-secondary-red px-2 py-1 rounded">-2.1%</div>
    </div>

    <!-- KPI Card 4: Tagged Product Revenue -->
    <div id="kpi-card-4" class="flex-1 bg-white p-4 rounded-xl border border-gray-100 shadow-card flex justify-between items-start border-l-4 border-l-primary-orange">
            <div class="flex-1">
            <div class="relative dropdown-container">
                <div onclick="openKpiDropdown(4, document.getElementById('kpi-title-4').innerText)" class="text-xs text-gray-500 font-bold uppercase flex items-center gap-1 cursor-pointer group">
                    <span id="kpi-title-4">Tagged Product Revenue</span>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary"></i>
                </div>
                <div id="kpiDropdown4" class="dropdown-enter absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                    <div class="py-1 max-h-48 overflow-y-auto">
                        <div onclick="updateKpiCard(4, 'Tagged Product Revenue')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Revenue</div>
                        <div onclick="updateKpiCard(4, 'Spend')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Spend</div>
                        <div onclick="updateKpiCard(4, 'CPM')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPM</div>
                        <div onclick="updateKpiCard(4, 'CPC')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">CPC</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product Orders')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Orders</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product View Products')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product View Products</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product Add to Cart')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product Add to Cart</div>
                        <div onclick="updateKpiCard(4, 'Tagged Product ROI')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer text-gray-700">Tagged Product ROI</div>
                    </div>
                </div>
            </div>
            <div id="kpi-value-4" class="text-2xl font-bold text-gray-900 mt-1"> 12.5L</div>
        </div>
        <div id="kpi-change-4" class="text-right text-xs font-bold text-gray-500 bg-gray-100 px-2 py-1 rounded">0.0%</div>
    </div>
</div>
                <div class="col-span-8 bg-white rounded-xl shadow-card border border-gray-100 p-6 chart-container h-[420px] flex flex-col">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-gray-800 text-lg">Performance Trends</h3>
                        <div class="flex bg-gray-100 p-1 rounded-lg" id="graphTabs">
                            <button onclick="updateGraph(this, 'day')" class="px-4 py-1 text-xs font-bold text-gray-900 bg-white shadow rounded-md transition">Day</button>
                            <button onclick="updateGraph(this, 'week')" class="px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition">Week</button>
                            <button onclick="updateGraph(this, 'month')" class="px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition">Month</button>
                        </div>
                    </div>
                    
                    <!-- ADDED ID="graphArea" HERE -->
                    <div id="graphArea" class="w-full flex-1 relative group cursor-crosshair">
                        
                        <!-- ADDED: MISSING DOT AND TOOLTIP ELEMENTS -->
                        <div id="chartDot" class="absolute w-3 h-3 bg-primary rounded-full border-2 border-white shadow-sm z-20 pointer-events-none transition-all duration-75 opacity-0 group-hover:opacity-100" style="top: 50%; left: 50%; transform: translate(-50%, -50%);"></div>
                        <div id="chartTooltip" class="absolute bg-white border border-gray-100 shadow-xl rounded-lg p-2 z-30 pointer-events-none transition-all duration-75 opacity-0 group-hover:opacity-100" style="top: 20%; left: 50%; min-width: 140px;">
                            <!-- JS will inject content here -->
                            <div></div> 
                        </div>

                        <!-- Grid Lines (Existing Code) -->
                        <div class="absolute inset-0 flex flex-col justify-between text-gray-300 text-[10px] pb-8 pl-2">
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">100%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">75%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">50%</span></div>
                            <div class="border-b border-gray-100 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">25%</span></div>
                            <div class="border-b border-gray-200 w-full h-0 relative"><span class="absolute -top-3 left-0 text-gray-400">0</span></div>
                        </div>
                        
                        <!-- SVG Lines (Added IDs lineSpend, lineImpr etc for JS logic) -->
                        <svg class="w-full h-full absolute inset-0 z-10 pb-8 pl-8" preserveAspectRatio="none" viewBox="0 0 1000 200">
                            <path id="lineSpend" class="graph-line-1" fill="none" stroke="#9c00ad" stroke-width="2" d="M0,180 L150,120 L300,160 L450,40 L600,100 L800,20 L1000,80" />
                            <path id="lineImpr" class="graph-line-2" fill="none" stroke="#84cc16" stroke-width="2" d="M0,150 C200,180 300,50 500,100 S800,150 1000,60" />
                            <path id="lineClicks" class="graph-line-3" fill="none" stroke="#b11d15" stroke-width="2" d="M0,190 L200,180 L400,140 L600,120 L800,60 L1000,40" />
                            <path id="lineCTR" class="graph-line-4" fill="none" stroke="#f97316" stroke-width="2" d="M0,100 Q300,150 600,50 T1000,20" />
                        </svg>
                        
                        <div class="absolute bottom-0 left-8 right-0 flex justify-between text-[10px] text-gray-400 font-medium pt-2"><span>Nov 20</span><span>Nov 21</span><span>Nov 22</span><span>Nov 23</span><span>Nov 24</span><span>Nov 25</span><span>Nov 26</span></div>
                    </div>
                </div>
            </div>

            <!-- TAKEOVER BID STATUS SECTION (hidden by default, shown for Takeover view) -->
            <div id="takeover-bid-status-section" class="bg-white rounded-xl shadow-card border border-gray-100 p-6 mb-6 hidden">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-700 rounded-lg flex items-center justify-center">
                            <i class="ri-auction-fill text-white text-lg"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800">Your Takeover Bids</h3>
                            <p class="text-xs text-gray-500">February 2026 bid status</p>
                        </div>
                    </div>
                    <button onclick="openAwarenessCreator('Takeover')" class="flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg text-xs font-bold hover:bg-primary-light transition">
                        <i class="ri-add-line"></i> Place New Bid
                    </button>
                </div>

                <!-- Empty State (hidden by default, shown when no bids) -->
                <div id="takeover-bids-empty" class="hidden py-12 text-center">
                    <div class="w-20 h-20 bg-purple-50 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="ri-auction-line text-4xl text-purple-300"></i>
                    </div>
                    <h4 class="font-bold text-gray-800 mb-2">No Bids Yet</h4>
                    <p class="text-sm text-gray-500 mb-4 max-w-md mx-auto">You haven't placed any takeover bids for February 2026. Get started by placing your first bid!</p>
                    <button onclick="openAwarenessCreator('Takeover')" class="px-5 py-2.5 bg-primary text-white font-bold rounded-lg hover:bg-primary-light transition inline-flex items-center gap-2">
                        <i class="ri-add-line"></i> Place Your First Bid
                    </button>
                </div>

                <!-- Bids Grid (shown when bids exist) -->
                <div id="takeover-bids-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    
                    <!-- Card 1: Full Homepage Takeover - WON -->
                    <div class="border-2 border-green-200 bg-green-50 rounded-xl p-4 relative overflow-hidden">
                        <div class="absolute top-2 right-2 text-2xl"></div>
                        <div class="flex items-center gap-2 mb-3">
                            <span class="px-2 py-0.5 bg-green-500 text-white text-[10px] font-bold rounded-full uppercase">Bid Won</span>
                        </div>
                        <div class="font-bold text-gray-900 text-sm mb-1">Full Homepage Takeover</div>
                        <div class="text-xs text-gray-600 mb-3 flex items-center gap-1">
                            <i class="ri-calendar-line"></i> 7th February 2026
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-xs mb-3">
                            <div class="bg-white rounded-lg p-2">
                                <div class="text-gray-500 text-[10px]">Floor Bid</div>
                                <div class="font-bold text-gray-700">7.5L</div>
                            </div>
                            <div class="bg-white rounded-lg p-2">
                                <div class="text-gray-500 text-[10px]">Your Winning Bid</div>
                                <div class="font-bold text-green-600">10L</div>
                            </div>
                        </div>
                        <button onclick="openTakeoverDetailsDrawer('full_hp_7feb')" class="w-full py-2 bg-green-600 text-white text-xs font-bold rounded-lg hover:bg-green-700 transition flex items-center justify-center gap-1">
                            <i class="ri-eye-line"></i> View Details
                        </button>
                    </div>

                    <!-- Card 2: Half Homepage Takeover - REJECTED -->
                    <div class="border border-red-200 bg-red-50/50 rounded-xl p-4 relative">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="px-2 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full uppercase">Bid Rejected</span>
                        </div>
                        <div class="font-bold text-gray-900 text-sm mb-1">Half Homepage Takeover</div>
                        <div class="text-xs text-gray-600 mb-3 flex items-center gap-1">
                            <i class="ri-calendar-line"></i> 7th February 2026
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-xs mb-3">
                            <div class="bg-white rounded-lg p-2">
                                <div class="text-gray-500 text-[10px]">Floor Bid</div>
                                <div class="font-bold text-gray-700">3.75L</div>
                            </div>
                            <div class="bg-white rounded-lg p-2">
                                <div class="text-gray-500 text-[10px]">Your Bid</div>
                                <div class="font-bold text-red-500">6L</div>
                            </div>
                        </div>
                        <div class="text-[10px] text-red-600 bg-red-100 rounded-lg p-2 mb-3 flex items-start gap-1">
                            <i class="ri-information-line mt-0.5"></i>
                            <span>Rejected: Full Homepage Takeover won for this day.</span>
                        </div>
                        <button onclick="openTakeoverDetailsDrawer('half_hp_7feb')" class="w-full py-2 bg-white border border-red-200 text-red-600 text-xs font-bold rounded-lg hover:bg-red-50 transition flex items-center justify-center gap-1">
                            <i class="ri-eye-line"></i> View Details
                        </button>
                    </div>

                    <!-- Card 3: L1 Skin Takeover - WON -->
                    <div class="border-2 border-green-200 bg-green-50 rounded-xl p-4 relative overflow-hidden">
                        <div class="absolute top-2 right-2 text-2xl"></div>
                        <div class="flex items-center gap-2 mb-3">
                            <span class="px-2 py-0.5 bg-green-500 text-white text-[10px] font-bold rounded-full uppercase">Bid Won</span>
                        </div>
                        <div class="font-bold text-gray-900 text-sm mb-1">L1 Skin Takeover</div>
                        <div class="text-xs text-gray-600 mb-3 flex items-center gap-1">
                            <i class="ri-calendar-line"></i> 8th February 2026
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-xs mb-3">
                            <div class="bg-white rounded-lg p-2">
                                <div class="text-gray-500 text-[10px]">Floor Bid</div>
                                <div class="font-bold text-gray-700">2.5L</div>
                            </div>
                            <div class="bg-white rounded-lg p-2">
                                <div class="text-gray-500 text-[10px]">Your Winning Bid</div>
                                <div class="font-bold text-green-600">4L</div>
                            </div>
                        </div>
                        <button onclick="openTakeoverDetailsDrawer('l1_skin_8feb')" class="w-full py-2 bg-green-600 text-white text-xs font-bold rounded-lg hover:bg-green-700 transition flex items-center justify-center gap-1">
                            <i class="ri-eye-line"></i> View Details
                        </button>
                    </div>

                    <!-- Card 4: Placeholder / Create New -->
                    <div class="border-2 border-dashed border-gray-200 bg-gray-50/50 rounded-xl p-4 flex flex-col items-center justify-center text-center cursor-pointer hover:border-primary hover:bg-purple-50/50 transition" onclick="openAwarenessCreator('Takeover')">
                        <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3">
                            <i class="ri-add-line text-2xl text-gray-400"></i>
                        </div>
                        <div class="font-bold text-gray-600 text-sm mb-1">Place a New Bid</div>
                        <div class="text-xs text-gray-500">Bid deadline: 20th of each month</div>
                    </div>
                </div>
            </div>

            <!-- Campaigns Table (Overview) - FULL 20 ROWS -->
            <div class="bg-white rounded-xl shadow-card border border-gray-100 flex flex-col mb-6">
                <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50 rounded-t-xl">
                    <div class="flex items-center gap-4">
                        <h3 class="font-bold text-gray-800">Campaigns</h3>
                        <div class="flex bg-gray-200 rounded-lg p-0.5">
                            <button onclick="toggleCampaignView('list')" id="btnList" class="p-1.5 rounded-md text-gray-700 bg-white shadow-sm transition"><i class="ri-list-check"></i></button>
                            <button onclick="toggleCampaignView('chart')" id="btnChart" class="p-1.5 rounded-md text-gray-500 hover:text-gray-700 transition"><i class="ri-bubble-chart-line"></i></button>
                        </div>
                    </div>
                        <div class="flex gap-2">
                        <div class="relative dropdown-container">
                            <button onclick="toggleId('filterDropdown')" class="px-3 py-1.5 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-50 flex items-center gap-1"><i class="ri-filter-3-line"></i> Filter</button>
                            <div id="filterDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-64 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                                <div class="p-3">
                                    <div class="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2">Filter By Status</div>
                                    <div class="max-h-40 overflow-y-auto space-y-1">
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Active" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Active</span></label>
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Paused" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Paused</span></label>
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Draft" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Draft</span></label>
                                        <label class="flex items-center gap-2 px-2 py-1 hover:bg-gray-50 rounded cursor-pointer"><input type="checkbox" value="Archived" class="filter-checkbox rounded text-primary focus:ring-primary border-gray-300"> <span class="text-xs">Archived</span></label>
                                    </div>
                                </div>
                                <div class="p-2 bg-gray-50 border-t border-gray-100 flex justify-end gap-2">
                                    <button onclick="clearFilters()" class="px-3 py-1 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-100">Clear</button>
                                    <button onclick="applyFilters()" class="px-3 py-1 bg-primary text-white rounded text-xs font-bold hover:bg-primary-light">Apply</button>
                                </div>
                            </div>
                        </div>
                        <div class="relative dropdown-container">
                            <button onclick="toggleId('viewDropdown')" class="px-3 py-1.5 bg-white border border-gray-200 rounded text-xs font-medium hover:bg-gray-50 flex items-center gap-1"><i id="currentViewIcon" class="ri-list-check"></i> <span id="currentViewLabel">List</span></button>
                            <div id="viewDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-40 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50">
                                <div class="py-1">
                                    <div onclick="switchLayout('list')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer flex items-center gap-2"><i class="ri-list-check"></i> List View</div>
                                    <div onclick="switchLayout('grid')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer flex items-center gap-2"><i class="ri-grid-fill"></i> Grid View</div>
                                    <div onclick="switchLayout('comfortable')" class="px-4 py-2 hover:bg-gray-50 text-xs cursor-pointer flex items-center gap-2"><i class="ri-layout-row-line"></i> Comfortable</div>
                                </div>
                            </div>
                        </div>
                        <button onclick="openAwarenessCreator(window.selectedAwarenessType)" class="flex items-center gap-1 px-4 py-1.5 bg-black text-white rounded text-xs font-bold shadow-md hover:bg-gray-800 transition"><i class="ri-add-line text-sm"></i> Create New Campaign</button>
                    </div>
                </div>
                <div class="overflow-x-auto block p-0" id="viewList">
                    <table class="w-full text-left border-collapse" id="campaignTable">
                        <thead><tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider"><th class="px-4 py-3 border-b">Status</th><th class="px-4 py-3 border-b">Name</th><th class="px-4 py-3 border-b">Type</th><th class="px-4 py-3 border-b text-right">Budget</th><th class="px-4 py-3 border-b text-right">Spend</th><th class="px-4 py-3 border-b text-right">Impr.</th><th class="px-4 py-3 border-b text-right">Clicks</th><th class="px-4 py-3 border-b text-right">CTR</th><th class="px-4 py-3 border-b text-center">Action</th></tr></thead>
                        <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Summer Sale</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">45k</td><td class="px-4 py-3 text-right">1.2M</td><td class="px-4 py-3 text-right">450</td><td class="px-4 py-3 text-right">3.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Winter Coll.</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">2k</td><td class="px-4 py-3 text-right">12k</td><td class="px-4 py-3 text-right">500K</td><td class="px-4 py-3 text-right">200</td><td class="px-4 py-3 text-right">2.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Brand Aware</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">1.5k</td><td class="px-4 py-3 text-right">8.4k</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">320</td><td class="px-4 py-3 text-right">4.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Ended"><td class="px-4 py-3"><span class="bg-gray-100 text-gray-500 px-2 py-1 rounded-md font-bold">Ended</span></td><td class="px-4 py-3 font-bold text-gray-500">Diwali Bash</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">95k</td><td class="px-4 py-3 text-right">3.5M</td><td class="px-4 py-3 text-right">800</td><td class="px-4 py-3 text-right">5.0%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Lipstick Launch</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">3.5k</td><td class="px-4 py-3 text-right">28k</td><td class="px-4 py-3 text-right">950K</td><td class="px-4 py-3 text-right">410</td><td class="px-4 py-3 text-right">3.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Eye Liner</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">2k</td><td class="px-4 py-3 text-right">14k</td><td class="px-4 py-3 text-right">400K</td><td class="px-4 py-3 text-right">180</td><td class="px-4 py-3 text-right">2.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Skin Care</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">4k</td><td class="px-4 py-3 text-right">32k</td><td class="px-4 py-3 text-right">600K</td><td class="px-4 py-3 text-right">290</td><td class="px-4 py-3 text-right">4.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Old Stock</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">1k</td><td class="px-4 py-3 text-right">5.6k</td><td class="px-4 py-3 text-right">150K</td><td class="px-4 py-3 text-right">8</td><td class="px-4 py-3 text-right">1.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Influencer</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">6k</td><td class="px-4 py-3 text-right">18k</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">410</td><td class="px-4 py-3 text-right">6.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Retargeting</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">3.2k</td><td class="px-4 py-3 text-right">22k</td><td class="px-4 py-3 text-right">720K</td><td class="px-4 py-3 text-right">350</td><td class="px-4 py-3 text-right">5.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Draft"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Holi Fest</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">10k</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Monsoon Sale</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">8k</td><td class="px-4 py-3 text-right">32k</td><td class="px-4 py-3 text-right">900K</td><td class="px-4 py-3 text-right">380</td><td class="px-4 py-3 text-right">3.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Black Friday</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">50k</td><td class="px-4 py-3 text-right">48k</td><td class="px-4 py-3 text-right">2.1M</td><td class="px-4 py-3 text-right">950</td><td class="px-4 py-3 text-right">4.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Archived"><td class="px-4 py-3"><span class="bg-red-50 text-red-600 px-2 py-1 rounded-md font-bold border border-red-100">Archived</span></td><td class="px-4 py-3 font-bold text-gray-400">2023 Clearance</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">120k</td><td class="px-4 py-3 text-right">4.5M</td><td class="px-4 py-3 text-right">1500</td><td class="px-4 py-3 text-right">2.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Cyber Monday</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">20k</td><td class="px-4 py-3 text-right">18k</td><td class="px-4 py-3 text-right">850K</td><td class="px-4 py-3 text-right">420</td><td class="px-4 py-3 text-right">5.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Valentine Special</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">12k</td><td class="px-4 py-3 text-right">45k</td><td class="px-4 py-3 text-right">1.1M</td><td class="px-4 py-3 text-right">500</td><td class="px-4 py-3 text-right">4.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Paused (Cap)"><td class="px-4 py-3"><span class="bg-yellow-50 text-yellow-600 px-2 py-1 rounded-md font-bold border border-yellow-100">Paused (Cap)</span></td><td class="px-4 py-3 font-bold">Eid Collection</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">5k</td><td class="px-4 py-3 text-right">200K</td><td class="px-4 py-3 text-right">90</td><td class="px-4 py-3 text-right">3.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Rakhi Special</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">7k</td><td class="px-4 py-3 text-right">21k</td><td class="px-4 py-3 text-right">650K</td><td class="px-4 py-3 text-right">310</td><td class="px-4 py-3 text-right">3.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Christmas Sale</td><td class="px-4 py-3">Reserv.</td><td class="px-4 py-3 text-right">30k</td><td class="px-4 py-3 text-right">150k</td><td class="px-4 py-3 text-right">3.2M</td><td class="px-4 py-3 text-right">1100</td><td class="px-4 py-3 text-right">4.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                            <tr class="hover:bg-secondary/30 transition campaign-row" data-status="Active"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Flash Sale 2.0</td><td class="px-4 py-3">Auction</td><td class="px-4 py-3 text-right">4k</td><td class="px-4 py-3 text-right">16k</td><td class="px-4 py-3 text-right">450K</td><td class="px-4 py-3 text-right">220</td><td class="px-4 py-3 text-right">6.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="viewChart" class="hidden relative w-full h-[450px] font-sans">
                    <!-- Quadrant Labels -->
                    <div class="absolute top-6 left-16 bg-primary-50 border border-primary-100 text-primary-600 px-3 py-1 rounded text-xs font-bold z-10">Potential (Low Spend, High Perf)</div>
                    <div class="absolute top-6 right-6 bg-green-50 border border-green-100 text-green-600 px-3 py-1 rounded text-xs font-bold z-10">Winner (High Spend, High Perf)</div>
                    <div class="absolute bottom-12 left-16 bg-gray-50 border border-gray-200 text-gray-500 px-3 py-1 rounded text-xs font-bold z-10">Poor (Low Spend, Low Perf)</div>
                    <div class="absolute bottom-12 right-6 bg-orange-50 border border-orange-100 text-orange-600 px-3 py-1 rounded text-xs font-bold z-10">Bleeder (High Spend, Low Perf)</div>
                
                    <!-- SVG for Grid Lines ONLY -->
                    <svg class="absolute inset-0 w-full h-full z-0 pointer-events-none" viewBox="0 0 1000 400" preserveAspectRatio="none">
                        <line x1="50" y1="350" x2="980" y2="350" stroke="#e5e7eb" stroke-width="2" />
                        <line x1="50" y1="20" x2="50" y2="350" stroke="#e5e7eb" stroke-width="2" />
                        <line x1="515" y1="20" x2="515" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5" />
                        <line x1="50" y1="185" x2="980" y2="185" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5" />
                        <text x="35" y="350" text-anchor="end" class="text-[10px] fill-gray-400 font-medium">0%</text>
                        <text x="35" y="190" text-anchor="end" class="text-[10px] fill-gray-400 font-medium">3%</text>
                        <text x="35" y="30" text-anchor="end" class="text-[10px] fill-gray-400 font-medium">6%</text>
                        <text x="10" y="200" text-anchor="middle" transform="rotate(-90 10,200)" class="text-xs fill-gray-500 font-bold">CTR (%)</text>
                        <text x="50" y="370" text-anchor="middle" class="text-[10px] fill-gray-400 font-medium">0</text>
                        <text x="515" y="370" text-anchor="middle" class="text-[10px] fill-gray-400 font-medium">50k</text>
                        <text x="980" y="370" text-anchor="middle" class="text-[10px] fill-gray-400 font-medium">100k</text>
                        <text x="515" y="385" text-anchor="middle" class="text-xs fill-gray-500 font-bold">Total Spend ()</text>
                    </svg>

                    <!-- HTML Data Points -->
                    <div class="absolute rounded-full bg-gray-100 border-2 border-gray-200 z-0 opacity-50" style="left: 50%; top: 45%; width: 40px; height: 40px; transform: translate(-50%, -50%);"></div>
                    <div class="absolute rounded-full bg-gray-100 border-2 border-gray-200 z-0 opacity-50" style="left: 53%; top: 52.5%; width: 30px; height: 30px; transform: translate(-50%, -50%);"></div>
                    <div class="absolute rounded-full bg-gray-100 border-2 border-gray-200 z-0 opacity-50" style="left: 49%; top: 50%; width: 24px; height: 24px; transform: translate(-50%, -50%);"></div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 20%; top: 30%; transform: translate(-50%, -50%);">
                        <div class="w-10 h-10 rounded-full bg-[#74a58b]/80 border-2 border-[#487e63]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Brand Aware</span>
                    </div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 65%; top: 40%; transform: translate(-50%, -50%);">
                        <div class="w-[50px] h-[50px] rounded-full bg-[#74a58b]/80 border-2 border-[#487e63]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Summer Sale</span>
                    </div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 85%; top: 20%; transform: translate(-50%, -50%);">
                        <div class="w-[90px] h-[90px] rounded-full bg-[#cf7bd4]/80 border-2 border-[#9c00ad]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Diwali Bash</span>
                    </div>
                    <div class="absolute group cursor-pointer hover:opacity-80 transition z-20 flex items-center gap-2" style="left: 25%; top: 70%; transform: translate(-50%, -50%);">
                        <div class="w-[30px] h-[30px] rounded-full bg-[#fca5a5]/80 border-2 border-[#ea580c]"></div>
                        <span class="text-xs font-bold text-gray-800 whitespace-nowrap">Winter Coll.</span>
                    </div>
                </div>
                <div id="viewGrid" class="hidden p-6 grid grid-cols-2 gap-6"></div>
                <div id="viewComfortable" class="hidden p-6 grid grid-cols-1 gap-4"></div>
                <div class="p-3 bg-gray-50 rounded-b-xl border-t border-gray-100 text-center">
                    <button class="text-primary font-bold text-xs hover:underline">View All 25 Campaigns</button>
                </div>
            </div>

            <!-- TAKEOVER SUCCESS MODAL -->
            <div id="takeover-success-overlay" class="fixed inset-0 bg-black/60 z-50 hidden flex items-center justify-center" onclick="closeTakeoverSuccessModal()">
                <div class="bg-white rounded-2xl shadow-2xl w-[480px] max-w-[95%] p-8 text-center transform scale-100 animate-bounce-in" onclick="event.stopPropagation()">
                    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="ri-check-line text-4xl text-green-600"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Bid Submitted Successfully!</h2>
                    <p class="text-gray-500 mb-6">Your takeover bid has been submitted. You'll be notified once the auction results are announced on the 20th.</p>
                    <div id="takeover-success-summary" class="bg-gray-50 rounded-xl p-4 mb-6 text-left">
                        <!-- Summary populated by JS -->
                    </div>
                    <div class="flex gap-3 justify-center">
                        <button onclick="closeTakeoverSuccessModal()" class="px-6 py-2.5 border border-gray-200 text-gray-600 font-bold rounded-lg hover:bg-gray-50 transition">Close</button>
                        <button onclick="closeTakeoverSuccessModal(); document.getElementById('nav-awareness-takeover').click();" class="px-6 py-2.5 bg-primary text-white font-bold rounded-lg hover:bg-primary-light transition">View My Bids</button>
                    </div>
                </div>
            </div>

            <!-- TAKEOVER BID DETAILS DRAWER -->
            <div id="takeover-details-overlay" class="fixed inset-0 bg-black/50 z-50 hidden" onclick="closeTakeoverDetailsDrawer()"></div>
            <div id="takeover-details-drawer" class="fixed top-0 right-0 h-full w-[500px] bg-white shadow-2xl z-50 transform translate-x-full transition-transform duration-300 flex flex-col">
                <div class="p-6 border-b border-gray-100 flex-shrink-0">
                    <div class="flex items-center justify-between">
                        <h2 class="text-lg font-bold text-gray-900">Bid Details</h2>
                        <button onclick="closeTakeoverDetailsDrawer()" class="w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400 hover:text-gray-600 transition">
                            <i class="ri-close-line text-xl"></i>
                        </button>
                    </div>
                </div>
                <div id="takeover-details-content" class="flex-1 overflow-y-auto p-6">
                    <!-- JS will populate -->
                </div>
            </div>

        </div>
        
        <!-- ================= BUNDLES (Fixed Packages) ================= -->
        <div id="page-bundles" class="page-section hidden">
            <!-- HERO: BUNDLES -->
            <div class="bg-gradient-to-r from-[#0f172a] to-[#1f2937] text-white rounded-xl h-56 flex justify-between items-center shadow-lg relative overflow-hidden mb-6">
                <div class="relative z-10 w-1/2 h-full flex flex-col justify-center pl-12">
                    <div class="inline-block bg-white/10 backdrop-blur-sm border border-white/20 rounded-full px-3 py-1 text-[10px] font-bold uppercase tracking-wider w-fit mb-3 flex items-center gap-2">
                        <i class="ri-stack-line text-yellow-300"></i> Fixed Packages
                    </div>
                    <h2 class="text-3xl font-bold flex items-center gap-3">Bundles</h2>
                    <p class="text-slate-300 text-base mt-3 max-w-md">Buy access to a predefined set of placements. No bidding. Serving is fair-share across participating brands.</p>
                    <div class="mt-5 flex items-center gap-3">
                        <button onclick="openBundleCreator()" class="bg-white text-gray-900 px-5 py-2.5 rounded-lg font-bold shadow-lg hover:bg-gray-100 transition text-xs">
                            <i class="ri-add-line"></i> Create Bundle Campaign
                        </button>
                        <button onclick="alert('Bundle catalog managed by Business/Admin in v1')" class="border border-white/30 text-white px-5 py-2.5 rounded-lg font-bold hover:bg-white/10 transition text-xs">
                            View Admin Rules
                        </button>
                    </div>
                </div>
                <div class="relative z-10 w-1/2 h-full flex items-center justify-center pr-10">
                    <div class="grid grid-cols-3 gap-4 w-full max-w-md">
                        <div class="bg-white/10 border border-white/15 rounded-xl p-4">
                            <div class="text-xs font-bold tracking-wide text-white/80">SILVER</div>
                            <div class="text-lg font-bold mt-1">Entry</div>
                            <div class="text-xs text-white/70 mt-2">HP CB3 + L1 Categories + L2 Categories</div>
                        </div>
                        <div class="bg-white/10 border border-white/15 rounded-xl p-4">
                            <div class="text-xs font-bold tracking-wide text-white/80">GOLD</div>
                            <div class="text-lg font-bold mt-1">Core</div>
                            <div class="text-xs text-white/70 mt-2">HP CB2 + Brand Page (Curated Brands)</div>
                        </div>
                        <div class="bg-white/10 border border-white/15 rounded-xl p-4">
                            <div class="text-xs font-bold tracking-wide text-white/80">PLATINUM</div>
                            <div class="text-lg font-bold mt-1">Premium</div>
                            <div class="text-xs text-white/70 mt-2">HP CB1 + Thank You Page</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bundle Catalog Cards -->
            <div class="grid grid-cols-12 gap-6 mb-6">
                <div class="col-span-8 bg-white rounded-xl shadow-card border border-gray-100 p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-gray-900">Bundle Catalog</h3>
                        <div class="text-xs text-gray-500">Bundles are mutually exclusive. Overlap not allowed.</div>
                    </div>
                    <div class="grid grid-cols-3 gap-4">
                        <!-- Silver -->
                        <div class="border border-gray-100 rounded-xl p-4 hover:shadow-md transition">
                            <div class="flex items-center justify-between">
                                <div class="text-xs font-bold text-gray-500">SILVER</div>
                                <span class="tag" style="background:#f1f5f9; color:#334155;">No bidding</span>
                            </div>
                            <div class="text-lg font-bold text-gray-900 mt-2">Silver Bundle</div>
                            <ul class="mt-3 text-xs text-gray-600 space-y-1">
                                <li> Homepage: Celeb Banner 3</li>
                                <li> L1 Category Pages</li>
                                <li> L2 Category Pages</li>
                            </ul>
                            <div class="mt-4 flex items-center gap-2">
                                <button onclick="openBundleCreator('Silver')" class="bg-primary text-white px-3 py-2 rounded-lg text-xs font-bold hover:bg-primary-dark transition">Create</button>
                                <button onclick="alert('Pricing is configured in Admin in v1')" class="border border-gray-200 text-gray-700 px-3 py-2 rounded-lg text-xs font-bold hover:bg-gray-50 transition">View Price</button>
                            </div>
                        </div>
                        <!-- Gold -->
                        <div class="border border-gray-100 rounded-xl p-4 hover:shadow-md transition">
                            <div class="flex items-center justify-between">
                                <div class="text-xs font-bold text-gray-500">GOLD</div>
                                <span class="tag" style="background:#fef3c7; color:#92400e;">High demand</span>
                            </div>
                            <div class="text-lg font-bold text-gray-900 mt-2">Gold Bundle</div>
                            <ul class="mt-3 text-xs text-gray-600 space-y-1">
                                <li> Homepage: Celeb Banner 2</li>
                                <li> L1 Brand Page: Curated Brands</li>
                            </ul>
                            <div class="mt-4 flex items-center gap-2">
                                <button onclick="openBundleCreator('Gold')" class="bg-primary text-white px-3 py-2 rounded-lg text-xs font-bold hover:bg-primary-dark transition">Create</button>
                                <button onclick="alert('Pricing is configured in Admin in v1')" class="border border-gray-200 text-gray-700 px-3 py-2 rounded-lg text-xs font-bold hover:bg-gray-50 transition">View Price</button>
                            </div>
                        </div>
                        <!-- Platinum -->
                        <div class="border border-gray-100 rounded-xl p-4 hover:shadow-md transition">
                            <div class="flex items-center justify-between">
                                <div class="text-xs font-bold text-gray-500">PLATINUM</div>
                                <span class="tag" style="background:#ede9fe; color:#5b21b6;">Premium</span>
                            </div>
                            <div class="text-lg font-bold text-gray-900 mt-2">Platinum Bundle</div>
                            <ul class="mt-3 text-xs text-gray-600 space-y-1">
                                <li> Homepage: Celeb Banner 1</li>
                                <li> Thank You Page: Tiles</li>
                            </ul>
                            <div class="mt-4 flex items-center gap-2">
                                <button onclick="openBundleCreator('Platinum')" class="bg-primary text-white px-3 py-2 rounded-lg text-xs font-bold hover:bg-primary-dark transition">Create</button>
                                <button onclick="alert('Pricing is configured in Admin in v1')" class="border border-gray-200 text-gray-700 px-3 py-2 rounded-lg text-xs font-bold hover:bg-gray-50 transition">View Price</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-span-4 bg-white rounded-xl shadow-card border border-gray-100 p-6">
                    <h3 class="font-bold text-gray-900 mb-4">Rules (v1)</h3>
                    <div class="space-y-3 text-xs text-gray-700">
                        <div class="flex gap-2"><i class="ri-check-line text-primary"></i> No targeting in Bundles (access product).</div>
                        <div class="flex gap-2"><i class="ri-check-line text-primary"></i> Serving uses fair-share rotation across eligible brands.</div>
                        <div class="flex gap-2"><i class="ri-check-line text-primary"></i> Delivery/impressions are tracked at <b>brand_id</b> level (not asset_id) to prevent double allocation on creative swaps.</div>
                        <div class="flex gap-2"><i class="ri-check-line text-primary"></i> Creatives can be changed mid-month via replace flow (new creatives must be approved before swap).</div>
                    </div>
                </div>
            </div>

            <!-- Active Bundles Table (Placeholder) -->
            <div class="bg-white rounded-xl shadow-card border border-gray-100 flex flex-col mb-10">
                <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                    <h3 class="font-bold text-gray-800 text-left">Active Bundle Campaigns</h3>
                    <button onclick="openBundleCreator()" class="text-xs font-bold text-primary hover:underline">Create New</button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider">
                                <th class="px-6 py-3">Campaign</th>
                                <th class="px-6 py-3">Tier</th>
                                <th class="px-6 py-3">Month</th>
                                <th class="px-6 py-3">Status</th>
                                <th class="px-6 py-3 text-right">Impr. Delivered</th>
                                <th class="px-6 py-3 text-right">Fair-Share Cap</th>
                            </tr>
                        </thead>
                        <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-3 font-medium text-gray-900">Silver | Jan 2026</td>
                                <td class="px-6 py-3"><span class="tag" style="background:#f1f5f9; color:#334155;">Silver</span></td>
                                <td class="px-6 py-3">Jan 2026</td>
                                <td class="px-6 py-3"><span class="tag" style="background:#dcfce7; color:#166534;">Running</span></td>
                                <td class="px-6 py-3 text-right">1.2M</td>
                                <td class="px-6 py-3 text-right">~1.6M / day</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-3 font-medium text-gray-900">Gold | Jan 2026</td>
                                <td class="px-6 py-3"><span class="tag" style="background:#fef3c7; color:#92400e;">Gold</span></td>
                                <td class="px-6 py-3">Jan 2026</td>
                                <td class="px-6 py-3"><span class="tag" style="background:#fee2e2; color:#991b1b;">Pending Creatives</span></td>
                                <td class="px-6 py-3 text-right">0</td>
                                <td class="px-6 py-3 text-right">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ================= CREATE BUNDLE CAMPAIGN (Simple Flow) ================= -->
        <div id="page-create-bundle" class="page-section hidden">
            <div class="perf-creator-wrapper">
                <div class="perf-creator-header flex justify-between items-center">
                    <span>Bundles / Create (Draft)</span>
                    <div>
                        <a href="#" class="text-sm font-medium text-primary hover:underline"><i class="ri-question-line"></i> Bundle rules</a>
                        <button class="ml-6 text-gray-400 hover:text-gray-700" onclick="navigateTo('bundles', '', 'Home / Campaigns / <span class=\'text-primary font-bold\'>Bundles</span>')"><i class="ri-close-line text-2xl"></i></button>
                    </div>
                </div>

                <div class="perf-creator-body" style="align-items: flex-start;">
                    <div class="w-full">
                        <h3 style="font-weight: 700; font-size: 16px; color: #0f172a; margin-bottom: 16px;">Bundle Settings</h3>
                        <div class="ss-card" style="margin-bottom: 16px;">
                            <div class="ss-input-grid">
                                <div class="input-group-clean">
                                    <label class="input-label">Campaign Name</label>
                                    <input type="text" value="Bundle | Jan 2026" class="clean-input">
                                </div>
                                <div class="input-group-clean">
                                    <label class="input-label">Bundle Tier</label>
                                    <select id="bundleTierSelect" class="clean-input">
                                        <option>Silver</option>
                                        <option>Gold</option>
                                        <option>Platinum</option>
                                    </select>
                                </div>
                                <div class="input-group-clean">
                                    <label class="input-label">Month</label>
                                    <select class="clean-input">
                                        <option>Jan 2026</option>
                                        <option>Feb 2026</option>
                                        <option>Mar 2026</option>
                                    </select>
                                </div>
                                <div class="input-group-clean">
                                    <label class="input-label">Landing URL</label>
                                    <input type="text" placeholder="https://..." class="clean-input">
                                </div>
                            </div>
                        </div>

                        <h3 style="font-weight: 700; font-size: 16px; color: #0f172a; margin-bottom: 16px;">Creatives</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white border border-gray-100 rounded-xl p-5 shadow-card">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="text-xs font-bold text-gray-700">App Banner</div>
                                        <div class="text-[11px] text-gray-500 mt-1">Upload 1 image per required format (as configured per pool).</div>
                                    </div>
                                    <button onclick="openAdModal()" class="px-3 py-2 text-xs font-bold text-white bg-primary rounded-lg hover:bg-primary-dark transition">
                                        Upload
                                    </button>
                                </div>
                                <div class="mt-4 text-[11px] text-gray-500">Status: <span class="font-bold text-orange-600">Pending Upload</span></div>
                            </div>
                            <div class="bg-white border border-gray-100 rounded-xl p-5 shadow-card">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="text-xs font-bold text-gray-700">Web Banner</div>
                                        <div class="text-[11px] text-gray-500 mt-1">Upload 1 image per required format (as configured per pool).</div>
                                    </div>
                                    <button onclick="openAdModal()" class="px-3 py-2 text-xs font-bold text-white bg-primary rounded-lg hover:bg-primary-dark transition">
                                        Upload
                                    </button>
                                </div>
                                <div class="mt-4 text-[11px] text-gray-500">Status: <span class="font-bold text-orange-600">Pending Upload</span></div>
                            </div>
                        </div>

                        <div class="bg-gray-50 border border-gray-200 rounded-xl p-4 mt-4 text-xs text-gray-700">
                            <div class="font-bold mb-2">Notes</div>
                            <ul class="space-y-1">
                                <li> Campaign will start only after creatives are approved.</li>
                                <li> Mid-month creative replace is allowed; delivery remains tracked at brand_id level.</li>
                                <li> Bundles do not support targeting in v1.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="perf-creator-footer" style="display:flex; justify-content: flex-end; gap: 12px;">
                    <button class="cc-button" onclick="navigateTo('bundles', '', 'Home / Campaigns / <span class=\\'text-primary font-bold\\'>Bundles</span>')" style="background-color: #fff; border:1px solid #e5e7eb; color:#111827; min-width: 140px;">Cancel</button>
                    <button class="cc-button" onclick="alert('Bundle Campaign Submitted for Approval!')" style="background-color: var(--primary); color: #fff; min-width: 180px;">Submit for Approval</button>
                </div>
            </div>
        </div>


        <!-- 2. CREATE CAMPAIGN WIZARD (MERGED CODE 2 - CORRECTED) -->
        <div id="page-create-campaign" class="page-section hidden wizard-wrapper">
    <div class="cc-module-container">
        <header class="cc-header">
            <div class="cc-stepper" id="stepper">
                <div class="cc-step active" data-step="1"><i class="fa-solid fa-layer-group step-icon"></i>&nbsp; Step 1: Inventory</div>
                <div class="cc-step" data-step="2"><i class="fa-solid fa-bullseye step-icon"></i>&nbsp; Step 2: Targeting</div>
                <div class="cc-step" data-step="3"><i class="fa-solid fa-image step-icon"></i>&nbsp; Step 3: Ads</div>
                <div class="cc-step" data-step="4"><i class="fa-solid fa-gear step-icon"></i>&nbsp; Step 4: Config</div>
            </div>
        </header>
    
        <main class="cc-steps-container">
            <!-- STEP 1 CONTENT -->
            <div class="step-content active" id="step-1-content">
                <div class="inventory-workspace">
                    <section class="inventory-column"><div class="inventory-column-header"><h3><i class="fa-solid fa-file-lines"></i> Choose a Page</h3></div><div class="inventory-column-content" id="page-list-container"></div></section>
                    <section class="inventory-column"><div class="inventory-column-header"><h3><i class="fa-solid fa-list-check"></i> Select Inventories <span class="count-badge" id="inventory-available-count">0</span></h3></div><div class="inventory-column-content" id="inventory-list-container"></div></section>
                    <aside class="inventory-column inventory-summary"><div class="inventory-column-header"><h3><i class="fa-solid fa-cart-shopping"></i> Your Selections <span class="count-badge" id="summary-count">0</span></h3></div><div class="inventory-column-content" id="summary-list-container"></div></aside>
                </div>
            </div>
    
            <!-- STEP 2 CONTENT -->
            <div class="step-content" id="step-2-content">
                <div class="targeting-page-content">
                    <h2>Set Your Targets</h2><p style="color: var(--cc-text-light); margin-top: 8px; margin-bottom: 24px;">Select locations, audiences, and other criteria for this campaign.</p>
                    <div class="targeting-accordion" id="targeting-accordion">
                        <div class="accordion-item" data-accordion="geo">
    <div class="accordion-header">
        <i class="fa-solid fa-map-location-dot accordion-icon"></i>
        <div class="accordion-title-block">
            <h4>Geo Location</h4>
            <p id="geo-desc">Target users by State. If available, further refine by Quick / Non-Quick users within the selected state.</p>
        </div>
        <span class="accordion-summary" id="geo-summary"></span>
        <span class="accordion-badge" id="geo-badge">ALL STATES</span>
        <i class="fa-solid fa-chevron-down accordion-arrow"></i>
    </div>
    <div class="accordion-content">
        <div class="geo-location-content">
            <div class="geo-column">
                <h5>Included States (upto 20)</h5>
                <div class="location-input-wrapper" style="gap: 10px; align-items: flex-start;">
                    <div style="flex: 1;">
                        <label style="font-size: 12px; color: var(--cc-text-light); display: block; margin-bottom: 6px;">State</label>
                        <select class="form-select" id="include-state-select" style="width: 100%; height: 40px;">
                            <option value="">Select state</option>
                            <option value="ALL_STATES">All States</option>
                        </select>
                    </div>
                    <div style="flex: 1;">
                        <label style="font-size: 12px; color: var(--cc-text-light); display: block; margin-bottom: 6px;">Quickness (optional)</label>
                        <select class="form-select" id="include-speed-select" style="width: 100%; height: 40px;" disabled>
                            <option value="ALL">All users in state</option>
                            <option value="QUICK">Quick</option>
                            <option value="NON_QUICK">Non-Quick</option>
                        </select>
                        <div style="font-size: 11px; color: var(--cc-text-light); margin-top: 4px;" id="quickness-hint">Select a state to check availability</div>
                    </div>
                    <div style="padding-top: 22px;">
                        <button class="cc-button" id="include-add-btn" style="height: 40px; padding: 0 14px; border-radius: 8px;">Add</button>
                    </div>
                </div>
                <div class="location-pills" id="included-pills" style="margin-top: 14px;"></div>
                <!-- Overlap error message -->
                <div id="geo-overlap-error" class="hidden" style="margin-top: 10px; padding: 10px 14px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; color: #dc2626; font-size: 12px; display: flex; align-items: center; gap: 8px;">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <span>Warning: Same state in Include and Exclude results in 0% targeting (100% overlap). Remove the duplicate.</span>
                </div>
            </div>

            <div class="geo-column">
                <h5>Excluded States (upto 20)</h5>
                <div class="location-input-wrapper" style="gap: 10px; align-items: flex-start;">
                    <div style="flex: 1;">
                        <label style="font-size: 12px; color: var(--cc-text-light); display: block; margin-bottom: 6px;">State</label>
                        <select class="form-select" id="exclude-state-select" style="width: 100%; height: 40px;">
                            <option value="">Select state</option>
                        </select>
                    </div>
                    <div style="padding-top: 22px;">
                        <button class="cc-button" id="exclude-add-btn" style="height: 40px; padding: 0 14px; border-radius: 8px; background:#fff; border: 1px solid var(--cc-border-color); color: var(--cc-text-dark);">Exclude</button>
                    </div>
                </div>
                <div class="location-pills" id="excluded-pills" style="margin-top: 14px;"></div>
            </div>
        </div>
    </div>
</div>
<div class="accordion-item" data-accordion="audience"><div class="accordion-header"><i class="fa-solid fa-users-viewfinder accordion-icon"></i><div class="accordion-title-block"><h4>Audience Targeting</h4><p>Target prospective customers and deliver personalised ads.</p></div><span class="accordion-summary" id="audience-summary"></span><span class="accordion-badge" id="audience-badge">ALL USERS</span><i class="fa-solid fa-chevron-down accordion-arrow"></i></div><div class="accordion-content"><div class="audience-content"><div class="audience-main-panel"><div class="generic-tabs audience-tabs"><div class="generic-tab active" data-tab="select">Select Audience</div><div class="generic-tab" data-tab="create">Create New</div></div><div class="audience-tab-content" id="audience-select-content"><input type="text" class="form-input" placeholder="Search audience clusters..." style="margin-bottom: 16px;"><div class="audience-list"><label class="audience-item"><input type="checkbox"><div><h4>Air pods pro</h4><p>Prime Members who has viewed but not purchased in last 12 days</p></div></label><label class="audience-item"><input type="checkbox"><div><h4>Google Pixel 6</h4><p>People who Purchased the product 90 days back</p></div></label></div></div><div class="audience-tab-content" id="audience-create-content" style="display: none;"><div class="form-group"><label for="audience-name">Audience Name</label><input type="text" id="audience-name" class="form-input" placeholder="e.g., User set 1"></div><div class="form-group"><label>Select User Attributes</label><div class="rule-builder" id="audience-rule-builder"><div class="rule-row"><select class="form-select"><option>Property</option></select><select class="form-select"><option>Operator</option></select><select class="form-select"><option>Value</option></select><i class="fa-solid fa-trash-can remove-rule-btn" style="visibility: hidden;"></i></div></div><i class="fa-solid fa-circle-plus add-rule-btn" data-builder="audience-rule-builder"></i></div></div></div><div class="audience-reach-panel"><h5>Audience Reach</h5><div class="audience-reach-gauge"><div class="reach-needle" id="reach-needle"></div></div><p style="font-size: 13px; color: var(--cc-text-light); margin-top: 8px;">Potential Reach</p><div class="reach-value" id="reach-value">76,890</div></div></div></div></div>
                    </div>
                </div>
            </div>
    
            <!-- STEP 3 CONTENT -->
            <div class="step-content" id="step-3-content">
                <div class="ads-workspace">
                    
                    <!-- Left Panel (Inventory List) -->
                    <div class="inventory-nav-panel">
                        <ul class="inventory-nav-list" id="inventory-nav-list">
                            <!-- JS will populate this -->
                        </ul>
                    </div>

                    <!-- Right Panel (Grid) -->
                    <div class="ad-details-panel">
                        <h3 id="ad-panel-title">Select an Inventory</h3>
                        <p class="panel-desc" id="ad-panel-desc">Choose an inventory from the left to start uploading ads.</p>
                        <div class="ad-upload-area" id="ad-upload-area" style="margin-top: 32px;"></div>
                    </div>
                </div>

                <!-- Create Ad Modal (Hidden) -->
                <div class="modal-backdrop" id="modal-backdrop"></div>
                
                <!-- NEW: Spacious Create Ad Modal (Fixed) -->
                <div class="modal" id="create-ad-modal">
                    <!-- Fixed Header -->
                    <div class="modal-header">
                        <div>
                            <h4 style="display: flex; align-items: center; gap: 10px;">
                                Create Standard Tile 
                                <span style="font-size: 11px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 4px 8px; border-radius: 4px;">Horizontal Long</span>
                            </h4>
                        </div>
                        <i class="fa-solid fa-xmark close-btn"></i>
                    </div>
                    
                    <!-- Scrollable Body -->
                    <div class="modal-body-split">
                        
                        <!-- LEFT: Inputs -->
                        <div class="modal-left-panel">
                            <!-- Ad Name -->
                            <div class="input-group-clean">
                                <label class="input-label">Ad Name <span style="color:red">*</span> <span>0/35</span></label>
                                <input type="text" id="ad-name-input" class="clean-input" placeholder="e.g., Summer Sale Hero Banner">
                            </div>

                            <!-- Upload Section -->
                            <div class="input-group-clean">
                                <label class="input-label" style="margin-bottom: 16px;">Creative Assets</label>
                                <div class="upload-grid">
                                    <!-- Web Box -->
                                    <div class="upload-card" style="position: relative;">
                                        <div class="upload-action-overlay" id="web-overlay">
                                            <div class="icon-btn-sm btn-replace" onclick="document.getElementById('web-upload-input').click()" title="Replace"><i class="ri-refresh-line"></i></div>
                                            <div class="icon-btn-sm btn-delete" id="web-delete-btn" title="Delete"><i class="ri-delete-bin-line"></i></div>
                                        </div>
                                        <div class="upload-dashed" onclick="document.getElementById('web-upload-input').click()">
                                            <i class="ri-upload-cloud-2-line" id="web-icon" style="font-size: 32px; color: #cbd5e1; margin-bottom: 12px;"></i>
                                            <span style="font-size:13px; font-weight:600; color:#475569;" id="web-upload-label">Web Image</span>
                                        </div>
                                        <div class="upload-meta">
                                            <span>JPG, PNG</span>
                                            <span>320x420 px</span>
                                        </div>
                                        <input type="file" id="web-upload-input" hidden accept="image/png, image/jpeg">
                                    </div>
                                    
                                    <!-- App Box -->
                                    <div class="upload-card" style="position: relative;">
                                        <div class="upload-action-overlay" id="app-overlay">
                                            <div class="icon-btn-sm btn-replace" onclick="document.getElementById('app-upload-input').click()" title="Replace"><i class="ri-refresh-line"></i></div>
                                            <div class="icon-btn-sm btn-delete" id="app-delete-btn" title="Delete"><i class="ri-delete-bin-line"></i></div>
                                        </div>
                                        <div class="upload-dashed" onclick="document.getElementById('app-upload-input').click()">
                                            <i class="ri-smartphone-line" id="app-icon" style="font-size: 32px; color: #cbd5e1; margin-bottom: 12px;"></i>
                                            <span style="font-size:13px; font-weight:600; color:#475569;" id="app-upload-label">App Image</span>
                                        </div>
                                        <div class="upload-meta">
                                            <span>JPG, PNG</span>
                                            <span>320x420 px</span>
                                        </div>
                                        <input type="file" id="app-upload-input" hidden accept="image/png, image/jpeg">
                                    </div>
                                </div>
                            </div>

                            <!-- Description -->
                            <div class="input-group-clean">
                                <label class="input-label">Description (Optional) <span>0/100</span></label>
                                <input type="text" id="ad-desc-input" class="clean-input" placeholder="Add a description...">
                            </div>

                            <!-- URL -->
                            <div class="input-group-clean" style="margin-bottom: 0;">
                                <label class="input-label">Destination URL <span>0/500</span></label>
                                <input type="text" id="ad-url-input" class="clean-input" placeholder="https://example.com/landing-page">
                            </div>
                        </div>

                        <!-- RIGHT: Preview Canvas -->
                        <div class="modal-right-panel">
                            <span class="preview-label">Live Preview</span>
                            <div class="device-mockup">
                                <div class="mockup-header">
                                    <i class="ri-arrow-left-line"></i> <span>Search Results</span> <i class="ri-more-fill" style="margin-left: auto;"></i>
                                </div>
                                <div class="mockup-body">
                                    <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                                        <div style="flex:1; height: 120px; background: #f1f5f9; border-radius: 8px;"></div>
                                        <div style="flex:1; height: 120px; background: #f1f5f9; border-radius: 8px;"></div>
                                    </div>
                                    <!-- THE PREVIEW IMAGE -->
                                    <div style="border: 1px solid #e2e8f0; border-radius: 8px; overflow: hidden; position: relative; min-height: 200px; background: #f8fafc; display:flex; align-items:center; justify-content:center;">
                                        <img id="live-preview-img" src="https://via.placeholder.com/400x500.png?text=Ad+Preview" style="width: 100%; display: block; opacity: 0.5;">
                                        <div style="position: absolute; top: 6px; right: 6px; background: rgba(0,0,0,0.4); color: #fff; padding: 2px 4px; font-size: 8px; border-radius: 2px;">Ad</div>
                                    </div>
                                    <div style="margin-top: 16px; height: 12px; width: 60%; background: #f1f5f9; border-radius: 4px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="modal-footer">
                        <button class="cc-button close-btn" style="background-color: white; border: 1px solid #e2e8f0; color: #64748b; margin-right: 12px;">Cancel</button>
                        <button class="cc-button" id="save-ad-btn" style="background-color: var(--cc-primary-color); color: #fff; min-width: 140px;">Save Creative</button>
                    </div>
                </div> 
            
            </div> <!-- Closes STEP 3 -->
    
            <!-- STEP 4 CONTENT -->
            <div class="step-content" id="step-4-content">
                <div style="margin-bottom: 24px;"><h2>Campaign Configuration & Launch</h2><p style="color: var(--cc-text-light); margin-top: 8px;">Set your schedule and budget to finalize the campaign.</p></div>
                <div class="config-workspace">
                    <div class="config-main">
                        <!-- Campaign Name Card -->
                        <div class="config-card" style="margin-bottom: 24px;">
                            <h4><i class="fa-solid fa-pen"></i> Campaign Details</h4>
                            <div class="form-group">
                                <label for="campaign-name">Campaign Name <span style="color: #dc2626;">*</span></label>
                                <input type="text" id="campaign-name" class="form-input" placeholder="e.g., Summer Sale 2026 - Homepage" maxlength="100">
                                <p class="helper-text">Give your campaign a descriptive name (required)</p>
                                <div id="campaign-name-error" class="hidden" style="color: #dc2626; font-size: 12px; margin-top: 6px; display: flex; align-items: center; gap: 6px;">
                                    <i class="fa-solid fa-circle-exclamation"></i>
                                    <span>Campaign name is required</span>
                                </div>
                            </div>
                        </div>
                        <div class="config-card" style="margin-bottom: 24px;">
                            <h4><i class="fa-solid fa-calendar-days"></i> Schedule</h4>
                            <div class="date-inputs">
                                <div class="form-group"><label for="start-date">Start Date</label><div class="date-input-wrapper"><input type="text" id="start-date" class="form-input" value="" readonly><i class="fa-solid fa-calendar calendar-icon"></i><div class="calendar-popup" id="start-date-calendar"></div></div></div>
                                <div class="form-group"><label for="end-date">End Date</label><div class="date-input-wrapper"><input type="text" id="end-date" class="form-input" value="" readonly><i class="fa-solid fa-calendar calendar-icon"></i><div class="calendar-popup" id="end-date-calendar"></div></div></div>
                            </div>
                        </div>
                        <div class="config-card">
                            <h4><i class="fa-solid fa-hand-holding-dollar"></i> Bidding & Budget</h4>
                            <div class="form-group"><label for="cpm-bid">Enter CPM Bid</label><input type="number" id="cpm-bid" class="form-input" placeholder="10.00"><p class="helper-text">Recommended: 100</p></div>
                            <!-- NEW: Budget & Frequency Inputs -->
                            <div class="budget-inputs" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 24px;">
                                <div class="form-group">
                                    <label for="daily-budget">Daily Budget</label>
                                    <input type="number" id="daily-budget" class="form-input" placeholder="e.g., 5000">
                                    <p class="helper-text">Min: 500</p>
                                </div>
                                <div class="form-group">
                                    <label for="frequency">Frequency</label>
                                    <input type="number" id="frequency" class="form-input" placeholder="e.g., 3">
                                    <p class="helper-text">Max: 5 per user</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="summary-panel config-card">
                            <h4><i class="fa-solid fa-chart-simple"></i> Campaign Summary</h4>
                        <div class="summary-item"><div class="label">Impressions Available</div><div class="value">-</div></div>
                        <div class="summary-item"><div class="label">Delivery Confidence</div><div class="desc"><i class="fa-solid fa-hourglass-half"></i>Available after 1 day</div></div>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="cc-footer">
            <button class="cc-button" id="back-btn" style="background-color: #e9e9e9; color: #333; display: none;">Back</button>
            <button class="cc-button" id="next-btn" style="background-color: var(--cc-primary-color); color: #fff;">Next</button>
        </footer>
    </div>
</div>

<!-- BLOCK 1: THE SELECTION SCREEN -->
        <div id="page-create-performance" class="page-section hidden">
            <div class="perf-creator-wrapper">
                <div class="perf-creator-header">Create Campaign</div>
                <div class="perf-creator-body" style="align-items: flex-start;">
                    <h3 style="font-weight: 600; font-size: 16px; color: #334155; margin-bottom: 24px;">Select your campaign type</h3>
                    <div class="type-selection-container">
                        <div id="select-smart-shopping" class="type-card" onclick="selectPerfType('smart-shopping')">
                            <div class="radio-check"><i class="fa-solid fa-check tick"></i></div>
                            <div class="type-card-img"><img src="https://i.ibb.co/VvZ3h3j/smart-shopping.png" alt="Smart Shopping"></div>
                            <h4>Smart Shopping Campaigns</h4>
                            <p>Let AI handle page selection, bids, and keyword targeting for your ad.</p>
                        </div>
                        <div id="select-search-only" class="type-card" onclick="selectPerfType('search-only')">
                            <div class="radio-check"><i class="fa-solid fa-check tick"></i></div>
                            <div class="type-card-img"><img src="https://i.ibb.co/L9d2v9p/search-only.png" alt="Search Only"></div>
                            <h4>Search Only Campaigns</h4>
                            <p>Target high intent customers with sharp keyword targeting.</p>
                        </div>
                    </div>
                </div>
                <!-- Footer (Button aligned to the right) -->
                <div class="perf-creator-footer" style="display: flex; justify-content: flex-end; align-items: center; width: 100%; padding: 20px 32px; border-top: 1px solid #f1f5f9; background: #fff;">
    <button class="cc-button" onclick="goToPerfCreationPage()" style="background-color: #9c00ad; color: #fff; min-width: 140px; font-weight: 600;">Next</button>
</div>
            </div>
        </div>

<!-- PAGE: SMART SHOPPING WIZARD (Fixed Arrows & Embedded Modal) -->
<div id="page-create-smart-shopping" class="page-section hidden wizard-wrapper">
    <div class="cc-module-container">
        
        <!-- Header -->
        <header class="cc-header">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 16px; padding-bottom:12px; border-bottom:1px solid #f1f5f9;">
                <h2 style="font-size:18px; font-weight:700; color:#111827; margin:0;">Create Smart Shopping Campaign</h2>
                <button onclick="navigateTo('performance', 'nav-camp')" style="color:#9ca3af; font-size:24px;"><i class="ri-close-line"></i></button>
            </div>
            <div class="cc-stepper" id="ss-stepper">
                <div class="cc-step active" data-step="1"><i class="ri-file-list-3-line step-icon"></i>&nbsp; Basic Info</div>
                <div class="cc-step" data-step="2"><i class="ri-shopping-bag-3-line step-icon"></i>&nbsp; Product Selection</div>
                <div class="cc-step" data-step="3"><i class="ri-funds-line step-icon"></i>&nbsp; Bidding</div>
                <div class="cc-step" data-step="4"><i class="ri-checkbox-circle-line step-icon"></i>&nbsp; Review</div>
            </div>
        </header>
    
        <main class="cc-steps-container">
            <!-- STEP 1: BASICS -->
            <div class="step-content active" id="ss-step-1" style="display: block;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 1: Basic Info</div>
                        <div class="wiz-toc-item active"><i class="ri-settings-3-line wiz-toc-icon"></i> Campaign Details</div>
                        <div class="wiz-toc-item"><i class="ri-wallet-3-line wiz-toc-icon"></i> Budget & Pacing</div>
                        <div class="wiz-toc-item"><i class="ri-calendar-line wiz-toc-icon"></i> Schedule</div>
                    </div>
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Campaign Details</h4>
                            <div class="ss-input-grid">
                                <div class="input-group-clean"><label class="input-label">Campaign Name <span class="text-red-500">*</span></label><input type="text" class="clean-input" placeholder="e.g., Summer Sale 2026"></div>
                                <div class="input-group-clean"><label class="input-label">Objective</label><select class="clean-input" style="background:#fff;"><option>Sales</option><option>Traffic</option></select></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Budget & Pacing</h4>
                            <div class="ss-input-grid">
                                <div class="input-group-clean"><label class="input-label">Daily Budget () <span class="text-red-500">*</span></label><input type="number" class="clean-input" placeholder="5000"></div>
                                <div class="input-group-clean"><label class="input-label">Pacing</label><select class="clean-input" style="background:#fff;"><option>Standard</option><option>Accelerated</option></select></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Schedule</h4>
                            <div class="ss-input-grid">
                                <div class="input-group-clean"><label class="input-label">Start Date</label><div style="position:relative;"><input type="text" class="clean-input" value="13 Jan 2026"><i class="ri-calendar-line" style="position:absolute; right:0; top:12px; color:#94a3b8;"></i></div></div>
                                <div class="input-group-clean"><label class="input-label">End Date</label><div style="position:relative;"><input type="text" class="clean-input" placeholder="Select Date"><i class="ri-calendar-line" style="position:absolute; right:0; top:12px; color:#94a3b8;"></i></div></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    
            <!-- STEP 2: PRODUCTS -->
            <div class="step-content" id="ss-step-2" style="display: none;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 2: Product Selection</div>
                        <div class="wiz-toc-item active"><i class="ri-filter-3-line wiz-toc-icon"></i> Selection Method</div>
                        <div class="wiz-toc-item"><i class="ri-list-check wiz-toc-icon"></i> Selected Items</div>
                    </div>
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Selection Method</h4>
                            <div class="input-group-clean">
                                <label class="input-label">How do you want to choose products?</label>
                                <div style="position:relative;">
                                    <select onchange="toggleProductView(this.value, 'ss-view-filters', 'ss-view-individual', 'ss-action-label')" class="clean-input" style="background:#fff; font-weight:600; cursor:pointer; -webkit-appearance: none; appearance: none;">
                                        <option value="filters" selected>Select Products using Filters</option>
                                        <option value="include">Select Individual Product to Include</option>
                                        <option value="exclude">Select Individual Product to Exclude</option>
                                    </select>
                                    <i class="ri-arrow-down-s-line" style="position:absolute; right:0; top:16px; pointer-events:none;"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Filter View -->
                        <div id="ss-view-filters" class="wiz-section-card animate-fade-in" style="display: block;">
    <h4 class="wiz-card-title">Filters</h4>
    <div class="grid grid-cols-12 gap-3 mb-2" style="font-size:11px; font-weight:700; color:#94a3b8; text-transform:uppercase;">
        <div class="col-span-3">Field</div><div class="col-span-3">Operator</div><div class="col-span-5">Value</div>
    </div>

    <div id="ss-filter-container">
        <div class="grid grid-cols-12 gap-3 items-center mb-3">
            <div class="col-span-3 relative"><select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none;"><option>Product Name</option></select><i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none"></i></div>
            <div class="col-span-3 relative"><select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none;"><option>contains</option></select><i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none"></i></div>
            <div class="col-span-5"><input type="text" class="clean-input" placeholder="e.g. Shampoo"></div>
            <div class="col-span-1"><button onclick="addFilterRowGeneric('ss-filter-container')" class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center hover:bg-primary-dark transition"><i class="ri-add-line"></i></button></div>
        </div>
    </div>

    <button onclick="addFilterRowGeneric('ss-filter-container')" class="text-xs font-bold text-primary hover:underline mt-2">+ Add another condition</button>
</div>

                        <!-- Individual View -->
                        <div id="ss-view-individual" class="wiz-section-card animate-fade-in" style="display: none;">
                            <h4 class="wiz-card-title">Manual Selection</h4>
                            <p id="ss-action-label" class="text-sm text-slate-500 mb-4">Select products to INCLUDE in this campaign</p>
                            
                            <div class="flex gap-4 mb-6">
                                <button onclick="document.getElementById('ss-product-modal').classList.remove('hidden')" class="flex items-center gap-2 bg-[#9c00ad] text-white px-5 py-2.5 rounded-lg text-sm font-bold shadow-md hover:bg-[#7e008c] transition">
                                    <i class="ri-add-line text-lg"></i> Choose Individually
                                </button>
                                <button class="flex items-center gap-2 bg-[#9c00ad] text-white px-5 py-2.5 rounded-lg text-sm font-bold shadow-md hover:bg-[#7e008c] transition">
                                    <i class="ri-upload-cloud-2-line text-lg"></i> Upload Bulk Products
                                </button>
                            </div>

                            <div id="ss-selected-list" style="display:none; border:1px solid #e2e8f0; border-radius:8px; overflow:hidden;">
                                <div style="background:#f1f5f9; padding:12px 16px; display:flex; justify-content:space-between; align-items:center;">
                                    <h4 class="font-bold text-gray-800 text-sm m-0" style="border:none; padding:0; margin:0;">Selected (<span id="ss-selected-count">0</span>)</h4>
                                    <button onclick="document.getElementById('ss-selected-tbody').innerHTML=''; document.getElementById('ss-selected-list').style.display='none';" class="text-xs font-bold text-red-500 bg-red-50 border border-red-100 px-3 py-1 rounded hover:bg-red-100 transition">Clear All</button>
                                </div>
                                <table class="w-full text-left"><tbody id="ss-selected-tbody"></tbody></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 3: BIDDING -->
            <div class="step-content" id="ss-step-3" style="display: none;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 3: Bidding</div>
                        <div class="wiz-toc-item active"><i class="ri-funds-line wiz-toc-icon"></i> Bidding Type</div>
                        <div class="wiz-toc-item"><i class="ri-target-line wiz-toc-icon"></i> ROAS Target</div>
                    </div>
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Bidding Strategy</h4>
                            <div class="grid grid-cols-2 gap-6">
                                <div class="border border-gray-200 bg-white rounded-lg p-5 cursor-default opacity-60">
                                    <div class="flex items-center gap-2 mb-2"><div class="w-3 h-3 rounded-full bg-gray-300"></div><h5 class="font-bold text-gray-900">Manual Bidding</h5></div>
                                    <p class="text-xs text-gray-600 mb-4">You take control of your Ads by placing bids on a Cost per Click basis.</p>
                                    <button class="px-3 py-1 bg-white border border-gray-300 text-gray-500 text-[10px] font-bold rounded" disabled>Choose</button>
                                </div>
                                <div class="border-2 border-primary bg-purple-50 rounded-lg p-5 relative shadow-sm">
                                    <div class="flex items-center gap-2 mb-2"><div class="w-3 h-3 rounded-full bg-primary"></div><h5 class="font-bold text-gray-900">Smart Bidding (ROAS)</h5></div>
                                    <p class="text-xs text-gray-600 mb-4">Optimizes bids for maximum performance based on your ROAS target.</p>
                                    <button class="px-3 py-1 bg-primary text-white text-[10px] font-bold rounded shadow-sm">Selected</button>
                                </div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Set Targets</h4>
                            <label class="input-label">Target ROAS (Return on Ad Spend)</label>
                            <div class="flex items-center gap-3 mb-4">
                                <input type="number" class="clean-input" value="4" style="width: 80px; font-weight: 700; font-size: 18px;">
                                <span class="font-bold text-lg text-gray-500">: 1</span>
                            </div>
                            <div class="bg-blue-50 border border-blue-100 rounded-lg p-3 flex items-center gap-3 text-blue-700 text-xs">
                                <i class="ri-information-fill text-lg"></i> Limited spend expected with high ROAS target.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 4: REVIEW -->
            <div class="step-content" id="ss-step-4" style="display: none;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 4: Review</div>
                        <div class="wiz-toc-item active"><i class="ri-file-list-line wiz-toc-icon"></i> Overview</div>
                    </div>
                    
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #f1f5f9; padding-bottom:12px; margin-bottom:20px;">
                                <h4 class="wiz-card-title" style="border:none; padding:0; margin:0;">Basic Information</h4>
                                <span style="background:#fffbeb; color:#92400e; border:1px solid #fcd34d; padding:4px 10px; border-radius:4px; font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;">
                                    <i class="ri-edit-circle-line" style="vertical-align:middle; margin-right:4px;"></i> Draft Mode
                                </span>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-6">
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Campaign Name</div><div class="font-bold text-gray-900">Summer Sale 2026</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Type</div><div class="font-bold text-primary">SMART SHOPPING</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Start Date</div><div class="font-medium text-gray-700">13 Jan 2026</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Ad Format</div><div class="font-medium text-gray-700">Product Listing</div></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Budget & Strategy</h4>
                            <div class="grid grid-cols-2 gap-6">
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Daily Budget</div><div class="font-bold text-lg text-gray-900"> 5,000</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Strategy</div><div class="font-bold text-gray-900">Target ROAS (4:1)</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Duration</div><div class="font-medium text-gray-700">30 Days</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Est. Spend</div><div class="font-medium text-gray-700"> 1,50,000</div></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Targeting</h4>
                            <div>24 Products Selected (Manual Selection)</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- FOOTER -->
        <footer class="cc-footer" style="padding: 20px 32px; border-top: 1px solid #e5e7eb; display:flex; justify-content:space-between; background:#fff;">
            <button class="cc-button" id="ss-back-btn" onclick="ssWizardNav(-1)" style="background-color: #fff; border:1px solid #cbd5e1; color:#334155; display:none;">Back</button>
            <button class="cc-button" id="ss-next-btn" onclick="ssWizardNav(1)" style="background-color: var(--cc-primary-color); color: #fff; margin-left:auto;">Next</button>
        </footer>
    </div>

    <!-- EMBEDDED MODAL FOR SMART SHOPPING -->
    <div id="ss-product-modal" class="fixed inset-0 bg-black/60 z-[9999] hidden flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl w-[900px] max-w-[95%] h-[80vh] flex flex-col transform transition-all scale-100">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-xl">
                <h3 class="font-bold text-lg text-gray-900">Select Products (Smart Shopping)</h3>
                <button onclick="document.getElementById('ss-product-modal').classList.add('hidden')" class="text-gray-400 hover:text-gray-700"><i class="ri-close-line text-2xl"></i></button>
            </div>
            <div class="flex-1 overflow-y-auto p-0">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-white sticky top-0 z-10 shadow-sm text-[10px] text-gray-500 uppercase font-bold"><tr><th class="p-4 w-10"></th><th class="p-4">Image</th><th class="p-4">Name</th><th class="p-4">Category</th><th class="p-4">Price</th></tr></thead>
                    <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                        <tr class="hover:bg-purple-50 cursor-pointer" onclick="addSSRow(this)"><td class="p-4"><input type="checkbox" class="accent-primary pointer-events-none"></td><td class="p-4"><img src="https://images.unsplash.com/photo-1620916566398-39f1143ab7be?auto=format&fit=crop&q=80&w=100" class="w-8 h-8 rounded object-cover bg-gray-100"></td><td class="p-4 font-medium">Alps Goodness Tea Tree Night Cream</td><td class="p-4 text-gray-500">Night Cream</td><td class="p-4 font-bold text-gray-900">249</td></tr>
                        <tr class="hover:bg-purple-50 cursor-pointer" onclick="addSSRow(this)"><td class="p-4"><input type="checkbox" class="accent-primary pointer-events-none"></td><td class="p-4"><img src="https://images.unsplash.com/photo-1608248597279-f99d160bfbc8?auto=format&fit=crop&q=80&w=100" class="w-8 h-8 rounded object-cover bg-gray-100"></td><td class="p-4 font-medium">Alps Goodness Avocado Cream</td><td class="p-4 text-gray-500">Face Cream</td><td class="p-4 font-bold text-gray-900">261</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="px-6 py-4 border-t border-gray-100 flex justify-end items-center bg-gray-50 rounded-b-xl gap-4">
                <button onclick="document.getElementById('ss-product-modal').classList.add('hidden')" class="text-sm font-bold text-gray-500 hover:text-gray-800">Cancel</button>
                <button onclick="finishSSSelection()" class="bg-primary text-white px-6 py-2.5 rounded-lg text-sm font-bold shadow-lg hover:bg-primary-dark transition">Add Selected</button>
            </div>
        </div>
    </div>
    <script>
        function addSSRow(r) { const c=r.querySelector('input'); c.checked=!c.checked; r.style.backgroundColor=c.checked?'#fdf1ff':'white'; }
        function finishSSSelection() {
            const tr=document.createElement('tr'); tr.className="hover:bg-gray-50 border-b border-gray-100";
            tr.innerHTML=`<td class="p-3"><img src="https://images.unsplash.com/photo-1620916566398-39f1143ab7be?auto=format&fit=crop&q=80&w=100" class="w-8 h-8 rounded"></td><td class="p-3 font-medium">Alps Goodness Tea Tree Night Cream</td><td class="p-3">Night Cream</td><td class="p-3">Alps Goodness</td><td class="p-3 line-through text-gray-400">335</td><td class="p-3 font-bold">249</td><td class="p-3 text-green-600 font-bold">In Stock</td><td class="p-3 text-center"><i class="ri-delete-bin-line text-gray-400 cursor-pointer" onclick="this.closest('tr').remove();"></i></td>`;
            // FIX: Changed 'ss-tbody' to 'ss-selected-tbody'
            const target = document.getElementById('ss-selected-tbody');
            if(target) target.appendChild(tr); 
            document.getElementById('ss-selected-list').style.display='block'; 
            document.getElementById('ss-selected-count').innerText='1'; 
            document.getElementById('ss-product-modal').classList.add('hidden');
        }
    </script>
</div>

<!-- PAGE: SEARCH ONLY WIZARD (Fixed Arrows & Embedded Modal) -->
<div id="page-create-search-only" class="page-section hidden wizard-wrapper">
    <div class="cc-module-container">
        
        <!-- Header -->
        <header class="cc-header">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 16px; padding-bottom:12px; border-bottom:1px solid #f1f5f9;">
                <h2 style="font-size:18px; font-weight:700; color:#111827; margin:0;">Create Search Only Campaign</h2>
                <button onclick="navigateTo('performance', 'nav-camp')" style="color:#9ca3af; font-size:24px;"><i class="ri-close-line"></i></button>
            </div>
            <div class="cc-stepper" id="so-stepper">
                <div class="cc-step active" data-step="1"><i class="ri-file-list-3-line step-icon"></i>&nbsp; Basic Info</div>
                <div class="cc-step" data-step="2"><i class="ri-shopping-bag-3-line step-icon"></i>&nbsp; Product Selection</div>
                <div class="cc-step" data-step="3"><i class="ri-price-tag-3-line step-icon"></i>&nbsp; Keywords</div>
                <div class="cc-step" data-step="4"><i class="ri-checkbox-circle-line step-icon"></i>&nbsp; Review</div>
            </div>
        </header>
    
        <main class="cc-steps-container">
            <!-- STEP 1: BASICS -->
            <div class="step-content active" id="so-step-1" style="display: block;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 1: Basic Info</div>
                        <div class="wiz-toc-item active"><i class="ri-settings-3-line wiz-toc-icon"></i> Campaign Details</div>
                        <div class="wiz-toc-item"><i class="ri-wallet-3-line wiz-toc-icon"></i> Budget & Pacing</div>
                        <div class="wiz-toc-item"><i class="ri-calendar-line wiz-toc-icon"></i> Schedule</div>
                    </div>
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Campaign Details</h4>
                            <div class="ss-input-grid">
                                <div class="input-group-clean"><label class="input-label">Campaign Name <span class="text-red-500">*</span></label><input type="text" class="clean-input" placeholder="e.g., Brand Keywords 2026"></div>
                                <div class="input-group-clean"><label class="input-label">Objective</label><select class="clean-input" style="background:#fff;"><option>Sales</option><option>Awareness</option></select></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Budget & Pacing</h4>
                            <div class="ss-input-grid">
                                <div class="input-group-clean"><label class="input-label">Daily Budget () <span class="text-red-500">*</span></label><input type="number" class="clean-input" placeholder="5000"></div>
                                <div class="input-group-clean"><label class="input-label">Pacing</label><select class="clean-input" style="background:#fff;"><option>Standard</option><option>Accelerated</option></select></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Schedule</h4>
                            <div class="ss-input-grid">
                                <div class="input-group-clean"><label class="input-label">Start Date</label><div style="position:relative;"><input type="text" class="clean-input" value="13 Jan 2026"><i class="ri-calendar-line" style="position:absolute; right:0; top:12px; color:#94a3b8;"></i></div></div>
                                <div class="input-group-clean"><label class="input-label">End Date</label><div style="position:relative;"><input type="text" class="clean-input" placeholder="Select Date"><i class="ri-calendar-line" style="position:absolute; right:0; top:12px; color:#94a3b8;"></i></div></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 2: PRODUCTS -->
            <div class="step-content" id="so-step-2" style="display: none;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 2: Product Selection</div>
                        <div class="wiz-toc-item active"><i class="ri-filter-3-line wiz-toc-icon"></i> Selection Method</div>
                        <div class="wiz-toc-item"><i class="ri-list-check wiz-toc-icon"></i> Selected Items</div>
                    </div>
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Selection Method</h4>
                            <div class="input-group-clean">
                                <label class="input-label">How do you want to choose products?</label>
                                <div style="position:relative;">
                                    <select onchange="toggleProductView(this.value, 'so-view-filters', 'so-view-individual', 'so-action-label')" class="clean-input" style="background:#fff; font-weight:600; cursor:pointer; -webkit-appearance: none; appearance: none;">
                                        <option value="filters" selected>Select Products using Filters</option>
                                        <option value="include">Select Individual Product to Include</option>
                                        <option value="exclude">Select Individual Product to Exclude</option>
                                    </select>
                                    <i class="ri-arrow-down-s-line" style="position:absolute; right:0; top:16px; pointer-events:none;"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Filter View -->
                        <div id="so-view-filters" class="wiz-section-card animate-fade-in" style="display: block;">
                            <h4 class="wiz-card-title">Filters</h4>
                            <div class="grid grid-cols-12 gap-3 mb-2" style="font-size:11px; font-weight:700; color:#94a3b8; text-transform:uppercase;">
                                <div class="col-span-3">Field</div><div class="col-span-3">Operator</div><div class="col-span-5">Value</div>
                            </div>

                            <div id="so-filter-container">
                                <div class="grid grid-cols-12 gap-3 items-center mb-3">
                                    <div class="col-span-3 relative"><select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none;"><option>Product Name</option></select><i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none"></i></div>
                                    <div class="col-span-3 relative"><select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none;"><option>contains</option></select><i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none"></i></div>
                                    <div class="col-span-5"><input type="text" class="clean-input" placeholder="e.g. Shampoo"></div>
                                    <div class="col-span-1"><button onclick="addFilterRowGeneric('so-filter-container')" class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center hover:bg-primary-dark transition"><i class="ri-add-line"></i></button></div>
                                </div>
                            </div>

                            <button onclick="addFilterRowGeneric('so-filter-container')" class="text-xs font-bold text-primary hover:underline mt-2">+ Add another condition</button>
                        </div>

                        <!-- Individual View -->
                        <div id="so-view-individual" class="wiz-section-card hidden animate-fade-in" style="display: none;">
                            <h4 class="wiz-card-title">Manual Selection</h4>
                            <p id="so-action-label" class="text-sm text-slate-500 mb-4">Select products to INCLUDE in this campaign</p>
                            <div class="flex gap-4 mb-6">
                                <button onclick="document.getElementById('so-product-modal').classList.remove('hidden')" class="flex items-center gap-2 bg-[#9c00ad] text-white px-5 py-2.5 rounded-lg text-sm font-bold shadow-md hover:bg-[#7e008c] transition"><i class="ri-add-line"></i> Choose Individually</button>
                                <button class="flex items-center gap-2 bg-[#9c00ad] text-white px-5 py-2.5 rounded-lg text-sm font-bold shadow-md hover:bg-[#7e008c] transition"><i class="ri-upload-cloud-2-line"></i> Upload Bulk Products</button>
                            </div>
                            <div id="so-selected-list" style="display:none; border:1px solid #e2e8f0; border-radius:8px; overflow:hidden;">
                                <div style="background:#f8fafc; padding:12px 16px; display:flex; justify-content:space-between; align-items:center;">
                                    <h4 class="font-bold text-gray-800 text-sm m-0" style="border:none;">Selected (<span id="so-selected-count">0</span>)</h4>
                                    <button onclick="document.getElementById('so-tbody').innerHTML=''; document.getElementById('so-selected-list').style.display='none';" class="text-xs font-bold text-red-500 bg-red-50 border border-red-100 px-3 py-1 rounded hover:bg-red-100 transition">Clear All</button>
                                </div>
                                <table class="w-full text-left"><tbody id="so-selected-tbody"></tbody></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 3: KEYWORDS -->
            <div class="step-content" id="so-step-3" style="display: none;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 3: Bidding</div>
                        <div class="wiz-toc-item active"><i class="ri-price-tag-3-line wiz-toc-icon"></i> Individual Keywords</div>
                        <div class="wiz-toc-item"><i class="ri-upload-2-line wiz-toc-icon"></i> Bulk Upload</div>
                    </div>
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
                                <h4 class="wiz-card-title" style="margin:0; border:none;">Individual Keywords</h4>
                                <button onclick="addBiddingRow()" class="text-xs font-bold text-primary hover:underline">+ Add Keyword Row</button>
                            </div>
                            <div class="grid grid-cols-12 gap-3 mb-2 px-1 text-[10px] font-bold text-gray-400 uppercase">
                                <div class="col-span-6">Keyword</div><div class="col-span-3">Match Type</div><div class="col-span-2">Bid ()</div>
                            </div>
                            <div id="bidding-rows-container" class="space-y-3"></div>
                        </div>
                        <div class="wiz-section-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
                                <h4 class="wiz-card-title" style="margin:0; border:none;">Bulk Upload</h4>
                                <button class="bg-[#9c00ad] text-white px-4 py-2 rounded text-xs font-bold shadow-sm flex items-center gap-2 hover:bg-[#7e008c] transition"><i class="ri-upload-cloud-2-line"></i> Upload CSV</button>
                            </div>
                            <textarea class="clean-input" style="min-height:100px; padding:16px;" placeholder="Paste keywords here (one per line)..."></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 4: REVIEW -->
            <div class="step-content" id="so-step-4" style="display: none;">
                <div class="wizard-body-split">
                    <div class="wizard-sidebar">
                        <div class="wiz-toc-header">Step 4: Review</div>
                        <div class="wiz-toc-item active"><i class="ri-file-list-line wiz-toc-icon"></i> Overview</div>
                    </div>
                    
                    <div class="wizard-content-area">
                        <div class="wiz-section-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #f1f5f9; padding-bottom:12px; margin-bottom:20px;">
                                <h4 class="wiz-card-title" style="border:none; padding:0; margin:0;">Basic Information</h4>
                                <span style="background:#fffbeb; color:#92400e; border:1px solid #fcd34d; padding:4px 10px; border-radius:4px; font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;">
                                    <i class="ri-edit-circle-line" style="vertical-align:middle; margin-right:4px;"></i> Draft Mode
                                </span>
                            </div>

                            <div class="grid grid-cols-2 gap-6">
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Campaign Name</div><div class="font-bold text-gray-900">Brand Keywords 2026</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Type</div><div class="font-bold text-primary">SEARCH ONLY</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Start Date</div><div class="font-medium text-gray-700">06 Jan 2026</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Ad Format</div><div class="font-medium text-gray-700">Text / Search</div></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Budget & Strategy</h4>
                            <div class="grid grid-cols-2 gap-6">
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Daily Budget</div><div class="font-bold text-lg text-gray-900"> 5,000</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Strategy</div><div class="font-bold text-gray-900">Manual CPC</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Duration</div><div class="font-medium text-gray-700">30 Days</div></div>
                                <div><div class="text-[10px] text-gray-400 font-bold uppercase mb-1">Est. Spend</div><div class="font-medium text-gray-700"> 1,50,000</div></div>
                            </div>
                        </div>
                        <div class="wiz-section-card">
                            <h4 class="wiz-card-title">Keywords</h4>
                            <div>5 Keywords Configured</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- FOOTER -->
        <footer class="cc-footer" style="padding: 20px 32px; border-top: 1px solid #e5e7eb; display:flex; justify-content:space-between; background:#fff;">
            <button class="cc-button" id="so-back-btn" onclick="soWizardNav(-1)" style="background-color: #fff; border:1px solid #cbd5e1; color:#334155; display:none;">Back</button>
            <button class="cc-button" id="so-next-btn" onclick="soWizardNav(1)" style="background-color: var(--cc-primary-color); color: #fff; margin-left:auto;">Next</button>
        </footer>
    </div>
    
    <!-- EMBEDDED MODAL FOR SEARCH ONLY -->
    <div id="so-product-modal" class="fixed inset-0 bg-black/60 z-[9999] hidden flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl w-[900px] max-w-[95%] h-[80vh] flex flex-col transform transition-all scale-100">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-xl">
                <h3 class="font-bold text-lg text-gray-900">Select Products (Search Only)</h3>
                <button onclick="document.getElementById('so-product-modal').classList.add('hidden')" class="text-gray-400 hover:text-gray-700"><i class="ri-close-line text-2xl"></i></button>
            </div>
            <div class="flex-1 overflow-y-auto p-0">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-white sticky top-0 z-10 shadow-sm text-[10px] text-gray-500 uppercase font-bold"><tr><th class="p-4 w-10"></th><th class="p-4">Image</th><th class="p-4">Name</th><th class="p-4">Category</th><th class="p-4">Price</th></tr></thead>
                    <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                        <tr class="hover:bg-purple-50 cursor-pointer" onclick="addSORow(this)"><td class="p-4"><input type="checkbox" class="accent-primary pointer-events-none"></td><td class="p-4"><img src="https://images.unsplash.com/photo-1620916566398-39f1143ab7be?auto=format&fit=crop&q=80&w=100" class="w-8 h-8 rounded object-cover bg-gray-100"></td><td class="p-4 font-medium">Alps Goodness Tea Tree Night Cream</td><td class="p-4 text-gray-500">Night Cream</td><td class="p-4 font-bold text-gray-900">249</td></tr>
                        <tr class="hover:bg-purple-50 cursor-pointer" onclick="addSORow(this)"><td class="p-4"><input type="checkbox" class="accent-primary pointer-events-none"></td><td class="p-4"><img src="https://images.unsplash.com/photo-1608248597279-f99d160bfbc8?auto=format&fit=crop&q=80&w=100" class="w-8 h-8 rounded object-cover bg-gray-100"></td><td class="p-4 font-medium">Alps Goodness Avocado Cream</td><td class="p-4 text-gray-500">Face Cream</td><td class="p-4 font-bold text-gray-900">261</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="px-6 py-4 border-t border-gray-100 flex justify-end items-center bg-gray-50 rounded-b-xl gap-4">
                <button onclick="document.getElementById('so-product-modal').classList.add('hidden')" class="text-sm font-bold text-gray-500 hover:text-gray-800">Cancel</button>
                <button onclick="finishSOSelection()" class="bg-primary text-white px-6 py-2.5 rounded-lg text-sm font-bold shadow-lg hover:bg-primary-dark transition">Add Selected</button>
            </div>
        </div>
    </div>
    <script>
        function addSORow(r) { const c=r.querySelector('input'); c.checked=!c.checked; r.style.backgroundColor=c.checked?'#fdf1ff':'white'; }
        function finishSOSelection() {
            const tr=document.createElement('tr'); tr.className="hover:bg-gray-50 border-b border-gray-100";
            tr.innerHTML=`<td class="p-3"><img src="https://images.unsplash.com/photo-1620916566398-39f1143ab7be?auto=format&fit=crop&q=80&w=100" class="w-8 h-8 rounded"></td><td class="p-3 font-medium">Alps Goodness Tea Tree Night Cream</td><td class="p-3">Night Cream</td><td class="p-3">Alps Goodness</td><td class="p-3 line-through text-gray-400">335</td><td class="p-3 font-bold">249</td><td class="p-3 text-green-600 font-bold">In Stock</td><td class="p-3 text-center"><i class="ri-delete-bin-line text-gray-400 cursor-pointer" onclick="this.closest('tr').remove();"></i></td>`;
            // FIX: Changed 'so-tbody' to 'so-selected-tbody' and 'so-count' to 'so-selected-count'
            const target = document.getElementById('so-selected-tbody');
            if(target) target.appendChild(tr); 
            document.getElementById('so-selected-list').style.display='block'; 
            document.getElementById('so-selected-count').innerText='1'; 
            document.getElementById('so-product-modal').classList.add('hidden');
        }
    </script>
</div>

        <!-- TAKEOVER CAMPAIGN CREATOR (Auction-Based) -->
        <div id="page-create-takeover" class="page-section hidden wizard-wrapper">
            <div class="cc-module-container">
                <header class="cc-header">
                    <div class="cc-stepper" id="takeover-stepper">
                        <div class="cc-step active" data-step="1"><i class="fa-solid fa-calendar-days step-icon"></i>&nbsp; Step 1: Choose your day</div>
                        <div class="cc-step" data-step="2"><i class="fa-solid fa-layer-group step-icon"></i>&nbsp; Step 2: Review package</div>
                        <div class="cc-step" data-step="3"><i class="fa-solid fa-gavel step-icon"></i>&nbsp; Step 3: Place Bid</div>
                        <div class="cc-step" data-step="4"><i class="fa-solid fa-check-circle step-icon"></i>&nbsp; Step 4: Review & Submit</div>
                    </div>
                </header>

                <main class="cc-steps-container">
                    <!-- Step 1: Choose Day + Takeover Type -->
                    <div id="takeover-step-1" class="step-content active" style="padding: 40px;">
                        <div style="max-width: 1200px; margin: 0 auto;">
                            <h2 style="font-weight: 700; color: #111827; margin-bottom: 8px;">Choose your day (February 2026)</h2>
                            <div style="font-size: 13px; color: #64748b; margin-bottom: 18px; line-height: 1.6;">
                                Select a date and an eligible takeover type. Prices shown are fixed for the selected day.
                            </div>

                            <div style="display:flex; gap:16px; align-items:center; flex-wrap:wrap; margin-bottom:16px;">
                                <div style="display:flex; gap:8px; align-items:center;"><span style="width:10px; height:10px; border-radius:999px; background:#e5e7eb; display:inline-block;"></span><span style="font-size:12px; color:#64748b; font-weight:700;">BAU</span></div>
                                <div style="display:flex; gap:8px; align-items:center;"><span style="width:10px; height:10px; border-radius:999px; background:#fde68a; display:inline-block;"></span><span style="font-size:12px; color:#64748b; font-weight:700;">Weekend Sale</span></div>
                                <div style="display:flex; gap:8px; align-items:center;"><span style="width:10px; height:10px; border-radius:999px; background:#fca5a5; display:inline-block;"></span><span style="font-size:12px; color:#64748b;">IHB Sale (Feb 515)</span></div>
                            </div>

                            <div id="takeover-calendar" style="background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:16px;"></div>

                            <div id="takeover-day-summary" style="margin-top: 16px; padding: 14px 16px; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 12px; display:flex; align-items:center; justify-content:space-between; gap:12px;">
                                <div>
                                    <div style="font-weight:700; color:#111827;">Selection</div>
                                    <div id="takeover-day-summary-text" style="font-size:13px; color:#64748b; margin-top:2px;">No day selected</div>
                                </div>
                                <div id="takeover-day-summary-price" style="font-weight:800; color:#111827;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Review Takeover Package -->
                    <div id="takeover-step-2" class="step-content" style="padding: 40px;">
                        <div style="max-width: 1200px; margin: 0 auto;">
                            <h2 style="font-weight: 700; color: #111827; margin-bottom: 8px;">Review your takeover package</h2>
                            <div style="font-size: 13px; color: #64748b; margin-bottom: 18px; line-height: 1.6;">
                                All placements included in your takeover package are shown below. For L1 Category takeover, please select a category page.
                            </div>

                            <div class="inventory-workspace">
                                <!-- Pages -->
                                <section class="inventory-column">
                                    <div class="inventory-column-header">
                                        <h3><i class="fa-solid fa-layer-group"></i> Page</h3>
                                    </div>
                                    <div class="inventory-column-content" id="takeover-page-list" style="max-height: 450px; overflow-y: auto;"></div>
                                </section>

                                <!-- Placements -->
                                <section class="inventory-column">
                                    <div class="inventory-column-header">
                                        <h3><i class="fa-solid fa-rectangle-ad"></i> Included Placements</h3>
                                    </div>
                                    <div class="inventory-column-content" id="takeover-placement-list"></div>
                                </section>

                                <!-- Summary -->
                                <aside class="inventory-column inventory-summary">
                                    <div class="inventory-column-header" style="display:flex; align-items:center; justify-content:space-between;">
                                        <h3 style="display:flex; align-items:center; gap:8px; margin:0;"><i class="fa-solid fa-box-open"></i> Package Summary</h3>
                                        <span id="takeover-summary-count" class="count-badge">0</span>
                                    </div>
                                    <div class="inventory-column-content" id="takeover-summary"></div>
                                </aside>
                            </div>
                        </div>
                    </div>


                    <!-- Step 3: Place Bid -->
                    <div id="takeover-step-3" class="step-content" style="padding: 40px;">
                        <div style="max-width: 900px; margin: 0 auto;">
                            <h2 style="font-weight: 700; color: #111827; margin-bottom: 8px;">Place your bid</h2>
                            <div style="font-size: 13px; color: #64748b; margin-bottom: 24px; line-height: 1.6;">
                                Submit your bid for the selected takeover. The highest bidder wins the slot.
                            </div>

                            <!-- Takeover Summary Card -->
                            <div id="takeover-bid-summary" style="background: linear-gradient(135deg, #9c00ad 0%, #7c3aed 100%); color: white; padding: 24px; border-radius: 12px; margin-bottom: 24px;">
                                <!-- JS will populate this -->
                            </div>

                            <!-- Expected Performance & Bid Section -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                                
                                <!-- Left: Expected Performance -->
                                <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                                        <div style="width: 40px; height: 40px; background: #f0fdf4; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fa-solid fa-chart-line" style="color: #16a34a; font-size: 18px;"></i>
                                        </div>
                                        <div>
                                            <div style="font-weight: 700; color: #111827;">Expected Performance</div>
                                            <div style="font-size: 12px; color: #64748b;">Based on historical data</div>
                                        </div>
                                    </div>
                                    
                                    <div id="takeover-expected-impressions" style="background: #f9fafb; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                        <!-- JS will populate -->
                                    </div>

                                    <div style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #fef3c7; border-radius: 8px;">
                                        <i class="fa-solid fa-info-circle" style="color: #d97706;"></i>
                                        <span style="font-size: 12px; color: #92400e; font-weight: 500;">Minimum Bid: <strong id="takeover-min-bid-display">0L</strong></span>
                                    </div>
                                </div>

                                <!-- Right: Bid Input -->
                                <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                                        <div style="width: 40px; height: 40px; background: #fdf1ff; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                                            <i class="fa-solid fa-gavel" style="color: #9c00ad; font-size: 18px;"></i>
                                        </div>
                                        <div>
                                            <div style="font-weight: 700; color: #111827;">Your Bid</div>
                                            <div style="font-size: 12px; color: #64748b;">Enter your bid amount</div>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: 16px;">
                                        <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 8px;">Bid Amount (in Lakhs)</label>
                                        <div style="position: relative;">
                                            <span style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); font-size: 16px; font-weight: 700; color: #64748b;"></span>
                                            <input type="number" id="takeover-bid-input" placeholder="Enter bid amount" step="0.5" min="0" 
                                                style="width: 100%; padding: 14px 14px 14px 32px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 16px; font-weight: 600; color: #111827; outline: none; transition: all 0.2s;"
                                                onfocus="this.style.borderColor='#9c00ad'" onblur="this.style.borderColor='#e5e7eb'">
                                            <span style="position: absolute; right: 14px; top: 50%; transform: translateY(-50%); font-size: 14px; font-weight: 600; color: #64748b;">Lakhs</span>
                                        </div>
                                        <div id="takeover-bid-error" style="display: none; margin-top: 8px; padding: 10px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; color: #dc2626; font-size: 12px; font-weight: 600;">
                                            <i class="fa-solid fa-exclamation-circle" style="margin-right: 6px;"></i>
                                            <span id="takeover-bid-error-text">Bid must be at least the minimum amount</span>
                                        </div>
                                    </div>

                                    <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 12px; display: none;" id="takeover-bid-success">
                                        <div style="display: flex; align-items: center; gap: 8px; color: #16a34a; font-weight: 600; font-size: 13px;">
                                            <i class="fa-solid fa-circle-check"></i>
                                            <span>Valid bid amount</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Terms & Conditions -->
                            <div style="background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 24px; margin-top: 24px;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 16px;">
                                    <i class="fa-solid fa-file-contract" style="color: #64748b; font-size: 18px;"></i>
                                    <div style="font-weight: 700; color: #111827;">Terms & Conditions</div>
                                </div>
                                <div style="display: flex; flex-direction: column; gap: 12px;">
                                    <div style="display: flex; align-items: flex-start; gap: 10px; padding: 12px; background: #f9fafb; border-radius: 8px;">
                                        <i class="fa-solid fa-calendar-check" style="color: #9c00ad; margin-top: 2px;"></i>
                                        <div>
                                            <div style="font-weight: 600; color: #111827; font-size: 13px;">Bid Deadline</div>
                                            <div style="font-size: 12px; color: #64748b; margin-top: 2px;">All bids must be placed before the <strong>20th of each month</strong> for upcoming month's takeovers.</div>
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: flex-start; gap: 10px; padding: 12px; background: #f9fafb; border-radius: 8px;">
                                        <i class="fa-solid fa-crown" style="color: #f59e0b; margin-top: 2px;"></i>
                                        <div>
                                            <div style="font-weight: 600; color: #111827; font-size: 13px;">Full Homepage Priority</div>
                                            <div style="font-size: 12px; color: #64748b; margin-top: 2px;">Full Homepage takeovers are given preference. If a Full Homepage takeover bid is won, <strong>all Half Homepage takeover bids for that day are automatically rejected</strong>.</div>
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: flex-start; gap: 10px; padding: 12px; background: #f9fafb; border-radius: 8px;">
                                        <i class="fa-solid fa-image" style="color: #3b82f6; margin-top: 2px;"></i>
                                        <div>
                                            <div style="font-weight: 600; color: #111827; font-size: 13px;">Creative Approval Deadline</div>
                                            <div style="font-size: 12px; color: #64748b; margin-top: 2px;">All creatives must be uploaded and approved by the <strong>24th of each month</strong>.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Step 4: Review & Submit -->
                    <div id="takeover-step-4" class="step-content" style="padding: 40px;">
                        <div style="max-width: 1000px; margin: 0 auto;">
                            <h2 style="font-weight: 700; color: #111827; margin-bottom: 8px;">Review & Submit</h2>
                            <div style="font-size: 13px; color: #64748b; margin-bottom: 24px; line-height: 1.6;">
                                Please review your takeover booking details before submitting your bid.
                            </div>

                            <!-- Campaign Details Card -->
                            <div style="background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:24px; margin-bottom: 20px;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 16px;">
                                    <i class="fa-solid fa-pen" style="color: #9c00ad;"></i>
                                    <span style="font-weight: 700; color: #111827;">Campaign Details</span>
                                </div>
                                <div style="margin-bottom: 0;">
                                    <label style="display: block; font-size: 13px; font-weight: 600; color: #374151; margin-bottom: 8px;">
                                        Campaign Name <span style="color: #dc2626;">*</span>
                                    </label>
                                    <input type="text" id="takeover-campaign-name" placeholder="e.g., Feb 7 Full Homepage Takeover - Brand Launch" maxlength="100" style="width: 100%; padding: 12px 14px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; color: #111827; outline: none; transition: border-color 0.2s;">
                                    <div style="font-size: 11px; color: #9ca3af; margin-top: 6px;">Give your campaign a descriptive name (required)</div>
                                    <div id="takeover-campaign-name-error" class="hidden" style="color: #dc2626; font-size: 12px; margin-top: 6px; display: none; align-items: center; gap: 6px;">
                                        <i class="fa-solid fa-circle-exclamation"></i>
                                        <span>Campaign name is required</span>
                                    </div>
                                </div>
                            </div>

                            <div id="takeover-config-summary" style="background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:24px;"></div>
                        </div>
                    </div>
                </main>

                <footer class="cc-footer">
                    <button id="takeover-back-btn" class="cc-button" style="background: #fff; color: #374151; border: 1px solid #e5e7eb;">Back</button>
                    <button id="takeover-next-btn" class="cc-button" style="background-color: var(--cc-primary-color); color: #fff;">Next</button>
                </footer>
            </div>
        </div>

<!-- 3. TRANSACTION PAGE (10 Rows, Fixed 800px) -->
<div id="page-transactions" class="page-section hidden">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold text-gray-900">Transaction Log</h1>
        <div class="flex gap-3 items-center">
            <div class="relative dropdown-container">
                <button onclick="toggleId('filterPanel')" class="flex items-center gap-2 px-4 h-9 bg-white border border-gray-200 rounded-lg text-sm font-medium hover:bg-gray-50 shadow-sm transition"><i class="ri-add-line"></i> Add Filter</button>
                <div id="filterPanel" class="dropdown-enter absolute top-full right-0 mt-2 w-[500px] bg-white rounded-xl shadow-popup border border-gray-100 p-4 z-50">
                    <div class="flex gap-3 items-center">
                        <div class="w-1/3"><select class="w-full border border-gray-200 rounded px-3 py-2 text-sm focus:outline-none focus:border-primary bg-white"><option>Date</option><option>Amount</option><option>Status</option></select></div>
                        <div class="w-1/3"><select class="w-full border border-gray-200 rounded px-3 py-2 text-sm focus:outline-none focus:border-primary bg-white"><option>equals (=)</option></select></div>
                        <div class="w-1/3 relative"><input type="text" placeholder="Value" class="w-full border border-gray-200 rounded px-3 py-2 text-sm focus:outline-none focus:border-primary pl-3 pr-8"></div>
                        <button class="bg-primary-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-primary-700">Apply</button>
                    </div>
                </div>
            </div>
            <div class="flex bg-white border border-gray-200 rounded-lg shadow-sm p-1 h-9 items-center">
                <button class="w-8 h-full hover:bg-gray-50 rounded text-gray-500 flex items-center justify-center"><i class="ri-refresh-line"></i></button>
                <div class="w-px bg-gray-200 h-4 mx-1"></div>
                <button class="w-8 h-full hover:bg-gray-50 rounded text-gray-500 flex items-center justify-center"><i class="ri-download-line"></i></button>
            </div>
        </div>
    </div>
    
    <!-- FIXED CONTAINER: h-[800px] -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-card overflow-hidden flex flex-col h-[800px]">
        <div class="overflow-hidden w-full flex-1">
            <table class="w-full text-left border-collapse" id="transactionTable">
                <thead>
                    <tr class="bg-gray-50 text-[11px] text-gray-500 uppercase tracking-wider font-semibold border-b border-gray-200">
                        <th class="px-6 py-4">Date & Time</th>
                        <th class="px-6 py-4">Transaction ID</th>
                        <th class="px-6 py-4">Wallet</th>
                        <th class="px-6 py-4">Type</th>
                        <th class="px-6 py-4">Amount</th>
                        <th class="px-6 py-4">Status</th>
                    </tr>
                </thead>
                <tbody class="text-sm text-gray-700 divide-y divide-gray-100"></tbody>
            </table>
        </div>
        <!-- Footer Match: Bold Text + Icons -->
        <div class="px-6 py-4 border-t border-gray-200 flex justify-between items-center bg-gray-50 mt-auto flex-shrink-0">
            <div class="text-xs text-gray-500" id="paginationInfo"></div> <!-- Content injected by JS -->
            <div class="flex gap-2">
                <button onclick="changePage(-1)" id="btnPrev"></button> <!-- Content injected by JS -->
                <button onclick="changePage(1)" id="btnNext"></button> <!-- Content injected by JS -->
            </div>
        </div>
    </div>
</div>

        <!-- 4. CHANGE HISTORY PAGE (10 Rows, Fixed 800px) -->
<div id="page-history" class="page-section hidden">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-bold text-gray-900">Change History</h1>
        <div class="flex gap-3 items-center">
            <button onclick="toggleId('historyFilterPanel')" class="flex items-center gap-2 px-4 h-9 bg-white border border-gray-200 rounded-lg text-sm font-medium hover:bg-gray-50 shadow-sm transition"><i class="ri-add-line"></i> Add Filter</button>
            <div id="historyFilterPanel" class="dropdown-enter absolute top-full right-0 mt-2 w-[500px] bg-white rounded-xl shadow-popup border border-gray-100 p-4 z-50">
                 <div class="text-xs text-gray-500">Filter options here...</div>
            </div>
            <!-- REPLACED HISTORY CALENDAR DROPDOWN -->
<div class="relative dropdown-container">
    <div onclick="toggleId('historyDateDropdown')" class="flex items-center gap-2 bg-white border border-gray-200 px-3 h-9 rounded-lg shadow-sm text-sm text-gray-600 cursor-pointer hover:border-gray-300 transition">
        <span id="historyDateRangeText">01 Nov 25 - 01 Dec 25</span>
        <i class="ri-calendar-line text-gray-400"></i>
    </div>
    <div id="historyDateDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-[450px] bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50 !flex h-72">
        <!-- History Presets -->
        <div class="w-1/3 border-r border-gray-100 bg-gray-50 p-2 space-y-1 overflow-y-auto">
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Today</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Yesterday</div>
            <div class="px-3 py-2 text-xs font-bold text-white bg-primary shadow-sm rounded cursor-pointer">Last 7 Days</div>
            <div class="px-3 py-2 text-xs font-medium text-gray-600 hover:bg-white hover:text-primary hover:shadow-sm rounded cursor-pointer">Last 30 Days</div>
        </div>
        <!-- History Calendar Grid -->
        <div class="w-2/3 p-4 flex flex-col">
            <div class="flex justify-between items-center mb-3">
                <div class="flex gap-1 text-sm font-bold text-gray-700">
                    <span onclick="switchCalView('months', 'hist')" class="cursor-pointer hover:text-primary hover:bg-gray-100 px-1 rounded" id="calMonthLabel_hist">November</span>
                    <span onclick="switchCalView('years', 'hist')" class="cursor-pointer hover:text-primary hover:bg-gray-100 px-1 rounded" id="calYearLabel_hist">2025</span>
                </div>
                <div class="flex gap-1">
                    <button onclick="calPrev()" class="p-1 hover:bg-gray-100 rounded"><i class="ri-arrow-left-s-line"></i></button>
                    <button onclick="calNext()" class="p-1 hover:bg-gray-100 rounded"><i class="ri-arrow-right-s-line"></i></button>
                </div>
            </div>
            <div id="viewDays_hist" class="cal-view active h-full">
                <div class="grid grid-cols-7 gap-1 text-center text-[10px] text-gray-400 mb-1"><div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div></div>
                <div id="calendarGrid_hist" class="grid grid-cols-7 gap-1 text-center text-xs text-gray-700"></div>
            </div>
            <div id="viewMonths_hist" class="cal-view h-full">
                <div id="monthList_hist" class="grid grid-cols-3 gap-2 h-full overflow-y-auto p-1"></div>
            </div>
            <div id="viewYears_hist" class="cal-view h-full overflow-y-auto p-1">
                <div id="yearList_hist" class="flex flex-col space-y-1"></div>
            </div>
        </div>
    </div>
</div>
        </div>
    </div>

    <!-- FIXED CONTAINER: h-[800px] -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-card overflow-hidden flex flex-col h-[800px]">
        <div class="overflow-hidden w-full flex-1">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-gray-50 text-xs text-gray-500 uppercase tracking-wider border-b border-gray-200">
                        <th class="px-6 py-4 font-bold">Date</th>
                        <th class="px-6 py-4 font-bold">Entity</th>
                        <th class="px-6 py-4 font-bold">Change Level</th>
                        <th class="px-6 py-4 font-bold">Change Type</th>
                        <th class="px-6 py-4 font-bold">Changed By</th>
                        <th class="px-6 py-4 font-bold">Value</th>
                    </tr>
                </thead>
                <tbody class="text-sm text-gray-700 divide-y divide-gray-100">
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">01 Dec 25</div><div class="text-xs text-gray-400">02:49 PM</div></td><td class="px-6 py-3">Campaign</td><td class="px-6 py-3">Targeting</td><td class="px-6 py-3">Keyword Added</td><td class="px-6 py-3">Anuj S.</td><td class="px-6 py-3">-</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">01 Dec 25</div><div class="text-xs text-gray-400">02:48 PM</div></td><td class="px-6 py-3">Campaign</td><td class="px-6 py-3">Targeting</td><td class="px-6 py-3">Keyword Added</td><td class="px-6 py-3">Anuj S.</td><td class="px-6 py-3">-</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">21 Nov 25</div><div class="text-xs text-gray-400">07:40 PM</div></td><td class="px-6 py-3">Campaign</td><td class="px-6 py-3">Targeting</td><td class="px-6 py-3">Keyword Added</td><td class="px-6 py-3">Anuj S.</td><td class="px-6 py-3">-</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">20 Nov 25</div><div class="text-xs text-gray-400">10:15 AM</div></td><td class="px-6 py-3">Ad Group</td><td class="px-6 py-3">Bid Adj.</td><td class="px-6 py-3">Bid Increased</td><td class="px-6 py-3">System</td><td class="px-6 py-3">12.00</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">19 Nov 25</div><div class="text-xs text-gray-400">09:30 AM</div></td><td class="px-6 py-3">Campaign</td><td class="px-6 py-3">Budget</td><td class="px-6 py-3">Budget Up</td><td class="px-6 py-3">Anuj S.</td><td class="px-6 py-3">5000</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">18 Nov 25</div><div class="text-xs text-gray-400">04:10 PM</div></td><td class="px-6 py-3">Account</td><td class="px-6 py-3">Wallet</td><td class="px-6 py-3">Funds Added</td><td class="px-6 py-3">Admin</td><td class="px-6 py-3">50k</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">15 Nov 25</div><div class="text-xs text-gray-400">11:00 AM</div></td><td class="px-6 py-3">Campaign</td><td class="px-6 py-3">Status</td><td class="px-6 py-3">Paused</td><td class="px-6 py-3">System</td><td class="px-6 py-3">Active</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">12 Nov 25</div><div class="text-xs text-gray-400">01:20 PM</div></td><td class="px-6 py-3">Ad Group</td><td class="px-6 py-3">Targeting</td><td class="px-6 py-3">Kw Removed</td><td class="px-6 py-3">Anuj S.</td><td class="px-6 py-3">"Free"</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">10 Nov 25</div><div class="text-xs text-gray-400">03:45 PM</div></td><td class="px-6 py-3">Campaign</td><td class="px-6 py-3">Creative</td><td class="px-6 py-3">Banner Update</td><td class="px-6 py-3">Team</td><td class="px-6 py-3">Old.jpg</td></tr>
                    <tr class="hover:bg-gray-50 transition"><td class="px-6 py-3"><div class="font-bold">05 Nov 25</div><div class="text-xs text-gray-400">10:00 AM</div></td><td class="px-6 py-3">Account</td><td class="px-6 py-3">Settings</td><td class="px-6 py-3">Tax Info</td><td class="px-6 py-3">Finance</td><td class="px-6 py-3">-</td></tr>
                </tbody>
            </table>
        </div>
        <!-- Footer Match: Bold Text -->
        <div class="bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center mt-auto flex-shrink-0">
            <span class="text-xs text-gray-500">Showing <span class="font-bold text-gray-800">1-10</span> of <span class="font-bold text-gray-800">10</span> Changes</span>
            <div class="flex gap-2">
                <button class="flex items-center gap-1 px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-500 cursor-not-allowed transition" disabled>
                    <i class="ri-arrow-left-s-line"></i> Previous
                </button>
                <button class="flex items-center gap-1 px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-500 cursor-not-allowed transition" disabled>
                    Next <i class="ri-arrow-right-s-line"></i>
                </button>
            </div>
        </div>
    </div>
</div>

        <!-- 4. BALANCE & MANAGE PAGE (FIXED HEADERS + SCROLLABLE TABLE + CORRECT TOOLBARS) -->
<div id="page-balance" class="page-section hidden h-full flex flex-col overflow-hidden">
    
    <!-- FIXED TOP SECTION (Does not scroll) -->
    <div class="flex-shrink-0 pr-2">
        <!-- Page Title & Wallet Selector -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
            <div>
                <h1 class="text-2xl font-bold text-gray-900">Balance & Manage</h1>
                <p class="text-xs text-gray-500 mt-0.5">Manage wallets, top-ups, and billing history.</p>
            </div>
            <div class="relative dropdown-container z-30">
                <button onclick="toggleId('walletSelectorDropdown')" class="w-72 bg-white border border-gray-200 rounded-xl px-4 py-2 flex justify-between items-center shadow-sm hover:border-primary transition group">
                    <div class="flex flex-col items-start text-left">
                        <span class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">Current Wallet</span>
                        <span id="selectedWalletLabel" class="font-bold text-gray-800 text-xs">Default</span>
                    </div>
                    <div class="text-right"><span id="selectedWalletBalance" class="block font-bold text-primary text-sm"> 2,74,689</span></div>
                    <i class="ri-arrow-down-s-line text-gray-400 group-hover:text-primary ml-2"></i>
                </button>
                <div id="walletSelectorDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-72 bg-white border border-gray-100 rounded-xl shadow-popup overflow-hidden z-50">
    <!-- Search -->
    <div class="p-2 border-b border-gray-50">
        <div class="relative">
            <i class="ri-search-line absolute left-3 top-2.5 text-gray-400 text-xs"></i>
            <input type="text" placeholder="Search" class="w-full pl-8 pr-3 py-2 text-xs bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary">
        </div>
    </div>
    
    <!-- Wallet List -->
    <div class="max-h-60 overflow-y-auto">
        <!-- All -->
        <div onclick="selectGlobalWallet('All', ' 19,98,173')" class="px-4 py-3 hover:bg-purple-50 cursor-pointer flex justify-between items-center group border-b border-gray-50 transition">
            <span class="text-xs font-medium text-gray-700 group-hover:text-gray-900">All</span>
            <span class="text-xs text-gray-500 italic font-medium group-hover:text-gray-700"> 19,98,173</span>
        </div>
        <!-- Default -->
        <div onclick="selectGlobalWallet('Default', '- 593')" class="px-4 py-3 bg-purple-50 cursor-pointer flex justify-between items-center group border-b border-gray-50 transition">
            <span class="text-xs font-bold text-primary">Default</span>
            <span class="text-xs text-primary font-bold italic">-  593</span>
        </div>
        <!-- Performance Ads -->
        <div onclick="selectGlobalWallet('Performance Ads', ' 0')" class="px-4 py-3 hover:bg-purple-50 cursor-pointer flex justify-between items-center group border-b border-gray-50 transition">
            <span class="text-xs font-medium text-gray-700 group-hover:text-gray-900">Performance Ads</span>
            <span class="text-xs text-gray-500 italic font-medium group-hover:text-gray-700"> 0</span>
        </div>
        <!-- Awareness Ads -->
        <div onclick="selectGlobalWallet('Awareness Ads', ' 0')" class="px-4 py-3 hover:bg-purple-50 cursor-pointer flex justify-between items-center group border-b border-gray-50 transition">
            <span class="text-xs font-medium text-gray-700 group-hover:text-gray-900">Awareness Ads</span>
            <span class="text-xs text-gray-500 italic font-medium group-hover:text-gray-700"> 0</span>
        </div>
        <!-- PDA -->
        <div onclick="selectGlobalWallet('PDA', ' 19,98,765')" class="px-4 py-3 hover:bg-purple-50 cursor-pointer flex justify-between items-center group transition">
            <span class="text-xs font-medium text-gray-700 group-hover:text-gray-900">PDA</span>
            <span class="text-xs text-gray-500 italic font-medium group-hover:text-gray-700"> 19,98,765</span>
        </div>
    </div>

    <!-- Footer Button -->
    <div onclick="openCreateWalletModal()" class="p-3 bg-gray-50 border-t border-gray-100 cursor-pointer hover:bg-gray-100 transition text-center group">
        <span class="text-xs font-bold text-primary flex items-center justify-center gap-2 group-hover:text-primary-dark">
            <i class="ri-add-line text-sm"></i> Create New Wallet
        </span>
    </div>
</div>
            </div>
        </div>

        <!-- Alert -->
        <div class="bg-orange-50 border border-orange-100 rounded-xl p-2.5 flex items-start gap-3 mb-4">
            <i class="ri-alert-fill text-orange-500 mt-0.5"></i>
            <div><p class="text-xs font-bold text-orange-800">Unbilled Amount Alert</p><p class="text-[10px] text-orange-700 mt-0.5">Unbilled amount of <span class="font-bold">6,064</span> will be adjusted by 9 AM tomorrow.</p></div>
        </div>

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
            <div class="lg:col-span-2 grid grid-cols-3 gap-4">
                <div class="bg-white px-4 py-3 rounded-xl border border-gray-100 shadow-card relative overflow-hidden group hover:border-primary/30 transition">
                    <div class="absolute -top-2 -right-2 p-3 opacity-5 group-hover:opacity-10"><i class="ri-wallet-3-fill text-6xl text-primary"></i></div>
                    <div class="flex items-center gap-2 mb-2"><div class="w-6 h-6 rounded-full bg-purple-50 text-primary flex items-center justify-center"><i class="ri-money-dollar-circle-line"></i></div><span class="text-[10px] font-bold text-gray-400 uppercase">Real Balance</span></div>
                    <h2 class="text-xl font-bold text-gray-900" id="kpiRealBalance"> 2,74,689</h2>
                </div>
                <div class="bg-white px-4 py-3 rounded-xl border border-gray-100 shadow-card relative overflow-hidden group hover:border-primary/30 transition">
                    <div class="absolute -top-2 -right-2 p-3 opacity-5 group-hover:opacity-10"><i class="ri-coupon-3-fill text-6xl text-primary"></i></div>
                    <div class="flex items-center gap-2 mb-2"><div class="w-6 h-6 rounded-full bg-primary-50 text-primary-600 flex items-center justify-center"><i class="ri-coupon-3-line"></i></div><span class="text-[10px] font-bold text-gray-400 uppercase">Promo Credits</span></div>
                    <h2 class="text-xl font-bold text-gray-900"> 3,26,660</h2>
                </div>
                <div class="bg-white px-4 py-3 rounded-xl border border-gray-100 shadow-card relative overflow-hidden group hover:border-primary/30 transition">
                    <div class="absolute -top-2 -right-2 p-3 opacity-5 group-hover:opacity-10"><i class="ri-bar-chart-box-fill text-6xl text-primary"></i></div>
                    <div class="flex items-center gap-2 mb-2"><div class="w-6 h-6 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center"><i class="ri-bar-chart-box-line"></i></div><span class="text-[10px] font-bold text-gray-400 uppercase">Max Usage</span></div>
                    <h2 class="text-xl font-bold text-gray-900"> 3,20,596</h2>
                </div>
            </div>
            <div class="lg:col-span-1 bg-white px-4 py-3 rounded-xl border border-gray-100 shadow-card flex flex-col justify-center">
                <div class="flex justify-between items-center mb-2"><label class="text-xs font-bold text-gray-800">Add Money</label><span class="text-[9px] text-gray-400">GST: 18% Extra</span></div>
                <div class="flex gap-2"><input type="number" placeholder="Amount" class="w-full pl-3 pr-2 py-1.5 border border-gray-200 rounded text-xs font-bold"><button class="bg-primary text-white font-bold px-3 py-1.5 rounded text-xs whitespace-nowrap">Add Funds</button></div>
            </div>
        </div>
    </div>

    <!-- TABS CONTAINER (Fixed Height to force scroll) -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-card flex flex-col flex-1 overflow-hidden">
        
        <!-- Tab Navigation -->
        <div class="border-b border-gray-100 px-6 pt-2 flex-shrink-0 bg-white z-20">
            <nav class="flex gap-8" id="balanceTabs">
                <button onclick="switchBalanceTab('tab-campaigns', this)" class="pb-3 border-b-2 border-primary text-primary font-bold text-xs flex items-center gap-2 transition-colors">Campaign Type</button>
                <button onclick="switchBalanceTab('tab-transactions', this)" class="pb-3 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-xs flex items-center gap-2 transition-colors">Transaction Log</button>
                <button onclick="switchBalanceTab('tab-wallets', this)" class="pb-3 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-xs flex items-center gap-2 transition-colors">Wallet</button>
            </nav>
        </div>

        <!-- Content Area -->
        <div class="p-6 flex-1 overflow-hidden relative">
            
            <!-- TAB 1: Campaign Type (15 Rows + Scroll) -->
            <div id="tab-campaigns" class="balance-tab-content h-full flex flex-col">
                <!-- Toolbar: Filter | Refresh, Columns -->
                <div class="flex justify-between items-center mb-4 flex-shrink-0">
                    <button class="flex items-center gap-2 px-4 py-1.5 border border-gray-200 rounded-full text-xs font-bold text-gray-600 hover:bg-gray-50 transition"><i class="ri-add-line"></i> Add Filter</button>
                    <div class="flex gap-2">
                        <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-refresh-line"></i><div class="icon-tooltip">Refresh</div></button>
                        <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-layout-column-line"></i><div class="icon-tooltip">Columns</div></button>
                    </div>
                </div>
                <!-- Table Container with Specific Height Calculation -->
                <div class="border border-gray-100 rounded-lg flex-1 overflow-y-auto h-[calc(100vh-450px)] shadow-inner">
                    <table class="w-full text-left border-collapse">
                        <thead class="sticky top-0 bg-gray-50 z-10 shadow-sm">
                            <tr class="text-[11px] text-gray-500 uppercase tracking-wider font-semibold">
                                <th class="px-6 py-4 border-b">Campaign Type</th>
                                <th class="px-6 py-4 text-center border-b">Wallet</th>
                                <th class="px-6 py-4 border-b">Spend (7 days)</th>
                                <th class="px-6 py-4 text-right border-b">Max Usage</th>
                                <th class="px-6 py-4 text-right border-b">Balance</th>
                                <th class="px-6 py-4 text-right border-b">Promo Bal</th>
                            </tr>
                        </thead>
                        <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                            <!-- 15 Rows to force scroll -->
    <!-- Row 1 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Sponsored Product Ads</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold cursor-pointer hover:underline">Default</span></td>
        <!-- Purple Graph Added Here -->
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 25 Q 20 5, 40 15 T 100 10" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">3,20,596</td>
        <td class="px-6 py-3 text-right font-medium text-gray-900">15,400</td>
        <td class="px-6 py-3 text-right text-gray-500">3.3 L</td>
    </tr>
    <!-- Row 2 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Sponsored Display Ads</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold cursor-pointer hover:underline">PDA</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 20 Q 30 25, 50 10 T 100 15" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">23,19,362</td>
        <td class="px-6 py-3 text-right font-medium text-gray-900">0</td>
        <td class="px-6 py-3 text-right text-gray-500">23.3 L</td>
    </tr>
    <!-- Row 3 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Video Ads</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold cursor-pointer hover:underline">Awareness</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 25 L 20 25 L 40 10 L 60 20 L 100 5" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">5,00,000</td>
        <td class="px-6 py-3 text-right font-medium text-gray-900">1.2 L</td>
        <td class="px-6 py-3 text-right text-gray-500">50k</td>
    </tr>
    <!-- Row 4 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Search Ads</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold cursor-pointer hover:underline">Default</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 15 Q 25 15, 50 15 T 100 15" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none" stroke-dasharray="4 2"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">1,50,000</td>
        <td class="px-6 py-3 text-right font-medium text-gray-900">20k</td>
        <td class="px-6 py-3 text-right text-gray-500">10k</td>
    </tr>
    <!-- Row 5 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Brand Lift Study</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold cursor-pointer hover:underline">Awareness</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 28 C 20 28, 40 5, 60 15 S 80 5, 100 10" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">8,00,000</td>
        <td class="px-6 py-3 text-right font-medium text-gray-900">4.5 L</td>
        <td class="px-6 py-3 text-right text-gray-500">0</td>
    </tr>
    <!-- Row 6 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Retargeting</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Performance</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 10 Q 25 25, 50 10 T 100 20" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">2,00,000</td>
        <td class="px-6 py-3 text-right font-medium">5,000</td>
        <td class="px-6 py-3 text-right text-gray-500">1.1 L</td>
    </tr>
    <!-- Row 7 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Influencer Boost</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Default</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 20 L 15 20 L 30 5 L 45 15 L 100 10" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">3,50,000</td>
        <td class="px-6 py-3 text-right font-medium">1.8 L</td>
        <td class="px-6 py-3 text-right text-gray-500">20k</td>
    </tr>
    <!-- Row 8 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Seasonal Flash</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Performance</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 25 Q 30 25, 40 10 T 100 5" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">1,20,000</td>
        <td class="px-6 py-3 text-right font-medium">2,000</td>
        <td class="px-6 py-3 text-right text-gray-500">50k</td>
    </tr>
    <!-- Row 9 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Discovery Ads</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Default</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 15 Q 15 5, 30 15 T 60 15 T 100 20" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">4,00,000</td>
        <td class="px-6 py-3 text-right font-medium">3.5 L</td>
        <td class="px-6 py-3 text-right text-gray-500">15k</td>
    </tr>
    <!-- Row 10 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Email Sponsored</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Default</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 28 L 100 28" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">50,000</td>
        <td class="px-6 py-3 text-right font-medium">45,000</td>
        <td class="px-6 py-3 text-right text-gray-500">0</td>
    </tr>
    <!-- Row 11 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Affiliate Network</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Performance</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 20 Q 20 5, 40 20 T 100 15" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">6,50,000</td>
        <td class="px-6 py-3 text-right font-medium">2.1 L</td>
        <td class="px-6 py-3 text-right text-gray-500">1.0 L</td>
    </tr>
    <!-- Row 12 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Push Notification</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Default</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 15 L 20 15 L 40 5 L 60 15 L 100 20" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">1,80,000</td>
        <td class="px-6 py-3 text-right font-medium">90,000</td>
        <td class="px-6 py-3 text-right text-gray-500">25k</td>
    </tr>
    <!-- Row 13 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Live Commerce</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Awareness</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 25 C 30 25, 40 5, 100 10" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">10,00,000</td>
        <td class="px-6 py-3 text-right font-medium">7.5 L</td>
        <td class="px-6 py-3 text-right text-gray-500">50k</td>
    </tr>
    <!-- Row 14 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Homepage Banner</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">PDA</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 10 Q 25 25, 50 15 T 100 5" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">15,00,000</td>
        <td class="px-6 py-3 text-right font-medium">50,000</td>
        <td class="px-6 py-3 text-right text-gray-500">5.0 L</td>
    </tr>
    <!-- Row 15 -->
    <tr class="hover:bg-gray-50 transition h-16">
        <td class="px-6 py-3 font-bold text-gray-700">Checkout Upsell</td>
        <td class="px-6 py-3 text-center"><span class="text-primary-600 font-bold hover:underline cursor-pointer">Performance</span></td>
        <td class="px-6 py-3">
            <svg width="100" height="30" viewBox="0 0 100 30" fill="none">
                <path d="M0 20 Q 20 20, 35 5, 60 5 T 100 5" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
        </td>
        <td class="px-6 py-3 text-right text-gray-500">2,50,000</td>
        <td class="px-6 py-3 text-right font-medium">80,000</td>
        <td class="px-6 py-3 text-right text-gray-500">30k</td>
    </tr>
</tbody>
                    </table>
                </div>
            </div>

            <!-- TAB 2: Transaction Log (Updated with Description Column & More Rows) -->
<div id="tab-transactions" class="balance-tab-content hidden h-full flex flex-col">
    <!-- Toolbar -->
    <div class="flex justify-between items-center mb-4 flex-shrink-0">
        <button class="flex items-center gap-2 px-4 py-1.5 border border-gray-200 rounded-full text-xs font-bold text-gray-600 hover:bg-gray-50 transition">
            <i class="ri-add-line"></i> Add Filter
        </button>
        <div class="flex gap-2">
            <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-refresh-line"></i><div class="icon-tooltip">Refresh</div></button>
            <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-download-line"></i><div class="icon-tooltip">Download</div></button>
            <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-layout-column-line"></i><div class="icon-tooltip">Columns</div></button>
        </div>
    </div>

    <!-- Scrollable Table Area -->
    <div class="border border-gray-100 rounded-lg flex-1 overflow-y-auto h-[calc(100vh-450px)] shadow-inner">
        <table class="w-full text-left border-collapse min-w-[1000px]"> <!-- Added min-w to ensure horizontal scroll if needed -->
            <thead class="sticky top-0 bg-gray-50 z-10 shadow-sm">
                <tr class="bg-gray-50 text-[11px] text-gray-500 uppercase tracking-wider font-semibold border-b border-gray-200">
                    <th class="px-4 py-4 w-32 whitespace-nowrap">Date <i class="ri-align-left ml-1"></i></th>
                    <th class="px-4 py-4 w-48">Transaction ID</th>
                    <th class="px-4 py-4 w-24">Wallet</th>
                    <th class="px-4 py-4 w-32">Transaction Type</th>
                    <th class="px-4 py-4 w-32 text-right">Amount</th>
                    <th class="px-4 py-4 w-24">Status</th>
                    <th class="px-4 py-4 w-48">Description</th> <!-- New Column -->
                </tr>
            </thead>
            <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                <!-- Row 1 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">31 Jul 25, 09:02 PM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01K1GHTQ8XG6TZFK0FAD3FC0NT</td>
                    <td class="px-4 py-4">PDA</td>
                    <td class="px-4 py-4 text-gray-500">Promotional</td>
                    <td class="px-4 py-4 text-right font-medium text-gray-900">20,00,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">PDA August Allocation</td>
                </tr>
                <!-- Row 2 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">09 Jul 25, 09:17 PM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JZQXXC275D6SJ31M76AVVQSF</td>
                    <td class="px-4 py-4">Default</td>
                    <td class="px-4 py-4 text-gray-500">Promotional</td>
                    <td class="px-4 py-4 text-right font-medium text-gray-900">7,43,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">10th - 31st July Campaign</td>
                </tr>
                <!-- Row 3 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">09 Jul 25, 09:14 PM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JZQXRP47VW6X7S3H07XTWEKM</td>
                    <td class="px-4 py-4">Default</td>
                    <td class="px-4 py-4 text-gray-500">Promotional Refund</td>
                    <td class="px-4 py-4 text-right font-medium text-red-600">-7,43,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">Adjustment: 10th - 31st July</td>
                </tr>
                <!-- Row 4 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">09 Jul 25, 09:07 PM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JZQXC5NCY168XKZ2E0KDWPFA</td>
                    <td class="px-4 py-4">Default</td>
                    <td class="px-4 py-4 text-gray-500">Promotional</td>
                    <td class="px-4 py-4 text-right font-medium text-gray-900">7,43,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">10th - 31st June (Correction)</td>
                </tr>
                <!-- Row 5 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">01 Jul 25, 10:00 AM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JY8VB92K9L2M4N5P7Q8R9S0T</td>
                    <td class="px-4 py-4">Awareness</td>
                    <td class="px-4 py-4 text-gray-500">Prepaid Top-up</td>
                    <td class="px-4 py-4 text-right font-medium text-gray-900">50,00,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">Q3 Brand Awareness Fund</td>
                </tr>
                <!-- Row 6 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">28 Jun 25, 04:30 PM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JX7UA81J8K1L3M4N6P7Q8R9S</td>
                    <td class="px-4 py-4">Performance</td>
                    <td class="px-4 py-4 text-gray-500">Promotional</td>
                    <td class="px-4 py-4 text-right font-medium text-gray-900">15,00,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">End of Season Sale Push</td>
                </tr>
                <!-- Row 7 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">15 Jun 25, 11:15 AM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JW6T970I7J0K2L3M5O6P7Q8R</td>
                    <td class="px-4 py-4">Default</td>
                    <td class="px-4 py-4 text-gray-500">Refund</td>
                    <td class="px-4 py-4 text-right font-medium text-red-600">-2,50,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">Unused Budget Return</td>
                </tr>
                <!-- Row 8 -->
                <tr class="hover:bg-gray-50 transition">
                    <td class="px-4 py-4 text-gray-500 whitespace-nowrap">01 Jun 25, 09:00 AM</td>
                    <td class="px-4 py-4 font-mono text-[10px] text-gray-400 break-all">01JV5S869H6I9J1K2L4N5O6P7Q</td>
                    <td class="px-4 py-4">PDA</td>
                    <td class="px-4 py-4 text-gray-500">Promotional</td>
                    <td class="px-4 py-4 text-right font-medium text-gray-900">18,50,000</td>
                    <td class="px-4 py-4 text-green-600 font-medium">Successful</td>
                    <td class="px-4 py-4 text-gray-500">June Monthly Allocation</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

            <!-- TAB 3: Wallets (Individually Hoverable Icons) -->
<div id="tab-wallets" class="balance-tab-content hidden h-full flex flex-col">
    <!-- Toolbar -->
    <div class="flex justify-between items-center mb-4 flex-shrink-0">
        <button class="flex items-center gap-2 px-4 py-1.5 border border-gray-200 rounded-full text-xs font-bold text-gray-600 hover:bg-gray-50 transition">
            <i class="ri-add-line"></i> Add Filter
        </button>
        <div class="flex gap-2 items-center">
            <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-refresh-line"></i><div class="icon-tooltip">Refresh</div></button>
            <button class="w-8 h-8 flex items-center justify-center border border-gray-200 rounded-md text-gray-500 hover:text-primary transition relative group"><i class="ri-layout-column-line"></i><div class="icon-tooltip">Columns</div></button>
            <button onclick="openCreateWalletModal()" class="ml-2 flex items-center gap-1 text-xs text-white font-bold bg-primary px-4 py-2 rounded-md hover:bg-primary-dark transition shadow-sm"><i class="ri-add-line"></i> Create New Wallet</button>
        </div>
    </div>

    <!-- Scrollable Table Container -->
    <div class="border border-gray-100 rounded-lg flex-1 overflow-y-auto h-[calc(100vh-450px)] shadow-inner">
        <table class="w-full text-left border-collapse">
            <thead class="sticky top-0 bg-gray-50 z-10 shadow-sm">
                <tr class="text-[11px] text-gray-500 uppercase tracking-wider font-semibold border-b">
                    <th class="px-6 py-4 w-48">Wallet Name</th>
                    <th class="px-6 py-4 w-24">Description</th>
                    <th class="px-6 py-4 w-48">Campaign Type Tagged</th>
                    <th class="px-6 py-4 w-32">Spend <span class="normal-case font-normal text-gray-400">(7 days)</span></th>
                    <th class="px-6 py-4 w-32 text-right">Max Usage Allowed</th>
                    <th class="px-6 py-4 w-24 text-right">Balance</th>
                    <th class="px-6 py-4 w-32 text-right">Promo Balance</th>
                    <th class="px-6 py-4 w-24 text-center">Active Camp.</th>
                    <!-- Fixed Column Header -->
                    <th class="px-6 py-4 w-32 text-center bg-gray-50 border-l border-gray-100 sticky right-0 z-20">Actions</th>
                </tr>
            </thead>
            <tbody class="text-xs text-gray-700 divide-y divide-gray-100">
                
                <!-- Row 1 -->
                <tr class="hover:bg-gray-50 transition h-16 group">
                    <td class="px-6 py-3 font-bold text-gray-900 cursor-pointer hover:text-primary hover:underline transition-colors">Performance Ads</td>
                    <td class="px-6 py-3 text-gray-400">-</td>
                    <td class="px-6 py-3 text-gray-700">Sponsored Product Ads</td>
                    <td class="px-6 py-3"><svg width="100" height="30" viewBox="0 0 100 30" fill="none"><path d="M0 15 L 100 15" stroke="#e5e7eb" stroke-width="2" /></svg></td>
                    <td class="px-6 py-3 text-right text-gray-500">0 <i class="ri-question-line ml-1"></i></td>
                    <td class="px-6 py-3 text-right font-medium text-gray-900">0</td>
                    <td class="px-6 py-3 text-right text-gray-500">0</td>
                    <td class="px-6 py-3 text-center text-gray-400">-</td>
                    
                    <!-- Action Column -->
                    <td class="px-6 py-3 text-center bg-white border-l border-gray-100 sticky right-0 hover:z-20 transition-all">
                        <div class="flex justify-center gap-4"> <!-- Increased gap for easier hovering -->
                            
                            <!-- 1. Transfer Icon (Independent) -->
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-arrow-left-right-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transfer Funds</div>
                            </button>

                            <!-- 2. History Icon (Independent) -->
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-history-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transaction Log</div>
                            </button>

                        </div>
                    </td>
                </tr>

                <!-- Row 2 -->
                <tr class="hover:bg-gray-50 transition h-16 group">
                    <td class="px-6 py-3 font-bold text-gray-900 cursor-pointer hover:text-primary hover:underline transition-colors">Awareness Ads</td>
                    <td class="px-6 py-3 text-gray-400">-</td>
                    <td class="px-6 py-3 text-gray-700">Sponsored Display Ads</td>
                    <td class="px-6 py-3"><svg width="100" height="30" viewBox="0 0 100 30" fill="none"><path d="M0 15 L 100 15" stroke="#e5e7eb" stroke-width="2" /></svg></td>
                    <td class="px-6 py-3 text-right text-gray-500">0 <i class="ri-question-line ml-1"></i></td>
                    <td class="px-6 py-3 text-right font-medium text-gray-900">0</td>
                    <td class="px-6 py-3 text-right text-gray-500">0</td>
                    <td class="px-6 py-3 text-center text-gray-400">-</td>
                    
                    <td class="px-6 py-3 text-center bg-white border-l border-gray-100 sticky right-0 hover:z-20 transition-all">
                        <div class="flex justify-center gap-4">
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-arrow-left-right-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transfer Funds</div>
                            </button>
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-history-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transaction Log</div>
                            </button>
                        </div>
                    </td>
                </tr>

                <!-- Row 3 -->
                <tr class="hover:bg-gray-50 transition h-16 group">
                    <td class="px-6 py-3 font-bold text-gray-900 cursor-pointer hover:text-primary hover:underline transition-colors">PDA</td>
                    <td class="px-6 py-3 text-gray-400">-</td>
                    <td class="px-6 py-3 text-gray-700">Sponsored Display Ads</td>
                    <td class="px-6 py-3"><svg width="100" height="30" viewBox="0 0 100 30" fill="none"><path d="M0 15 L 100 15" stroke="#e5e7eb" stroke-width="2" /></svg></td>
                    <td class="px-6 py-3 text-right text-gray-500">19,98,766 <i class="ri-question-line ml-1"></i></td>
                    <td class="px-6 py-3 text-right font-medium text-gray-900">0</td>
                    <td class="px-6 py-3 text-right text-gray-500">19,98,766</td>
                    <td class="px-6 py-3 text-center text-gray-900 font-bold">0</td>
                    
                    <td class="px-6 py-3 text-center bg-white border-l border-gray-100 sticky right-0 hover:z-20 transition-all">
                        <div class="flex justify-center gap-4">
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-arrow-left-right-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transfer Funds</div>
                            </button>
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-history-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transaction Log</div>
                            </button>
                        </div>
                    </td>
                </tr>

                <!-- Row 4 -->
                <tr class="hover:bg-gray-50 transition h-16 group">
                    <td class="px-6 py-3 font-bold text-gray-900 cursor-pointer hover:text-primary hover:underline transition-colors">Default</td>
                    <td class="px-6 py-3 text-gray-400">-</td>
                    <td class="px-6 py-3 text-gray-700">Sponsored Product Ads, S...</td>
                    <td class="px-6 py-3"><svg width="100" height="30" viewBox="0 0 100 30" fill="none"><path d="M0 25 Q 20 5, 40 15 T 100 10" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/></svg></td>
                    <td class="px-6 py-3 text-right text-gray-500">314 <i class="ri-question-line ml-1"></i></td>
                    <td class="px-6 py-3 text-right font-medium text-gray-900">0</td>
                    <td class="px-6 py-3 text-right text-gray-500">7,399</td>
                    <td class="px-6 py-3 text-center text-gray-900 font-bold">15</td>
                    
                    <td class="px-6 py-3 text-center bg-white border-l border-gray-100 sticky right-0 hover:z-20 transition-all">
                        <div class="flex justify-center gap-4">
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-arrow-left-right-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transfer Funds</div>
                            </button>
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-history-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transaction Log</div>
                            </button>
                        </div>
                    </td>
                </tr>

                <!-- Row 5 -->
                <tr class="hover:bg-gray-50 transition h-16 group">
                    <td class="px-6 py-3 font-bold text-gray-900 cursor-pointer hover:text-primary hover:underline transition-colors">Q4 Marketing</td>
                    <td class="px-6 py-3 text-gray-400">-</td>
                    <td class="px-6 py-3 text-gray-700">Video Ads</td>
                    <td class="px-6 py-3"><svg width="100" height="30" viewBox="0 0 100 30" fill="none"><path d="M0 20 Q 30 25, 50 10 T 100 15" stroke="#9c00ad" stroke-width="2" stroke-linecap="round" fill="none"/></svg></td>
                    <td class="px-6 py-3 text-right text-gray-500">1,50,000 <i class="ri-question-line ml-1"></i></td>
                    <td class="px-6 py-3 text-right font-medium text-gray-900">12,500</td>
                    <td class="px-6 py-3 text-right text-gray-500">0</td>
                    <td class="px-6 py-3 text-center text-gray-900 font-bold">4</td>
                    
                    <td class="px-6 py-3 text-center bg-white border-l border-gray-100 sticky right-0 hover:z-20 transition-all">
                        <div class="flex justify-center gap-4">
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-arrow-left-right-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transfer Funds</div>
                            </button>
                            <button class="text-gray-800 hover:text-primary relative group/btn p-1 transition-colors duration-200">
                                <i class="ri-history-line text-lg"></i>
                                <div class="absolute right-full top-1/2 -translate-y-1/2 mr-2 w-max px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg opacity-0 invisible group-hover/btn:opacity-100 group-hover/btn:visible transition-all duration-200 z-50">Transaction Log</div>
                            </button>
                        </div>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>
</div>

        </div>
    </div>
</div>
<!-- 6. CREATIVES PAGE (NEW MODULE) -->
<div id="page-creatives" class="page-section hidden">
    
    <!-- 1. Top Header & Toolbar -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
        <div>
            <h1 class="text-2xl font-bold text-gray-900">Creative Library</h1>
            <p class="text-xs text-gray-500 mt-1">Manage and organize your ad creatives, banners, and videos.</p>
        </div>

        <div class="flex gap-3 w-full md:w-auto">
            <!-- Search -->
            <div class="relative flex-grow md:w-64">
                <i class="ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" id="creativeSearchInput" onkeyup="filterCreatives()" placeholder="Search tags or filenames..." class="pl-9 pr-4 py-2 border border-gray-200 rounded-lg text-sm w-full focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary/20 bg-white shadow-sm">
            </div>

            <!-- Filter Dropdown -->
            <div class="relative dropdown-container">
                <button onclick="toggleId('creativeFilterDropdown')" class="h-full px-4 bg-white border border-gray-200 rounded-lg text-gray-600 font-medium hover:border-gray-300 hover:bg-gray-50 flex items-center gap-2 shadow-sm transition">
                    <i class="ri-filter-3-line"></i> <span class="hidden sm:inline text-sm">Filters</span>
                </button>
                <div id="creativeFilterDropdown" class="dropdown-enter absolute top-full right-0 mt-2 w-56 bg-white rounded-lg shadow-popup border border-gray-100 overflow-hidden z-50 p-3">
                    <div class="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2">File Type</div>
                    <!-- Added IDs and onchange events here -->
                    <label class="flex items-center gap-2 px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer">
                        <input type="checkbox" id="filterCheckImage" checked onchange="filterCreatives()" class="rounded text-primary focus:ring-primary border-gray-300"> <span class="text-sm">Images (JPG, PNG)</span>
                    </label>
                    <label class="flex items-center gap-2 px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer">
                        <input type="checkbox" id="filterCheckVideo" checked onchange="filterCreatives()" class="rounded text-primary focus:ring-primary border-gray-300"> <span class="text-sm">Videos (MP4)</span>
                    </label>
                    <div class="h-px bg-gray-100 my-2"></div>
                    <div class="text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2">Dimensions</div>
                    <select class="w-full text-sm border border-gray-200 rounded px-2 py-1 bg-gray-50 focus:outline-none">
                        <option>All Sizes</option>
                        <option>Square (1:1)</option>
                        <option>Landscape (16:9)</option>
                        <option>Story (9:16)</option>
                    </select>
                </div>
            </div>

            <!-- Upload Button -->
            <button onclick="openCreativeModal('upload')" class="bg-primary hover:bg-primary-dark text-white px-5 py-2 rounded-lg font-bold shadow-lg shadow-purple-200 transition flex items-center gap-2 whitespace-nowrap">
                <i class="ri-upload-cloud-2-line text-lg"></i> <span>Upload</span>
            </button>
        </div>
    </div>

<!-- 2. Creatives Grid (Standardized Icons) -->
    <div id="creativeGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-10 min-h-[500px]">

        <!-- Item 1 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Summer_Sale_v1.jpg #Sale">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1596462502278-27bfdd403348?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1200 x 628 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Summer_Sale_v1.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">245 KB  2 days ago</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 2 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Lipstick_Matte_Red.png #Product">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1616683693504-3ea7e9ad6fec?auto=format&fit=crop&q=80&w=600" class="h-full object-contain rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1080 x 1080 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Lipstick_Matte_Red.png</h4><p class="text-[11px] text-gray-500 mt-0.5">1.2 MB  01 Dec 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 3 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="video" data-name="Story_Launch_Vid.mp4 #Launch #Reels">
            <div class="relative h-48 bg-gray-900 flex items-center justify-center overflow-hidden">
                <img src="https://images.unsplash.com/photo-1571781565036-d3f7595ca3f7?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover opacity-80 group-hover:opacity-60 transition">
                <div class="absolute inset-0 flex items-center justify-center"><div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white border border-white/50 group-hover:scale-110 transition"><i class="ri-play-fill text-2xl ml-1"></i></div></div>
                <div class="absolute bottom-3 right-3 bg-black/70 text-white text-[10px] font-bold px-2 py-1 rounded">00:15</div>
                <div class="absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1080 x 1920 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Story_Launch_Vid.mp4</h4><p class="text-[11px] text-gray-500 mt-0.5">8.5 MB  20 Nov 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 4 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Web_Header_Banner.jpg #Website">
            <div class="relative h-48 bg-gray-50 flex items-center justify-center p-4 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1550614000-4b9519e0031d?auto=format&fit=crop&q=80&w=600" class="w-full h-16 object-cover rounded shadow-sm group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">728 x 90 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Web_Header_Banner.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">150 KB  15 Nov 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 5 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Holiday_Bundle.jpg #Holiday">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1512496015851-a90fb38ba796?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1080 x 1080 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Holiday_Bundle.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">320 KB  10 Nov 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 6 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Makeup_Tutorial_Th.jpg #Content">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1522335789203-abd65232121c?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">600 x 600 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Makeup_Tutorial_Th.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">180 KB  08 Nov 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 7 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="video" data-name="Winter_Lookbook.mp4 #Winter">
            <div class="relative h-48 bg-gray-900 flex items-center justify-center overflow-hidden">
                <img src="https://images.unsplash.com/photo-1629198688000-71f23e745b6e?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover opacity-80 group-hover:opacity-60 transition">
                <div class="absolute inset-0 flex items-center justify-center"><div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white border border-white/50 group-hover:scale-110 transition"><i class="ri-play-fill text-2xl ml-1"></i></div></div>
                <div class="absolute bottom-3 right-3 bg-black/70 text-white text-[10px] font-bold px-2 py-1 rounded">00:30</div>
                <div class="absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1080 x 1920 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Winter_Lookbook.mp4</h4><p class="text-[11px] text-gray-500 mt-0.5">12.0 MB  05 Nov 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 8 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="New_Arrivals_Grid.jpg #New">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1599643478518-17488fbbcd75?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1200 x 1200 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">New_Arrivals_Grid.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">400 KB  01 Nov 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 9 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Skin_Care_Routine.jpg #Routine">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1576426863848-c21f5fc67255?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1080 x 1350 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Skin_Care_Routine.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">280 KB  28 Oct 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 10 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Serum_Feature.jpg #Serum">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1627384113972-f4c9891ee30c?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1200 x 628 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Serum_Feature.jpg</h4><p class="text-[11px] text-gray-500 mt-0.5">310 KB  25 Oct 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 11 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="image" data-name="Palette_Colors.png #Palette">
            <div class="relative h-48 bg-gray-100 flex items-center justify-center p-2 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1608248597279-f99d160bfbc8?auto=format&fit=crop&q=80&w=600" class="h-full object-contain rounded-lg group-hover:scale-105 transition duration-500">
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">800 x 800 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Palette_Colors.png</h4><p class="text-[11px] text-gray-500 mt-0.5">800 KB  22 Oct 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

        <!-- Item 12 -->
        <div class="creative-card group bg-white rounded-xl border border-gray-200 shadow-card hover:shadow-lg transition-all duration-300 overflow-hidden flex flex-col relative" data-type="video" data-name="Flash_Sale_Teaser.mp4 #Teaser">
            <div class="relative h-48 bg-gray-900 flex items-center justify-center overflow-hidden">
                <img src="https://images.unsplash.com/photo-1625772452859-1c03d5bf7f2f?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover opacity-80 group-hover:opacity-60 transition">
                <div class="absolute inset-0 flex items-center justify-center"><div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white border border-white/50 group-hover:scale-110 transition"><i class="ri-play-fill text-2xl ml-1"></i></div></div>
                <div class="absolute bottom-3 right-3 bg-black/70 text-white text-[10px] font-bold px-2 py-1 rounded">00:10</div>
                <div class="absolute inset-0 bg-black/80 opacity-0 group-hover:opacity-100 transition duration-200 flex flex-col items-center justify-center gap-3">
                    <div class="text-white text-xs font-mono mb-1">1080 x 1920 px</div>
                    <div class="flex gap-2">
                        <button onclick="previewCreative(this)" class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="View"><i class="ri-eye-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-gray-800 hover:text-primary hover:scale-110 transition flex items-center justify-center" title="Edit"><i class="ri-pencil-line"></i></button>
                        <button class="w-8 h-8 bg-white rounded-full text-red-500 hover:bg-red-50 hover:scale-110 transition flex items-center justify-center" title="Delete"><i class="ri-delete-bin-line"></i></button>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-100">
                <div class="flex justify-between items-start">
                    <div><h4 class="text-sm font-bold text-gray-800 truncate w-40">Flash_Sale_Teaser.mp4</h4><p class="text-[11px] text-gray-500 mt-0.5">4.2 MB  20 Oct 25</p></div>
                    <button class="text-gray-400 hover:text-gray-700"><i class="ri-more-2-fill"></i></button>
                </div>
            </div>
        </div>

    </div>

    <!-- 3. Working Pagination -->
    <div class="flex justify-center items-center gap-2 mt-auto pb-6">
        <button id="creativePrevBtn" onclick="changeCreativePage(-1)" class="px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-500 cursor-not-allowed transition" disabled>Previous</button>
        <button id="creativePage1" onclick="changeCreativePage(0, 1)" class="px-3 py-1 bg-primary text-white border border-primary rounded text-xs font-bold shadow-sm transition">1</button>
        <button id="creativePage2" onclick="changeCreativePage(0, 2)" class="px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-600 hover:bg-gray-50 transition">2</button>
        <button id="creativeNextBtn" onclick="changeCreativePage(1)" class="px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-600 hover:bg-gray-50 transition">Next</button>
    </div>
</div>

<!-- CREATIVE MODALS -->

<!-- 1. Upload Modal -->
<div id="uploadCreativeModal" class="fixed inset-0 bg-black/60 z-[80] hidden flex items-center justify-center opacity-0 transition-opacity duration-300">
    <div class="bg-white rounded-xl shadow-2xl w-[600px] max-w-[90%] transform scale-95 transition-transform duration-300" id="uploadModalContent">
        <div class="flex justify-between items-center p-5 border-b border-gray-100">
            <h3 class="font-bold text-lg text-gray-900">Upload Creative</h3>
            <button onclick="closeCreativeModal('upload')" class="text-gray-400 hover:text-gray-700"><i class="ri-close-line text-2xl"></i></button>
        </div>
        <div class="p-6">
            <div class="border-2 border-dashed border-gray-200 rounded-xl bg-gray-50 p-10 flex flex-col items-center justify-center text-center cursor-pointer hover:border-primary hover:bg-purple-50 transition group">
                <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-sm mb-4 group-hover:scale-110 transition text-primary">
                    <i class="ri-upload-cloud-2-fill text-3xl"></i>
                </div>
                <p class="font-bold text-gray-700">Click to upload or drag & drop</p>
                <p class="text-xs text-gray-500 mt-1">SVG, PNG, JPG or GIF (max. 800x400px)</p>
            </div>
            
            <div class="mt-6">
                <label class="block text-xs font-bold text-gray-700 mb-2">Tags (Optional)</label>
                <input type="text" placeholder="e.g. Summer, Sale, 2025" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary focus:outline-none">
            </div>
        </div>
        <div class="p-5 border-t border-gray-100 flex justify-end gap-3 bg-gray-50 rounded-b-xl">
            <button onclick="closeCreativeModal('upload')" class="px-5 py-2 text-sm font-bold text-gray-600 hover:bg-gray-200 rounded-lg transition">Cancel</button>
            <button onclick="closeCreativeModal('upload')" class="px-5 py-2 text-sm font-bold text-white bg-primary hover:bg-primary-dark rounded-lg transition shadow-md">Upload File</button>
        </div>
    </div>
</div>

<!-- 2. Preview Modal -->
<div id="previewCreativeModal" class="fixed inset-0 bg-black/80 z-[80] hidden flex items-center justify-center opacity-0 transition-opacity duration-300" onclick="closeCreativeModal('preview')">
    <div class="relative max-w-4xl w-full max-h-screen p-4 flex flex-col items-center" onclick="event.stopPropagation()">
        <button onclick="closeCreativeModal('preview')" class="absolute -top-10 right-0 text-white hover:text-gray-300 transition"><i class="ri-close-circle-fill text-4xl"></i></button>
        <img id="previewImageTarget" src="" class="max-w-full max-h-[80vh] rounded-lg shadow-2xl">
        <div class="bg-white rounded-full px-6 py-2 mt-4 shadow-lg flex items-center gap-6">
            <div class="text-center">
                <p class="text-[10px] text-gray-400 font-bold uppercase">Dimensions</p>
                <p class="text-sm font-bold text-gray-800">1200 x 628</p>
            </div>
            <div class="w-px h-8 bg-gray-200"></div>
            <div class="text-center">
                <p class="text-[10px] text-gray-400 font-bold uppercase">Size</p>
                <p class="text-sm font-bold text-gray-800">245 KB</p>
            </div>
            <div class="w-px h-8 bg-gray-200"></div>
            <button class="text-primary font-bold text-sm hover:underline">Download</button>
        </div>
    </div>
</div>
<!-- 7. REPORTS PAGE (10 Rows, Fixed 800px) -->
<div id="page-reports" class="page-section hidden">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
        <div>
            <h1 class="text-2xl font-bold text-gray-900">Reports</h1>
            <p class="text-xs text-gray-500 mt-1">Generate, schedule, and download campaign performance reports.</p>
        </div>
        <div class="flex gap-3 w-full md:w-auto">
            <div class="relative flex-grow md:w-64">
                <i class="ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" placeholder="Search reports..." class="pl-9 pr-4 py-2 border border-gray-200 rounded-lg text-sm w-full focus:outline-none focus:border-primary bg-white shadow-sm">
            </div>
            <button onclick="openReportModal()" class="bg-primary hover:bg-primary-dark text-white px-5 py-2 rounded-lg font-bold shadow-lg shadow-purple-200 transition flex items-center gap-2 whitespace-nowrap">
                <i class="ri-add-line text-lg"></i> <span>Create Report</span>
            </button>
        </div>
    </div>

    <!-- FIXED CONTAINER: h-[800px] -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-card overflow-hidden flex flex-col h-[800px]">
        <div class="overflow-hidden w-full flex-1">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr class="bg-gray-50 text-[11px] text-gray-500 uppercase tracking-wider font-semibold border-b border-gray-200">
                        <th class="px-6 py-4">Status</th>
                        <th class="px-6 py-4">Report Name</th>
                        <th class="px-6 py-4">Type</th>
                        <th class="px-6 py-4">Time Period</th>
                        <th class="px-6 py-4">Last Run</th>
                        <th class="px-6 py-4">Schedule</th>
                        <th class="px-6 py-4 text-center">Actions</th>
                    </tr>
                </thead>
                <tbody id="reportsTableBody" class="text-xs text-gray-700 divide-y divide-gray-100"></tbody>
            </table>
        </div>
        <!-- Footer Match: JS will fill bold text + Icons -->
        <div class="bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center mt-auto flex-shrink-0">
            <div class="text-xs text-gray-500" id="reportPaginationInfo"></div>
            <div class="flex gap-2">
                <button id="repPrevBtn" onclick="changeReportPage(-1)"></button>
                <button id="repNextBtn" onclick="changeReportPage(1)"></button>
            </div>
        </div>
    </div>
</div>

<!-- CREATE REPORT MODAL -->
<div id="createReportModal" class="fixed inset-0 bg-black/60 z-[90] hidden flex items-center justify-center opacity-0 transition-opacity duration-300">
    <div class="bg-white rounded-xl shadow-2xl w-[700px] max-w-[90%] transform scale-95 transition-transform duration-300 flex flex-col max-h-[90vh]" id="reportModalContent">
        
        <!-- Modal Header -->
        <div class="flex justify-between items-center p-6 border-b border-gray-100">
            <div>
                <h3 class="font-bold text-lg text-gray-900">Create New Report</h3>
                <p class="text-xs text-gray-500">Configure your report details and schedule.</p>
            </div>
            <button onclick="closeReportModal()" class="text-gray-400 hover:text-gray-700"><i class="ri-close-line text-2xl"></i></button>
        </div>

        <!-- Modal Body (Scrollable) -->
        <div class="p-6 overflow-y-auto flex-1">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <!-- Report Name -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-2">Report Name</label>
                    <input type="text" placeholder="e.g. November Sales Performance" class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary/20">
                </div>

                <!-- Report Type -->
                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-2">Report Type</label>
                    <select class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none bg-white">
                        <option>Keyword Performance</option>
                        <option>Transaction Report</option>
                        <option>Campaign Level SKU</option>
                        <option>Wallet History</option>
                    </select>
                </div>

                <!-- Campaign Select -->
                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-2">Select Campaign(s)</label>
                    <select class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none bg-white">
                        <option>All Campaigns</option>
                        <option>Summer Sale</option>
                        <option>Winter Collection</option>
                    </select>
                </div>

                <!-- Date Range -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-2">Time Period</label>
                    <div class="relative">
                        <input type="text" placeholder="Select Date Range" class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none pl-10">
                        <i class="ri-calendar-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <p class="text-[10px] text-gray-400 mt-1 italic">Timezone: Asia/Kolkata (+05:30)</p>
                </div>

                <!-- Divider -->
                <div class="col-span-2 h-px bg-gray-100 my-1"></div>

                <!-- Delivery Schedule -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-3">Report Delivery</label>
                    <div class="flex gap-6">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary" checked>
                            <span class="text-sm text-gray-700">Now (One-time)</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary">
                            <span class="text-sm text-gray-700">Daily</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary">
                            <span class="text-sm text-gray-700">Weekly</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary">
                            <span class="text-sm text-gray-700">Monthly</span>
                        </label>
                    </div>
                </div>

                <!-- Email Recipients -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-2">Email Recipients</label>
                    <input type="text" placeholder="Enter email addresses separated by comma" class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none">
                </div>
            </div>
        </div>

        <!-- Modal Footer -->
        <div class="p-5 border-t border-gray-100 flex justify-end gap-3 bg-gray-50 rounded-b-xl">
            <button onclick="closeReportModal()" class="px-5 py-2.5 text-sm font-bold text-gray-600 hover:bg-gray-200 rounded-lg transition">Cancel</button>
            <button onclick="closeReportModal()" class="px-6 py-2.5 text-sm font-bold text-white bg-primary hover:bg-primary-dark rounded-lg transition shadow-md flex items-center gap-2">
                <i class="ri-add-line text-lg"></i> Create Report
            </button>
        </div>
    </div>
</div>
<!-- CREATE REPORT MODAL -->
<div id="createReportModal" class="fixed inset-0 bg-black/60 z-[90] hidden flex items-center justify-center opacity-0 transition-opacity duration-300">
    <div class="bg-white rounded-xl shadow-2xl w-[700px] max-w-[90%] transform scale-95 transition-transform duration-300 flex flex-col max-h-[90vh]" id="reportModalContent">
        
        <!-- Modal Header -->
        <div class="flex justify-between items-center p-6 border-b border-gray-100">
            <div>
                <h3 class="font-bold text-lg text-gray-900">Create New Report</h3>
                <p class="text-xs text-gray-500">Configure your report details and schedule.</p>
            </div>
            <button onclick="closeReportModal()" class="text-gray-400 hover:text-gray-700"><i class="ri-close-line text-2xl"></i></button>
        </div>

        <!-- Modal Body (Scrollable) -->
        <div class="p-6 overflow-y-auto flex-1">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                
                <!-- Report Name -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-2">Report Name</label>
                    <input type="text" placeholder="e.g. November Sales Performance" class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary/20">
                </div>

                <!-- Report Type -->
                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-2">Report Type</label>
                    <select class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none bg-white">
                        <option>Keyword Performance</option>
                        <option>Transaction Report</option>
                        <option>Campaign Level SKU</option>
                        <option>Wallet History</option>
                    </select>
                </div>

                <!-- Campaign Select -->
                <div>
                    <label class="block text-xs font-bold text-gray-700 mb-2">Select Campaign(s)</label>
                    <select class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none bg-white">
                        <option>All Campaigns</option>
                        <option>Summer Sale</option>
                        <option>Winter Collection</option>
                    </select>
                </div>

                <!-- Date Range -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-2">Time Period</label>
                    <div class="relative">
                        <input type="text" placeholder="Select Date Range" class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none pl-10">
                        <i class="ri-calendar-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <p class="text-[10px] text-gray-400 mt-1 italic">Timezone: Asia/Kolkata (+05:30)</p>
                </div>

                <!-- Divider -->
                <div class="col-span-2 h-px bg-gray-100 my-1"></div>

                <!-- Delivery Schedule -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-3">Report Delivery</label>
                    <div class="flex gap-6">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary" checked>
                            <span class="text-sm text-gray-700">Now (One-time)</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary">
                            <span class="text-sm text-gray-700">Daily</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary">
                            <span class="text-sm text-gray-700">Weekly</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="delivery" class="text-primary focus:ring-primary">
                            <span class="text-sm text-gray-700">Monthly</span>
                        </label>
                    </div>
                </div>

                <!-- Email Recipients -->
                <div class="col-span-2">
                    <label class="block text-xs font-bold text-gray-700 mb-2">Email Recipients</label>
                    <input type="text" placeholder="Enter email addresses separated by comma" class="w-full border border-gray-200 rounded-lg px-4 py-2.5 text-sm focus:border-primary focus:outline-none">
                </div>
            </div>
        </div>

        <!-- Modal Footer -->
        <div class="p-5 border-t border-gray-100 flex justify-end gap-3 bg-gray-50 rounded-b-xl">
            <button onclick="closeReportModal()" class="px-5 py-2.5 text-sm font-bold text-gray-600 hover:bg-gray-200 rounded-lg transition">Cancel</button>
            <button onclick="closeReportModal()" class="px-6 py-2.5 text-sm font-bold text-white bg-primary hover:bg-primary-dark rounded-lg transition shadow-md flex items-center gap-2">
                <i class="ri-check-line"></i> Generate Report
            </button>
        </div>
    </div>
</div>
<!-- 8. SETTINGS PAGE (NEW MODULE) -->
<div id="page-settings" class="page-section hidden">
    
    <!-- Header -->
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-900">Settings</h1>
        <p class="text-xs text-gray-500 mt-1">Manage your account preferences, team members, and billing details.</p>
    </div>

    <!-- Main Layout: Fixed Height 750px -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-card h-[750px] flex overflow-hidden">
        
        <!-- LEFT SIDEBAR (Tabs) -->
        <div class="w-64 border-r border-gray-100 bg-gray-50/50 flex flex-col justify-between flex-shrink-0">
            <div class="p-4 space-y-1">
                <button onclick="switchSettingsTab('profile', this)" id="defaultOpenSetting" class="settings-tab active w-full text-left px-4 py-3 rounded-lg text-sm font-bold flex items-center gap-3 text-primary bg-purple-50 border border-purple-100 transition-all">
                    <i class="ri-user-settings-line text-lg"></i> My Profile
                </button>
                <button onclick="switchSettingsTab('team', this)" class="settings-tab w-full text-left px-4 py-3 rounded-lg text-sm font-medium flex items-center gap-3 text-gray-600 hover:bg-white hover:shadow-sm border border-transparent transition-all">
                    <i class="ri-group-line text-lg"></i> Team Members
                </button>
                <button onclick="switchSettingsTab('notifications', this)" class="settings-tab w-full text-left px-4 py-3 rounded-lg text-sm font-medium flex items-center gap-3 text-gray-600 hover:bg-white hover:shadow-sm border border-transparent transition-all">
                    <i class="ri-notification-badge-line text-lg"></i> Notifications
                </button>
                <button onclick="switchSettingsTab('billing', this)" class="settings-tab w-full text-left px-4 py-3 rounded-lg text-sm font-medium flex items-center gap-3 text-gray-600 hover:bg-white hover:shadow-sm border border-transparent transition-all">
                    <i class="ri-bill-line text-lg"></i> Billing & Tax
                </button>
            </div>

            <!-- Logout at Bottom of Sidebar -->
            <div class="p-4 border-t border-gray-200">
                <button onclick="logout()" class="w-full text-left px-4 py-3 rounded-lg text-sm font-bold flex items-center gap-3 text-red-600 hover:bg-red-50 transition-all">
                    <i class="ri-logout-box-line text-lg"></i> Log Out
                </button>
            </div>
        </div>

        <!-- RIGHT CONTENT AREA (Scrollable) -->
        <div class="flex-1 overflow-y-auto p-8 relative">
            
            <!-- TAB 1: MY PROFILE -->
            <div id="tab-profile" class="settings-content animate-fade-in">
                <h3 class="text-lg font-bold text-gray-900 mb-6 border-b border-gray-100 pb-2">Profile Details</h3>
                
                <div class="flex items-start gap-6 mb-8">
                    <div class="w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center text-3xl font-bold text-primary border-4 border-white shadow-sm">
                        AS
                    </div>
                    <div class="flex-1">
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-bold text-gray-600 mb-2">First Name</label>
                                <input type="text" value="Anuj" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary focus:outline-none bg-gray-50">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-gray-600 mb-2">Last Name</label>
                                <input type="text" value="Sharma" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary focus:outline-none bg-gray-50">
                            </div>
                            <div class="col-span-2">
                                <label class="block text-xs font-bold text-gray-600 mb-2">Email Address</label>
                                <input type="email" value="anuj.sharma@brand.com" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary focus:outline-none bg-gray-50" readonly>
                                <p class="text-[10px] text-gray-400 mt-1">Contact admin to change email.</p>
                            </div>
                        </div>
                        <div class="mt-6">
                            <button class="bg-primary text-white px-6 py-2 rounded-lg text-sm font-bold shadow-md hover:bg-primary-dark transition">Save Changes</button>
                        </div>
                    </div>
                </div>

                <h3 class="text-lg font-bold text-gray-900 mb-4 border-b border-gray-100 pb-2 mt-10">Security</h3>
                <div class="flex justify-between items-center bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div>
                        <p class="text-sm font-bold text-gray-800">Password</p>
                        <p class="text-xs text-gray-500">Last changed 3 months ago</p>
                    </div>
                    <button class="text-primary text-sm font-bold hover:underline">Change Password</button>
                </div>
            </div>

            <!-- TAB 2: TEAM MEMBERS -->
            <div id="tab-team" class="settings-content hidden animate-fade-in">
                <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-2">
                    <h3 class="text-lg font-bold text-gray-900">Team Members</h3>
                    <button class="bg-black text-white px-4 py-1.5 rounded-lg text-xs font-bold hover:bg-gray-800 transition"><i class="ri-add-line"></i> Invite Member</button>
                </div>

                <div class="space-y-3">
                    <!-- User 1 -->
                    <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-sm transition">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-primary font-bold text-xs">AS</div>
                            <div>
                                <p class="text-sm font-bold text-gray-900">Anuj Sharma (You)</p>
                                <p class="text-xs text-gray-500">anuj.sharma@brand.com</p>
                            </div>
                        </div>
                        <span class="bg-purple-50 text-primary border border-purple-100 px-2 py-1 rounded text-[10px] font-bold">Admin</span>
                    </div>
                    <!-- User 2 -->
                    <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:shadow-sm transition">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-600 font-bold text-xs">RK</div>
                            <div>
                                <p class="text-sm font-bold text-gray-900">Rahul Kumar</p>
                                <p class="text-xs text-gray-500">rahul.k@brand.com</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="bg-gray-100 text-gray-600 border border-gray-200 px-2 py-1 rounded text-[10px] font-bold">Editor</span>
                            <button class="text-gray-400 hover:text-red-500"><i class="ri-delete-bin-line"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: NOTIFICATIONS -->
            <div id="tab-notifications" class="settings-content hidden animate-fade-in">
                <h3 class="text-lg font-bold text-gray-900 mb-6 border-b border-gray-100 pb-2">Notification Preferences</h3>
                
                <div class="space-y-6">
                    <!-- Section 1 -->
                    <div>
                        <h4 class="text-sm font-bold text-gray-800 mb-3">Campaign Alerts</h4>
                        <div class="space-y-3">
                            <label class="flex items-center justify-between p-3 border border-gray-100 rounded-lg">
                                <span class="text-sm text-gray-600">Notify when campaign budget is 90% consumed</span>
                                <input type="checkbox" checked class="accent-primary w-4 h-4">
                            </label>
                            <label class="flex items-center justify-between p-3 border border-gray-100 rounded-lg">
                                <span class="text-sm text-gray-600">Notify when a campaign is paused automatically</span>
                                <input type="checkbox" checked class="accent-primary w-4 h-4">
                            </label>
                        </div>
                    </div>

                    <!-- Section 2 -->
                    <div>
                        <h4 class="text-sm font-bold text-gray-800 mb-3">Reports & Billing</h4>
                        <div class="space-y-3">
                            <label class="flex items-center justify-between p-3 border border-gray-100 rounded-lg">
                                <span class="text-sm text-gray-600">Receive Weekly Performance Report (Email)</span>
                                <input type="checkbox" checked class="accent-primary w-4 h-4">
                            </label>
                            <label class="flex items-center justify-between p-3 border border-gray-100 rounded-lg">
                                <span class="text-sm text-gray-600">Receive Invoice generated alert</span>
                                <input type="checkbox" class="accent-primary w-4 h-4">
                            </label>
                        </div>
                    </div>
                </div>
                <div class="mt-6">
                    <button class="bg-primary text-white px-6 py-2 rounded-lg text-sm font-bold shadow-md hover:bg-primary-dark transition">Save Preferences</button>
                </div>
            </div>

            <!-- TAB 4: BILLING -->
            <div id="tab-billing" class="settings-content hidden animate-fade-in">
                <h3 class="text-lg font-bold text-gray-900 mb-6 border-b border-gray-100 pb-2">Billing Information</h3>
                
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-gray-600 mb-2">Registered Company Name</label>
                        <input type="text" value="Faces Canada (Brand Entity)" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary bg-gray-50">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-600 mb-2">GSTIN Number</label>
                        <input type="text" value="27AABCU9603R1ZN" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary bg-gray-50">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-600 mb-2">PAN Number</label>
                        <input type="text" value="AABCU9603R" class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary bg-gray-50">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-gray-600 mb-2">Billing Address</label>
                        <textarea class="w-full border border-gray-200 rounded-lg px-4 py-2 text-sm focus:border-primary h-24">1204, Tower B, Business Park, Sector 45, Gurgaon, Haryana - 122003</textarea>
                    </div>
                </div>
                <button class="bg-primary text-white px-6 py-2 rounded-lg text-sm font-bold shadow-md hover:bg-primary-dark transition">Update Billing Info</button>
            </div>

        </div>
    </div>
</div>
<!-- ================= 4. AI DRAWER ================= -->
<div id="drawerOverlay" class="overlay fixed inset-0 bg-black/50 z-[60]" onclick="toggleAIDrawer()"></div>
<div id="aiDrawer" class="drawer fixed top-0 right-0 h-full w-80 bg-white shadow-2xl z-[70] border-l border-gray-200 flex flex-col">
    <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-secondary">
        <div class="flex items-center gap-3"><div class="w-8 h-8 rounded-full bg-white flex items-center justify-center text-primary shadow-sm border border-primary/20"><i class="ri-sparkling-2-fill"></i></div><div><h3 class="font-bold text-gray-900">Sofie AI</h3><p class="text-xs text-gray-500">29 Suggestions</p></div></div>
        <button onclick="toggleAIDrawer()" class="text-gray-400 hover:text-gray-700"><i class="ri-close-line text-xl"></i></button>
    </div>
    <div class="flex-1 overflow-y-auto p-4 space-y-4">
        <div class="group relative bg-white border border-primary/20 p-4 rounded-xl shadow-sm hover:shadow-md transition">
            <div class="icon-tooltip !top-auto bottom-full mb-1 !right-auto left-4 !-translate-x-1/2">AI-powered budget optimization</div>
            <span class="text-[10px] font-bold text-primary bg-secondary px-2 py-0.5 rounded border border-primary/10">Budget</span>
            <p class="text-sm font-bold text-gray-800 mt-2">Reallocate Budget</p>
            <p class="text-xs text-gray-500 mt-1">Move 2000 from 'Winter' to 'Summer'. ROI +15%.</p>
            <button class="mt-3 w-full bg-primary text-white text-xs font-bold py-2 rounded-lg hover:bg-primary-light">Apply</button>
        </div>
    </div>
</div>
  <!-- Logic -->
<!-- CREATE WALLET MODAL (Fixed & Design Matched) -->
<div id="createWalletModal" class="fixed inset-0 bg-black/60 z-[100] hidden flex items-center justify-center opacity-0 transition-opacity duration-300">
    <!-- Modal Content -->
    <div id="createWalletContent" class="bg-white rounded-lg shadow-2xl w-[500px] max-w-[90%] transform scale-95 transition-transform duration-300 overflow-hidden font-sans">
        
        <!-- Header -->
        <div class="flex justify-between items-center px-6 py-4 border-b border-gray-200 bg-gray-50">
            <h3 class="font-bold text-lg text-gray-800">Create Wallet</h3>
            <button onclick="closeCreateWalletModal()" class="text-gray-400 hover:text-gray-700 transition"><i class="ri-close-line text-2xl"></i></button>
        </div>

        <!-- Body -->
        <div class="p-6 space-y-5">
            
            <!-- 1. Wallet Name -->
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1">Wallet Name <span class="text-red-500">*</span></label>
                <div class="relative">
                    <input type="text" placeholder="Enter Wallet Name" class="w-full border border-gray-300 rounded px-3 py-2.5 text-sm text-gray-700 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary placeholder-gray-400">
                    <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 italic">0/50</span>
                </div>
            </div>

            <!-- 2. Campaign Type -->
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1">Campaign Type <span class="text-red-500">*</span></label>
                <div class="relative">
                    <select class="w-full border border-gray-300 rounded px-3 py-2.5 text-sm text-gray-700 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary bg-white appearance-none cursor-pointer">
                        <option value="" disabled selected class="text-gray-400">Select Campaign Type</option>
                        <option value="sponsored_products">Sponsored Product Ads</option>
                        <option value="sponsored_display">Sponsored Display Ads</option>
                        <option value="video_ads">Video Ads</option>
                    </select>
                    <!-- Custom Arrow Icon -->
                    <i class="ri-arrow-down-s-fill absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"></i>
                </div>
            </div>

            <!-- 3. Description -->
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1">Description</label>
                <div class="relative">
                    <textarea class="w-full border border-gray-300 rounded px-3 py-2 text-sm text-gray-700 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary h-24 resize-none"></textarea>
                    <span class="absolute right-3 bottom-2 text-xs text-gray-400 italic">0/200</span>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <div class="flex justify-end gap-3 px-6 py-4 border-t border-gray-100">
            <button onclick="closeCreateWalletModal()" class="px-6 py-2 text-sm font-bold text-primary border border-primary rounded hover:bg-purple-50 transition">Close</button>
            <button onclick="closeCreateWalletModal(); alert('New Wallet Created Successfully!');" class="px-6 py-2 text-sm font-bold text-white bg-primary rounded hover:bg-primary-dark shadow-md transition">
                Create Wallet
            </button>
        </div>
    </div>
</div>
    <script>
// ==========================================
    // 1. GLOBAL UI & DROPDOWN UTILITIES
    // ==========================================
// --- SIDEBAR ACCORDION LOGIC ---
    window.toggleSubmenu = function(id) {
        const submenu = document.getElementById(id);
        if(!submenu) return;
        
        // Find the arrow icon within the same container
        const parent = submenu.parentElement;
        const arrow = parent.querySelector('.arrow-rotate');

        if (submenu.classList.contains('open')) {
            // Close it
            submenu.classList.remove('open');
            submenu.style.maxHeight = '0px'; 
            submenu.style.opacity = '0';
            if(arrow) arrow.style.transform = 'rotate(0deg)';
        } else {
            // Open it
            submenu.classList.add('open');
            submenu.style.maxHeight = '200px'; 
            submenu.style.opacity = '1';
            if(arrow) arrow.style.transform = 'rotate(180deg)';
        }
    };    
function toggleId(id) {
        const el = document.getElementById(id);
        if(el) {
            if(el.classList.contains('dropdown-active')) { el.classList.remove('dropdown-active'); el.classList.add('dropdown-enter'); }
            else { closeAll(); el.classList.remove('dropdown-enter'); el.classList.add('dropdown-active'); }
        }
    }
    function closeAll() { document.querySelectorAll('.dropdown-active').forEach(d => { d.classList.remove('dropdown-active'); d.classList.add('dropdown-enter'); }); }
    window.onclick = function(e) { if(!e.target.closest('.dropdown-container')) { closeAll(); } }
// --- AI DRAWER LOGIC ---
    window.toggleAIDrawer = function() {
        const drawer = document.getElementById('aiDrawer');
        const overlay = document.getElementById('drawerOverlay');
        if(drawer && overlay) {
            drawer.classList.toggle('open');
            overlay.classList.toggle('open');
        }
    };
// --- AI DRAWER LOGIC ---
    window.toggleAIDrawer = function() {
        const drawer = document.getElementById('aiDrawer');
        const overlay = document.getElementById('drawerOverlay');
        if(drawer && overlay) {
            drawer.classList.toggle('open');
            overlay.classList.toggle('open');
        }
    };

    // ==========================================
    // 2. PERFECT CALENDAR LOGIC (Global Scope)
    // ==========================================
    const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    let currentDate = new Date(2025, 10, 26);
    let currentMonth = currentDate.getMonth();
    let currentYear = currentDate.getFullYear();

    // Renders the days, month list, or year list based on the target (Main or History)
    function renderCalendar(instance = "") {
        const suffix = instance ? `_${instance}` : "";
        const calendarGrid = document.getElementById('calendarGrid' + suffix);
        const monthLabel = document.getElementById('calMonthLabel' + suffix);
        const yearLabel = document.getElementById('calYearLabel' + suffix);
        
        if (!calendarGrid || !monthLabel || !yearLabel) return;
        
        monthLabel.innerText = months[currentMonth];
        yearLabel.innerText = currentYear;
        calendarGrid.innerHTML = '';
        
        const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
        const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
        
        for (let i = 0; i < firstDayOfMonth; i++) { calendarGrid.innerHTML += '<div></div>'; }
        for (let i = 1; i <= daysInMonth; i++) {
            let classes = 'py-1 hover:bg-gray-100 rounded cursor-pointer';
            // Highlight logic for demo (20-26 Nov 2025)
            if (i === 20 && currentMonth === 10 && currentYear === 2025) classes = 'py-1 bg-purple-100 text-primary rounded-l-md font-bold';
            if (i > 20 && i < 26 && currentMonth === 10 && currentYear === 2025) classes = 'py-1 bg-purple-100 text-primary font-bold';
            if (i === 26 && currentMonth === 10 && currentYear === 2025) classes = 'py-1 bg-primary text-white rounded-r-md font-bold';
            calendarGrid.innerHTML += `<div class="${classes}">${i}</div>`;
        }
    }

    function renderMonthList(instance = "") {
        const suffix = instance ? `_${instance}` : "";
        const monthList = document.getElementById('monthList' + suffix);
        if (!monthList) return;
        monthList.innerHTML = '';
        months.forEach((month, index) => {
            const button = document.createElement('button');
            button.onclick = () => setMonth(index, instance);
            button.className = `hover:bg-purple-50 hover:text-primary rounded text-xs py-2 ${index === currentMonth ? 'bg-primary text-white font-bold' : ''}`;
            button.innerText = month.substring(0,3);
            monthList.appendChild(button);
        });
    }

    function renderYearList(instance = "") {
        const suffix = instance ? `_${instance}` : "";
        const yearList = document.getElementById('yearList' + suffix);
        if (!yearList) return;
        yearList.innerHTML = '';
        for (let i = currentYear + 5; i >= currentYear - 5; i--) {
            const button = document.createElement('button');
            button.onclick = () => setYear(i, instance);
            button.className = `py-2 hover:bg-gray-100 rounded text-xs text-gray-600 ${i === currentYear ? 'bg-purple-50 text-primary font-bold' : ''}`;
            button.innerText = i;
            yearList.appendChild(button);
        }
    }

    function switchCalView(view, instance = "") {
        const suffix = instance ? `_${instance}` : "";
        // Hide all views for this specific instance
        const containerId = instance ? 'historyDateDropdown' : 'dateDropdown';
        const container = document.getElementById(containerId);
        if(container) {
            container.querySelectorAll('.cal-view').forEach(v => v.classList.remove('active'));
        }
        // Show selected view
        const viewEl = document.getElementById('view' + view.charAt(0).toUpperCase() + view.slice(1) + suffix);
        if(viewEl) viewEl.classList.add('active');
    }

    // Helper functions to change dates and re-render
    function setMonth(idx, instance) { currentMonth = idx; renderAllCalendars(); switchCalView('days', instance); }
    function setYear(y, instance) { currentYear = y; renderAllCalendars(); switchCalView('days', instance); }
    function calPrev() { currentMonth--; if (currentMonth < 0) { currentMonth = 11; currentYear--; } renderAllCalendars(); }
    function calNext() { currentMonth++; if (currentMonth > 11) { currentMonth = 0; currentYear++; } renderAllCalendars(); }
    
    // Renders BOTH the main header calendar and the history calendar
    function renderAllCalendars() { 
        renderCalendar(); renderMonthList(); renderYearList(); // Main
        renderCalendar('hist'); renderMonthList('hist'); renderYearList('hist'); // History
    }
// --- BALANCE & MANAGE LOGIC (New) ---

window.switchBalanceTab = function(tabId, btn) {
    // Hide all tabs
    document.querySelectorAll('.balance-tab-content').forEach(el => el.classList.add('hidden'));
    const target = document.getElementById(tabId);
    if(target) target.classList.remove('hidden');
    
    // Reset buttons
    const navButtons = document.getElementById('balanceTabs').querySelectorAll('button');
    navButtons.forEach(b => {
        b.className = "pb-3 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-xs flex items-center gap-2 transition";
    });

    // Highlight active
    btn.className = "pb-3 border-b-2 border-primary text-primary font-bold text-xs flex items-center gap-2";
};

window.selectGlobalWallet = function(name, balance) {
    const lbl = document.getElementById('selectedWalletLabel');
    const bal = document.getElementById('selectedWalletBalance');
    const kpi = document.getElementById('kpiRealBalance');
    
    if(lbl) lbl.innerText = name;
    if(bal) bal.innerText = balance;
    if(kpi) kpi.innerText = balance; 
    
    window.closeAll(); 
};

window.openCreateWalletModal = function() {
    window.closeAll(); 
    const modal = document.getElementById('createWalletModal');
    const content = document.getElementById('createWalletContent');
    if(modal) {
        modal.classList.remove('opacity-0', 'pointer-events-none');
        content.classList.remove('scale-95');
        content.classList.add('scale-100');
    }
};

window.closeCreateWalletModal = function() {
    const modal = document.getElementById('createWalletModal');
    const content = document.getElementById('createWalletContent');
    if(modal) {
        modal.classList.add('opacity-0', 'pointer-events-none');
        content.classList.add('scale-95');
        content.classList.remove('scale-100');
    }
};
        document.addEventListener('DOMContentLoaded', () => {
renderAllCalendars();
            console.log("Initializing Command Center...");

            // ==========================================
            // A. GLOBAL DASHBOARD INITIALIZATION
            // ==========================================
           

  // 2. Render Transactions (Full Data & Pagination) - FIXED
            const allTransactions = [
                { date: "28 Nov 2025", time: "06:53 PM", id: "01KB5A3M4...", wallet: "Default", type: "Promotional", amount: "5,00,000", status: "Successful" },
                { date: "31 Jul 2025", time: "09:02 PM", id: "01K1GHTQ8...", wallet: "PDA", type: "Promotional", amount: "20,00,000", status: "Successful" },
                { date: "09 Jul 2025", time: "09:17 PM", id: "01JZQXXC2...", wallet: "Default", type: "Promotional", amount: "7,43,000", status: "Successful" },
                { date: "09 Jul 2025", time: "09:14 PM", id: "01JZQXRP4...", wallet: "Default", type: "Refund", amount: "-7,43,000", status: "Successful" },
                { date: "09 Jul 2025", time: "09:07 PM", id: "01JZQXC5N...", wallet: "Default", type: "Promotional", amount: "7,43,000", status: "Successful" },
                { date: "28 May 2025", time: "05:06 PM", id: "01JWBAVYB...", wallet: "Awareness", type: "Refund", amount: "-1,00,00,000", status: "Successful" },
                { date: "28 May 2025", time: "04:31 PM", id: "01JWB8WMN...", wallet: "Awareness", type: "Prepaid", amount: "1,00,00,000", status: "Successful" },
                { date: "28 May 2025", time: "04:31 PM", id: "01JWB8WKV...", wallet: "Performance", type: "Prepaid", amount: "1,00,00,000", status: "Successful" },
                { date: "15 May 2025", time: "10:00 AM", id: "01JWA9XYZ...", wallet: "Default", type: "Promotional", amount: "2,50,000", status: "Successful" },
                { date: "10 May 2025", time: "11:30 AM", id: "01JWA8ABC...", wallet: "PDA", type: "Prepaid", amount: "50,00,000", status: "Successful" },
                { date: "05 May 2025", time: "02:15 PM", id: "01JWA7DEF...", wallet: "Default", type: "Refund", amount: "-1,20,000", status: "Successful" },
                { date: "01 May 2025", time: "09:45 AM", id: "01JWA6GHI...", wallet: "Performance", type: "Prepaid", amount: "75,00,000", status: "Successful" },
                { date: "25 Apr 2025", time: "04:20 PM", id: "01JWA5JKL...", wallet: "Awareness", type: "Prepaid", amount: "25,00,000", status: "Successful" },
                { date: "20 Apr 2025", time: "01:10 PM", id: "01JWA4MNO...", wallet: "Default", type: "Promotional", amount: "10,00,000", status: "Successful" }
            ];
            
            let currentPage = 1; 
            const itemsPerPage = 10;
            
            window.renderTransactions = function() {
                const tableBody = document.querySelector('#transactionTable tbody');
                if(!tableBody) return;
                
                const start = (currentPage - 1) * itemsPerPage;
                const end = start + itemsPerPage;
                const pageData = allTransactions.slice(start, end);
                
                // 1. Render Rows
                let bodyHTML = '';
                pageData.forEach(item => {
                    let color = item.amount.includes('-') ? 'text-red-600' : 'text-gray-900';
                    let walletColor = item.wallet === 'Default' ? 'bg-gray-100 text-gray-600' : (item.wallet === 'PDA' ? 'bg-purple-50 text-primary' : 'bg-primary-50 text-primary-600');
                    
                    bodyHTML += `
                        <tr class="hover:bg-gray-50 transition border-b border-gray-100">
                            <td class="px-6 py-4"><div class="font-bold text-gray-900">${item.date}</div><div class="text-xs text-gray-400">${item.time}</div></td>
                            <td class="px-6 py-4"><div class="font-mono text-xs text-gray-500">${item.id}</div></td>
                            <td class="px-6 py-4"><span class="${walletColor} px-2 py-1 rounded text-xs font-bold border border-gray-200">${item.wallet}</span></td>
                            <td class="px-6 py-4 text-sm text-gray-700">${item.type}</td>
                            <td class="px-6 py-4"><span class="font-bold ${color}">${item.amount}</span></td>
                            <td class="px-6 py-4"><span class="bg-green-50 text-green-700 px-2 py-1 rounded-full text-xs font-bold border border-green-100">${item.status}</span></td>
                        </tr>`;
                });
                tableBody.innerHTML = bodyHTML;
                
                // 2. Pagination Info
                const info = document.getElementById('paginationInfo');
                if(info) info.innerHTML = `Showing <span class="font-bold">${start + 1}-${Math.min(end, allTransactions.length)}</span> of <span class="font-bold">${allTransactions.length}</span> transactions`;
                
                // 3. Update Buttons (Visibility & Text)
                const btnPrev = document.getElementById('btnPrev');
                const btnNext = document.getElementById('btnNext');
                
                if(btnPrev) {
                    // This adds the missing text and icon
                    btnPrev.innerHTML = `<i class="ri-arrow-left-s-line"></i> Previous`;
                    btnPrev.className = `flex items-center gap-1 px-3 py-1 rounded text-xs font-bold transition ${currentPage === 1 ? 'text-gray-300 cursor-not-allowed' : 'text-gray-600 hover:bg-gray-100 hover:text-primary cursor-pointer'}`;
                    btnPrev.disabled = currentPage === 1;
                }
                if(btnNext) {
                    // This adds the missing text and icon
                    btnNext.innerHTML = `Next <i class="ri-arrow-right-s-line"></i>`;
                    btnNext.className = `flex items-center gap-1 px-3 py-1 rounded text-xs font-bold transition ${end >= allTransactions.length ? 'text-gray-300 cursor-not-allowed' : 'text-gray-600 hover:bg-gray-100 hover:text-primary cursor-pointer'}`;
                    btnNext.disabled = end >= allTransactions.length;
                }
            };

            // 4. The Missing Pagination Function
            window.changePage = function(direction) {
                const totalPages = Math.ceil(allTransactions.length / itemsPerPage);
                if (direction === -1 && currentPage > 1) currentPage--;
                if (direction === 1 && currentPage < totalPages) currentPage++;
                window.renderTransactions();
            };

            window.renderTransactions(); // Init

            // ==========================================
            // B. CAMPAIGN WIZARD LOGIC (REPLACED FROM CODE 2)
            // ==========================================

            // --- GLOBAL NAVIGATION & STATE ---
            let currentStep = 1;
            const stepper = document.getElementById('stepper');
            const steps = document.querySelectorAll('.step-content');
            const backBtn = document.getElementById('back-btn');
            const nextBtn = document.getElementById('next-btn');
            
            // To ensure logic runs only once per step
            const initializedSteps = [false, false, false, false];

            window.goToStep = function(stepNumber) {
                currentStep = stepNumber;
                
                // Update Stepper UI
                stepper.querySelectorAll('.cc-step').forEach(stepEl => {
                    stepEl.classList.toggle('active', parseInt(stepEl.dataset.step) === currentStep);
                });

                // Update Content
                steps.forEach(stepContent => {
                    stepContent.classList.toggle('active', parseInt(stepContent.id.split('-')[1]) === currentStep);
                });

                // Update Footer Buttons
                if (backBtn) backBtn.style.display = currentStep > 1 ? 'inline-block' : 'none';
                if (nextBtn) nextBtn.textContent = currentStep === 4 ? 'Submit for Approval' : 'Next';

                // Footer Alignment
                const footer = document.querySelector('.cc-footer');
                if (footer) {
                    if (currentStep === 1) {
                         if(backBtn) backBtn.style.display = 'none';
                         footer.style.justifyContent = 'flex-end';
                    } else {
                         footer.style.justifyContent = 'space-between';
                    }
                }

                // Initialize Step Logic (Lazy Load)
                if (!initializedSteps[currentStep - 1]) {
                    if(currentStep === 1) initializeStep1();
                    if(currentStep === 2) initializeStep2();
                    if(currentStep === 3) initializeStep3();
                    if(currentStep === 4) initializeStep4();
                    initializedSteps[currentStep - 1] = true;
                }
            };

            // --- GLOBAL NAVIGATION & VALIDATION ---
            
            // Helper: Show Error Toast
            function showWizardError(msg) {
                let toast = document.getElementById('wizard-error-toast');
                if (!toast) {
                    toast = document.createElement('div');
                    toast.id = 'wizard-error-toast';
                    toast.className = 'error-toast';
                    document.body.appendChild(toast);
                }
                toast.innerHTML = `<i class="ri-error-warning-fill" style="color:#f87171; font-size:20px;"></i> ${msg}`;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            }

            // Next Button Logic
            if(nextBtn) nextBtn.addEventListener('click', () => {
                // STEP 1 VALIDATION
                if (currentStep === 1) {
                    const isVisibilityCampaign = window.currentCampaignType === 'visibility';
                    
                    // Check 1: Is a Page Selected?
                    const selectedPage = document.querySelector('.page-card.selected');
                    if (!selectedPage) {
                        showWizardError("Please select a Page to proceed");
                        return; 
                    }

                    // Check 2: Is a Placement Selected?
                    const summaryCountLabel = document.getElementById('summary-count');
                    const countText = summaryCountLabel ? summaryCountLabel.innerText : "0";
                    const count = parseInt(countText) || 0;
                    
                    if (count === 0) {
                        showWizardError("Please select a Placement");
                        return; 
                    }
                    
                    // For Visibility campaigns: Must have exactly ONE placement
                    if (isVisibilityCampaign && count !== 1) {
                        showWizardError("Visibility campaigns can only have ONE placement. Please deselect other placements.");
                        return;
                    }
                }
                
                // STEP 3 VALIDATION
                else if (currentStep === 3) {
                    // Check if there are any ads uploaded (counting the cards)
                    const ads = document.querySelectorAll('.ad-card');
                    if (ads.length === 0) {
                        showWizardError("Please upload an Image");
                        return;
                    }
                }
                
                // STEP 4 VALIDATION (on Submit)
                else if (currentStep === 4) {
                    const campaignNameInput = document.getElementById('campaign-name');
                    const campaignNameError = document.getElementById('campaign-name-error');
                    
                    if (!campaignNameInput || !campaignNameInput.value.trim()) {
                        showWizardError("Please enter a Campaign Name");
                        if (campaignNameError) {
                            campaignNameError.classList.remove('hidden');
                            campaignNameError.style.display = 'flex';
                        }
                        if (campaignNameInput) {
                            campaignNameInput.style.borderColor = '#dc2626';
                            campaignNameInput.focus();
                        }
                        return;
                    } else {
                        if (campaignNameError) {
                            campaignNameError.classList.add('hidden');
                            campaignNameError.style.display = 'none';
                        }
                        if (campaignNameInput) {
                            campaignNameInput.style.borderColor = '';
                        }
                    }
                }

                // Move to Next Step
                if (currentStep < 4) {
                    window.goToStep(currentStep + 1);
                } else {
                    alert('Campaign Submitted for Approval!');
                    window.navigateTo('overview', 'nav-overview', 'Home');
                }
            });

            // Back Button Logic
            if(backBtn) backBtn.addEventListener('click', () => {
                if (currentStep > 1) {
                    window.goToStep(currentStep - 1);
                }
            });
            
            // --- STEP 1: INVENTORY LOGIC (Simplified - No Slots) ---
            function initializeStep1() {
                // Initialize campaign type if not set (default to visibility for create-campaign route)
                if (!window.currentCampaignType) {
                    window.currentCampaignType = 'visibility';
                }
                
                // 1. Data Structure: Pages -> Placements (No Slots)
                const db = {
                    pages: [
                        { id: 'home_27659', name: 'Home Page', pageId: 27659, pageType: 'home', icon: 'fa-solid fa-house' },
                        { id: 'l1_brand_41762', name: 'L1 Brand Page', pageId: 41762, pageType: 'l1', icon: 'fa-solid fa-tag' },
                        { id: 'l1_bath_21868', name: 'L1 Page Bath & Body', pageId: 21868, pageType: 'l1', icon: 'fa-solid fa-bath' },
                        { id: 'l1_combo_41682', name: 'L1 Page Combo', pageId: 41682, pageType: 'l1', icon: 'fa-solid fa-boxes-stacked' },
                        { id: 'l1_feminine_41520', name: 'L1 Page Feminine Hygiene', pageId: 41520, pageType: 'l1', icon: 'fa-solid fa-heart' },
                        { id: 'l1_fragrance_21032', name: 'L1 Page Fragrance', pageId: 21032, pageType: 'l1', icon: 'fa-solid fa-spray-can-sparkles' },
                        { id: 'l1_haircare_41626', name: 'L1 Page Haircare', pageId: 41626, pageType: 'l1', icon: 'fa-solid fa-scissors' },
                        { id: 'l1_makeup_41624', name: 'L1 Page Makeup', pageId: 41624, pageType: 'l1', icon: 'fa-solid fa-palette' },
                        { id: 'l1_skin_41622', name: 'L1 Page Skin', pageId: 41622, pageType: 'l1', icon: 'fa-solid fa-droplet' },
                        { id: 'l1_shopmore_41767', name: 'L1 Shop More', pageId: 41767, pageType: 'l1', icon: 'fa-solid fa-cart-shopping' },
                        { id: 'thankyou', name: 'Thank You Page', pageId: null, pageType: 'thankyou', icon: 'fa-solid fa-circle-check' }
                    ],
                    // Placements per Page (No Slots - Direct Selection)
                    placements: {
                        'home_27659': [
                            { id: 'home_top_carousel', name: 'Top Carousel (auto-rotate)', featureId: '5001', impressions: '10,833,193' },
                            { id: 'home_ca1_a', name: 'Celebrity Area 1A', featureId: 'NA', impressions: '337,886' },
                            { id: 'home_ca1_b', name: 'Celebrity Area 1B', featureId: 'NA', impressions: '337,834' },
                            { id: 'home_ca2_a', name: 'Celebrity Area 2A', featureId: 'NA', impressions: '162,277' },
                            { id: 'home_ca2_b', name: 'Celebrity Area 2B', featureId: 'NA', impressions: '162,062' },
                            { id: 'home_ca3_a', name: 'Celebrity Area 3A', featureId: 'NA', impressions: '88,494' },
                            { id: 'home_ca3_b', name: 'Celebrity Area 3B', featureId: 'NA', impressions: '88,482' }
                        ],
                        'l1_brand_41762': [
                            { id: 'l1brand_brands_focus', name: 'Brands in Focus', featureId: '5003', impressions: '176,830' },
                            { id: 'l1brand_curated', name: 'Curated Brands', featureId: '5005', impressions: '118,492' },
                            { id: 'l1brand_cover', name: 'Cover Widget', featureId: 'NA', impressions: 'NA' },
                            { id: 'l1brand_scroll', name: 'Cover Widget Scroll Chips', featureId: 'NA', impressions: 'NA' }
                        ],
                        'l1_bath_21868': [
                            { id: 'l1bath_spotlight', name: 'Brand Spotlight', featureId: '20086', impressions: '9,433' },
                            { id: 'l1bath_cover', name: 'Cover Widget', featureId: '6010', impressions: '18,466' },
                            { id: 'l1bath_scroll', name: 'Cover Widget Scroll Chips', featureId: '6012', impressions: '79,276' },
                            { id: 'l1bath_offer1', name: 'Offer Zone 1', featureId: '20084', impressions: '20,722' },
                            { id: 'l1bath_offer2', name: 'Offer Zone 2', featureId: '20085', impressions: '20,423' },
                            { id: 'l1bath_brands', name: 'Shop by Brands', featureId: '20086', impressions: '9,775' }
                        ],
                        'l1_combo_41682': [
                            { id: 'l1combo_brandscroll', name: 'Brand Scroll', featureId: '6032', impressions: '48,132' },
                            { id: 'l1combo_cover', name: 'Cover Widget', featureId: '6001', impressions: '37,440' },
                            { id: 'l1combo_scroll', name: 'Cover Widget Scroll Chips', featureId: '6003', impressions: '159,987' }
                        ],
                        'l1_feminine_41520': [
                            { id: 'l1fem_cover', name: 'Cover Widget', featureId: '6001', impressions: '16,509' },
                            { id: 'l1fem_scroll', name: 'Cover Widget Scroll Chips', featureId: '6003', impressions: '37,752' },
                            { id: 'l1fem_offer1', name: 'Offer Zone 1', featureId: '20057', impressions: '20,525' },
                            { id: 'l1fem_offer2', name: 'Offer Zone 2', featureId: '20058', impressions: '20,741' },
                            { id: 'l1fem_chips', name: 'Scroll Chips', featureId: '6003', impressions: '33,268' }
                        ],
                        'l1_fragrance_21032': [
                            { id: 'l1frag_cover', name: 'Cover Widget', featureId: '6001', impressions: '13,804' },
                            { id: 'l1frag_scroll', name: 'Cover Widget Scroll Chips', featureId: '6003', impressions: '59,498' },
                            { id: 'l1frag_offer1', name: 'Offer Zone 1', featureId: '20059', impressions: '41,323' },
                            { id: 'l1frag_offer2', name: 'Offer Zone 2', featureId: '20060', impressions: 'NA' }
                        ],
                        'l1_haircare_41626': [
                            { id: 'l1hair_spotlight', name: 'Brand Spotlight', featureId: '20163', impressions: '39,205' },
                            { id: 'l1hair_cover', name: 'Cover Widget', featureId: '6001', impressions: '53,085' },
                            { id: 'l1hair_scroll', name: 'Cover Widget Scroll Chips', featureId: '6003', impressions: '226,426' },
                            { id: 'l1hair_offer1', name: 'Offer Zone 1', featureId: '20161', impressions: '39,277' },
                            { id: 'l1hair_offer2', name: 'Offer Zone 2', featureId: '20166', impressions: '62,471' },
                            { id: 'l1hair_brands', name: 'Shop by Brands', featureId: '20163', impressions: '32,257' }
                        ],
                        'l1_makeup_41624': [
                            { id: 'l1makeup_spotlight', name: 'Brand Spotlight', featureId: '20157', impressions: '49,836' },
                            { id: 'l1makeup_cover', name: 'Cover Widget', featureId: '6005', impressions: '77,736' },
                            { id: 'l1makeup_scroll', name: 'Cover Widget Scroll Chips', featureId: '6003', impressions: '334,582' },
                            { id: 'l1makeup_offer1', name: 'Offer Zone 1', featureId: '20159', impressions: '74,712' },
                            { id: 'l1makeup_offer2', name: 'Offer Zone 2', featureId: '20160', impressions: '71,012' },
                            { id: 'l1makeup_brands', name: 'Shop by Brands', featureId: '20157', impressions: '40,745' }
                        ],
                        'l1_skin_41622': [
                            { id: 'l1skin_cover', name: 'Cover Widget', featureId: 'NA', impressions: '213,815' },
                            { id: 'l1skin_scroll', name: 'Cover Widget Scroll Chips', featureId: 'NA', impressions: '469,451' },
                            { id: 'l1skin_chips', name: 'Scroll Chips', featureId: 'NA', impressions: '100,343' },
                            { id: 'l1skin_brands', name: 'Shop by Brands', featureId: 'NA', impressions: '87,739' },
                            { id: 'l1skin_offer1', name: 'Offer Zone 1', featureId: 'NA', impressions: 'NA' },
                            { id: 'l1skin_offer2', name: 'Offer Zone 2', featureId: 'NA', impressions: 'NA' },
                            { id: 'l1skin_focus', name: 'Brands in Focus', featureId: 'NA', impressions: 'NA' }
                        ],
                        'l1_shopmore_41767': [
                            { id: 'l1more_cover', name: 'Cover Widget', featureId: '6001', impressions: '11,149' },
                            { id: 'l1more_scroll', name: 'Scroll Chips', featureId: '6010', impressions: '1,264,508' },
                            { id: 'l1more_coverscroll', name: 'Cover Widget Scroll Chips', featureId: 'NA', impressions: 'NA' },
                            { id: 'l1more_offer1', name: 'Offer Zone 1', featureId: 'NA', impressions: 'NA' },
                            { id: 'l1more_offer2', name: 'Offer Zone 2', featureId: 'NA', impressions: 'NA' },
                            { id: 'l1more_focus', name: 'Brands in Focus', featureId: 'NA', impressions: 'NA' }
                        ],
                        'l2_categories': [
                            { id: 'l2_bbcc', name: 'BB & CC Cream - Banner', featureId: '1001', impressions: 'NA', categoryId: 385 },
                            { id: 'l2_blush', name: 'Blush - Banner', featureId: '1001', impressions: 'NA', categoryId: 72 },
                            { id: 'l2_bodyoil', name: 'Body & Massage Oil - Banner', featureId: '1001', impressions: 'NA', categoryId: 41 },
                            { id: 'l2_bodycream', name: 'Body Cream & Body Butter - Banner', featureId: '1001', impressions: '23,986', categoryId: 189 },
                            { id: 'l2_bodylotion', name: 'Body Lotion & Moisturizer - Banner', featureId: '1001', impressions: '26,647', categoryId: 39 },
                            { id: 'l2_bodymist', name: 'Body Mist & Spray for Women - Banner', featureId: '1001', impressions: 'NA', categoryId: 182 },
                            { id: 'l2_bodyrazor', name: 'Body Razor & Cartridge - Banner', featureId: '1001', impressions: '23,986', categoryId: 483 },
                            { id: 'l2_bodyscrub', name: 'Body Scrub Polish & Exfoliant - Banner', featureId: '1001', impressions: 'NA', categoryId: 37 },
                            { id: 'l2_bodywash', name: 'Body Wash & Shower Gel - Banner', featureId: '1001', impressions: '12,842', categoryId: 36 },
                            { id: 'l2_compact', name: 'Compact - Banner', featureId: '1001', impressions: 'NA', categoryId: 66 },
                            { id: 'l2_concealer', name: 'Concealer and Colour Corrector - Banner', featureId: '1001', impressions: 'NA', categoryId: 65 },
                            { id: 'l2_conditioner', name: 'Conditioner - Banner', featureId: '1001', impressions: 'NA', categoryId: 26 },
                            { id: 'l2_deomen', name: 'Deodorant & Roll-On for Men - Banner', featureId: '1001', impressions: 'NA', categoryId: 59 },
                            { id: 'l2_deowomen', name: 'Deodorant & Roll-On for Women - Banner', featureId: '1001', impressions: '26,647', categoryId: 40 },
                            { id: 'l2_essential', name: 'Essential Oil - Banner', featureId: '1001', impressions: '885', categoryId: 295 },
                            { id: 'l2_eyebrow', name: 'Eyebrow Enhancer - Banner', featureId: '1001', impressions: 'NA', categoryId: 297 },
                            { id: 'l2_eyeliner', name: 'Eyeliner - Banner', featureId: '1001', impressions: 'NA', categoryId: 67 },
                            { id: 'l2_eyeshadow', name: 'Eyeshadow - Banner', featureId: '1001', impressions: 'NA', categoryId: 73 },
                            { id: 'l2_facemask', name: 'Face Mask - Banner', featureId: '1001', impressions: '6,360', categoryId: 7 },
                            { id: 'l2_facewash', name: 'Face Wash - Banner', featureId: '1001', impressions: '18,805', categoryId: 2 },
                            { id: 'l2_footcare', name: 'Foot Care - Banner', featureId: '1001', impressions: 'NA', categoryId: 42 },
                            { id: 'l2_foundation', name: 'Foundation - Banner', featureId: '1001', impressions: '26,647', categoryId: 64 },
                            { id: 'l2_fragkit', name: 'Fragrance Kit - Banner', featureId: '1001', impressions: 'NA', categoryId: 459 },
                            { id: 'l2_hairkit', name: 'Hair Care Kit - Banner', featureId: '1001', impressions: 'NA', categoryId: 453 },
                            { id: 'l2_haircolour', name: 'Hair Colour - Banner', featureId: '1001', impressions: 'NA', categoryId: 28 },
                            { id: 'l2_hairmask', name: 'Hair Mask - Banner', featureId: '1001', impressions: 'NA', categoryId: 216 },
                            { id: 'l2_hairoil', name: 'Hair Oil - Banner', featureId: '1001', impressions: 'NA', categoryId: 29 },
                            { id: 'l2_hairremoval', name: 'Hair Removal Cream & Powder - Banner', featureId: '1001', impressions: 'NA', categoryId: 541 },
                            { id: 'l2_hairserum', name: 'Hair Serum - Banner', featureId: '1001', impressions: '12,842', categoryId: 215 },
                            { id: 'l2_hairspray', name: 'Hair Spray - Banner', featureId: '1001', impressions: '26,647', categoryId: 217 },
                            { id: 'l2_handcream', name: 'Hand Cream & Mask - Banner', featureId: '1001', impressions: 'NA', categoryId: 413 },
                            { id: 'l2_highlighter', name: 'Highlighter & Illuminator - Banner', featureId: '1001', impressions: '12,842', categoryId: 76 },
                            { id: 'l2_intimate', name: 'Intimate Care - Banner', featureId: '1001', impressions: 'NA', categoryId: 257 },
                            { id: 'l2_kajal', name: 'Kajal - Banner', featureId: '1001', impressions: 'NA', categoryId: 77 },
                            { id: 'l2_lipbalm', name: 'Lip Balm - Banner', featureId: '1001', impressions: '15,102', categoryId: 412 },
                            { id: 'l2_lipgloss', name: 'Lip Gloss - Banner', featureId: '1001', impressions: 'NA', categoryId: 69 },
                            { id: 'l2_lipstick', name: 'Lipstick - Banner', featureId: '1001', impressions: '23,986', categoryId: 70 },
                            { id: 'l2_loosepowder', name: 'Loose Powder - Banner', featureId: '1001', impressions: 'NA', categoryId: 386 },
                            { id: 'l2_makeupkit', name: 'Makeup Kit - Banner', featureId: '1001', impressions: 'NA', categoryId: 21 },
                            { id: 'l2_makeupremover', name: 'Makeup Remover - Banner', featureId: '1001', impressions: 'NA', categoryId: 24 },
                            { id: 'l2_manicure', name: 'Manicure & Pedicure Kit - Banner', featureId: '1001', impressions: 'NA', categoryId: 132 },
                            { id: 'l2_mascara', name: 'Mascara - Banner', featureId: '1001', impressions: 'NA', categoryId: 68 },
                            { id: 'l2_menstrual', name: 'Menstrual Care - Banner', featureId: '1001', impressions: '26,647', categoryId: 439 },
                            { id: 'l2_moisturizer', name: 'Moisturizer - Banner', featureId: '1001', impressions: '12,842', categoryId: 169 },
                            { id: 'l2_nailpolish', name: 'Nail Polish - Banner', featureId: '1001', impressions: 'NA', categoryId: 71 },
                            { id: 'l2_nightcream', name: 'Night Cream - Banner', featureId: '1001', impressions: '7,625', categoryId: 6 },
                            { id: 'l2_serum', name: 'Serum - Banner', featureId: '1001', impressions: '23,986', categoryId: 10 },
                            { id: 'l2_perfumemen', name: 'Perfume for Men - Banner', featureId: '1001', impressions: '23,986', categoryId: 50 },
                            { id: 'l2_perfumewomen', name: 'Perfume for Women - Banner', featureId: '1001', impressions: '12,842', categoryId: 51 },
                            { id: 'l2_primer', name: 'Primer - Banner', featureId: '1001', impressions: 'NA', categoryId: 296 },
                            { id: 'l2_settingspray', name: 'Setting spray powder & fixer - Banner', featureId: '1001', impressions: 'NA', categoryId: 387 },
                            { id: 'l2_shampoo', name: 'Shampoo - Banner', featureId: '1001', impressions: '23,986', categoryId: 27 },
                            { id: 'l2_skinkit', name: 'Skincare Kit - Banner', featureId: '1001', impressions: '1,731', categoryId: 446 },
                            { id: 'l2_soap', name: 'Soap - Banner', featureId: '1001', impressions: 'NA', categoryId: 35 },
                            { id: 'l2_sunscreen', name: 'Sunscreen - Banner', featureId: '1001', impressions: '26,647', categoryId: 13 },
                            { id: 'l2_toner', name: 'Toner - Banner', featureId: '1001', impressions: '4,485', categoryId: 4 },
                            { id: 'l2_facerazor', name: 'Face & Eyebrow Razor - Banner', featureId: '1001', impressions: '12,842', categoryId: 540 }
                        ],
                        'thankyou': [
                            { id: 'thankyou_a', name: 'Thank You A', featureId: 'NA', impressions: '414,700' },
                            { id: 'thankyou_b', name: 'Thank You B', featureId: 'NA', impressions: '398,542' },
                            { id: 'thankyou_c', name: 'Thank You C', featureId: 'NA', impressions: '385,210' },
                            { id: 'thankyou_d', name: 'Thank You D', featureId: 'NA', impressions: '372,890' },
                            { id: 'thankyou_e', name: 'Thank You E', featureId: 'NA', impressions: '358,650' }
                        ]
                    }
                };

                // State (exposed globally for Step 3 access)
                let selectedPageId = null;
                let selectedPlacementIds = new Set(); // Selected placements (no slots)
                let searchTerm = '';
                
                // Expose for Step 3 Ads
                window.visibilityWizardState = {
                    getSelectedPageId: () => selectedPageId,
                    getSelectedPlacementIds: () => selectedPlacementIds,
                    getDb: () => db
                };

                // DOM Elements
                const pageListContainer = document.getElementById('page-list-container');
                const inventoryListContainer = document.getElementById('inventory-list-container');
                const summaryListContainer = document.getElementById('summary-list-container');
                const inventoryAvailableCountEl = document.getElementById('inventory-available-count');
                const summaryCountEl = document.getElementById('summary-count');

                // Helper: Calculate total impressions for a page
                const getPageStats = (pageId) => {
                    const placements = db.placements[pageId] || [];
                    let totalImpr = 0;
                    let count = 0;
                    placements.forEach(p => {
                        if (p.impressions && p.impressions !== 'NA') {
                            const num = parseInt(p.impressions.replace(/,/g, ''));
                            if (!isNaN(num)) totalImpr += num;
                        }
                        count++;
                    });
                    // Format total impressions
                    let formattedImpr = 'NA';
                    if (totalImpr >= 1000000) {
                        formattedImpr = (totalImpr / 1000000).toFixed(1) + 'M';
                    } else if (totalImpr >= 1000) {
                        formattedImpr = (totalImpr / 1000).toFixed(0) + 'K';
                    } else if (totalImpr > 0) {
                        formattedImpr = totalImpr.toLocaleString();
                    }
                    return { totalImpr: formattedImpr, placementCount: count };
                };

                // Render Left Column (Pages)
                const renderPages = () => {
                    pageListContainer.innerHTML = '';
                    
                    // Filter pages based on campaign type
                    let pagesToShow = db.pages;
                    const isTakeoverCampaign = window.currentCampaignType === 'takeover';
                    
                    if (isTakeoverCampaign) {
                        // For Takeover: Only show Homepage and L1 category pages (exclude L2 and Thank You)
                        pagesToShow = db.pages.filter(page => {
                            const allowedTakeoverPages = new Set(['home_27659','l1_bath_21868','l1_combo_41682','l1_feminine_41520','l1_fragrance_21032','l1_haircare_41626','l1_makeup_41624','l1_skin_41622']);
                            return allowedTakeoverPages.has(page.id);
                        });
                    }
                    
                    pagesToShow.forEach(page => {
                        const isSelected = page.id === selectedPageId;
                        const stats = getPageStats(page.id);
                        const card = document.createElement('div');
                        card.className = `page-card ${isSelected ? 'selected' : ''}`;
                        card.dataset.pageId = page.id;
                        card.innerHTML = `
                            <div class="page-card-header"><i class="${page.icon}"></i> ${page.name}</div>
                            <div class="page-card-stats">
                                <div>Total Impr: <strong>${stats.totalImpr}</strong></div>
                                <div>Placements: <strong>${stats.placementCount}</strong></div>
                            </div>`;
                        pageListContainer.appendChild(card);
                    });
                };

                // Render Middle Column (Placements - Direct Selection, No Slots)
                const renderInventories = () => {
                    if (!selectedPageId) {
                        inventoryListContainer.innerHTML = `<div class="placeholder"><i class="fa-solid fa-hand-pointer"></i><p>Select a page to view placements.</p></div>`;
                        inventoryAvailableCountEl.textContent = `0`;
                        return;
                    }

                    // Get placements for selected page
                    let placements = db.placements[selectedPageId] || [];
                    
                    // Filter placements based on campaign type
                    const isVisibilityCampaign = window.currentCampaignType === 'visibility';
                    const isTakeoverCampaign = window.currentCampaignType === 'takeover';
                    
                    if (isVisibilityCampaign) {
                        // For Visibility: Exclude Takeover-only placements
                        const takeoverOnlyPlacements = ['Cover Widget', 'Cover Widget Scroll Chips', 'Scroll Chips'];
                        placements = placements.filter(p => 
                            !takeoverOnlyPlacements.includes(p.name)
                        );
                    } else if (isTakeoverCampaign) {
                        // For Takeover: Only show Cover Widget, Cover Widget Scroll Chips, and Scroll Chips
                        const allowedPlacements = ['Cover Widget', 'Cover Widget Scroll Chips', 'Scroll Chips'];
                        placements = placements.filter(p => 
                            allowedPlacements.includes(p.name)
                        );
                    }
                    
                    // Filter Logic (Search matches Placement Name)
                    if (searchTerm) {
                        placements = placements.filter(p => 
                            p.name.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                    }

                    // Count placements
                    inventoryAvailableCountEl.textContent = `${placements.length} Placements`;

                    // Build Table HTML
                    let tableHTML = '';
                    
                    if (placements.length === 0) {
                        tableHTML = `<tr><td colspan="4"><div class="placeholder"><p>No placements found.</p></div></td></tr>`;
                    } else {
                        placements.forEach(placement => {
                            const isSelected = selectedPlacementIds.has(placement.id);
                            
                            // Button State
                            const actionButton = isSelected 
                                ? `<div class="selected-status"><i class="fa-solid fa-circle-check"></i> Selected <i class="fa-solid fa-trash-can delete-icon" data-placement-id="${placement.id}"></i></div>` 
                                : `<button class="select-btn" data-placement-id="${placement.id}">Select</button>`;
                            
                            // Row Style
                            const rowStyle = isSelected ? 'background-color: var(--cc-secondary-color);' : '';
                            
                            // Feature ID badge
                            const featureBadge = placement.featureId && placement.featureId !== 'NA' 
                                ? `<span class="tag" style="background:#e0e7ff; color:#4338ca;">${placement.featureId}</span>` 
                                : '';

                            tableHTML += `
                                <tr class="hover:bg-gray-50 transition" style="${rowStyle}">
                                    <td style="padding: 12px; font-weight: 600;">
                                        <i class="fa-solid fa-image" style="color:#9ca3af; margin-right:8px;"></i>
                                        ${placement.name}
                                        ${featureBadge}
                                    </td>
                                    <td style="padding: 12px; white-space: nowrap; text-align: right;">
                                        ${placement.impressions !== 'NA' ? `<span style="font-weight:600; color:#16a34a;">${placement.impressions}</span>` : '<span style="color:#9ca3af;">-</span>'}
                                    </td>
                                    <td class="action-col" style="padding: 12px; text-align: center;">${actionButton}</td>
                                </tr>
                            `;
                        });
                    }

                    // Render Container (Simplified Layout)
                    inventoryListContainer.innerHTML = `
                        <div class="inventory-controls">
                            <div class="search-wrapper">
                                <i class="fa-solid fa-magnifying-glass"></i>
                                <input type="text" id="inventory-search" placeholder="Search placements..." value="${searchTerm}">
                            </div>
                        </div>
                        <div class="inventory-table-wrapper">
                            <table class="inventory-table" style="table-layout: fixed; width: 100%;">
                                <thead>
                                    <tr>
                                        <th style="width: 50%;">Placement Name</th>
                                        <th style="width: 25%; text-align: right;">Avg. Impressions</th>
                                        <th class="action-col" style="width: 25%; text-align: center;">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${tableHTML}
                                </tbody>
                            </table>
                        </div>
                    `;
                };

                // Render Right Column (Summary)
                const renderSummary = () => {
                    summaryCountEl.textContent = selectedPlacementIds.size;
                    
                    if (selectedPlacementIds.size === 0) {
                        summaryListContainer.innerHTML = `<div class="placeholder"><i class="fa-solid fa-cart-plus"></i><p>Your selected placements will appear here.</p></div>`;
                        return;
                    }

                    summaryListContainer.innerHTML = '';
                    
                    // Find selected placements across all data
                    selectedPlacementIds.forEach(id => {
                        let foundPlacement = null;
                        let foundPageName = '';

                        // Search in placements data
                        for (const pageKey in db.placements) {
                            const placement = db.placements[pageKey].find(p => p.id === id);
                            if (placement) {
                                foundPlacement = placement;
                                // Find page name
                                const page = db.pages.find(pg => pg.id === pageKey);
                                foundPageName = page ? page.name : pageKey;
                                break;
                            }
                        }

                        if (foundPlacement) {
                            const item = document.createElement('div');
                            item.className = 'summary-item';
                            item.innerHTML = `
                                <div class="summary-item-info">
                                    <div style="font-size:10px; color:#999; font-weight:600;">${foundPageName}</div>
                                    <strong>${foundPlacement.name}</strong>
                                    <div style="font-size:11px; color:#16a34a; font-weight:500; margin-top:2px;">${foundPlacement.impressions !== 'NA' ? foundPlacement.impressions + ' impressions' : ''}</div>
                                </div>
                                <i class="fa-solid fa-trash-can remove-btn" data-placement-id="${foundPlacement.id}"></i>
                            `;
                            summaryListContainer.appendChild(item);
                        }
                    });
                };

                const updateUI = () => {
                    renderPages();
                    renderInventories();
                    renderSummary();
                };

                // Event Listeners
                
                // Check if this is a Visibility campaign (restricted to ONE page + ONE placement)
                const isVisibilityCampaign = window.currentCampaignType === 'visibility';
                
                // 1. Select Page
                pageListContainer.addEventListener('click', (e) => {
                    const card = e.target.closest('.page-card');
                    if (card) {
                        const pageId = card.dataset.pageId;
                        if (selectedPageId !== pageId) {
                            // For Visibility: Clear all selections when switching pages
                            if (isVisibilityCampaign) {
                                selectedPlacementIds.clear();
                            }
                            selectedPageId = pageId;
                            searchTerm = '';
                            updateUI();
                        }
                    }
                });

                // 2. Middle Column Interactions (Select/Deselect Placement)
                inventoryListContainer.addEventListener('click', (e) => {
                    const target = e.target;

                    // Select/Deselect Placement
                    const placementId = target.dataset.placementId || target.closest('.delete-icon')?.dataset.placementId || target.closest('.select-btn')?.dataset.placementId;
                    
                    if (placementId) {
                        if (selectedPlacementIds.has(placementId)) {
                            selectedPlacementIds.delete(placementId);
                        } else {
                            // For Visibility: Only allow ONE placement selection
                            if (isVisibilityCampaign) {
                                selectedPlacementIds.clear(); // Clear previous selection
                            }
                            selectedPlacementIds.add(placementId);
                        }
                        updateUI();
                    }
                });

                // 3. Search
                inventoryListContainer.addEventListener('input', (e) => {
                    if (e.target.matches('#inventory-search')) {
                        searchTerm = e.target.value;
                        renderInventories();
                    }
                });

                // 4. Remove from Summary
                summaryListContainer.addEventListener('click', (e) => {
                    if (e.target.matches('.remove-btn')) {
                        const placementId = e.target.dataset.placementId;
                        if (placementId && selectedPlacementIds.has(placementId)) {
                            selectedPlacementIds.delete(placementId);
                            updateUI();
                        }
                    }
                });

                // Initial Render
                updateUI();
            }

            // --- STEP 2: TARGETING LOGIC (Cleaned) ---
            function initializeStep2() {
                // 1. Accordion Logic
                const accordion = document.getElementById('targeting-accordion');
                if (accordion) {
                    accordion.addEventListener('click', (e) => {
                        const header = e.target.closest('.accordion-header');
                        if (!header) return;
                        const item = header.parentElement;
                        item.classList.toggle('open');
                        header.nextElementSibling.style.display = item.classList.contains('open') ? 'block' : 'none';
                    });
                }

                // 2. Tabs Logic (For Audience)
                const setupTabs = (container) => {
                    if (!container) return;
                    const tabs = container.querySelectorAll('.generic-tab');
                    const contents = container.querySelectorAll('.audience-tab-content');
                    
                    tabs.forEach(tab => {
                        tab.addEventListener('click', () => {
                            tabs.forEach(t => t.classList.remove('active'));
                            tab.classList.add('active');
                            const targetId = tab.dataset.tab;
                            contents.forEach(content => {
                                if (content.id.includes(targetId)) {
                                    content.style.display = 'block';
                                } else {
                                    content.style.display = 'none';
                                }
                            });
                        });
                    });
                };
                
                const audienceTabsContainer = document.querySelector('.audience-tabs');
                if (audienceTabsContainer) setupTabs(audienceTabsContainer.parentElement);

                // 3. Rule Builder (Add/Remove for Audience)
                document.body.addEventListener('click', e => {
                    if (e.target.matches('.add-rule-btn')) {
                        const builderId = e.target.dataset.builder;
                        const builder = document.getElementById(builderId);
                        if (builder && builder.firstElementChild) {
                            const newRow = builder.firstElementChild.cloneNode(true);
                            newRow.querySelectorAll('input, select').forEach(el => el.value = '');
                            const removeBtn = newRow.querySelector('.remove-rule-btn');
                            if(removeBtn) removeBtn.style.visibility = 'visible';
                            builder.appendChild(newRow);
                        }
                    }
                    if (e.target.matches('.remove-rule-btn')) {
                        e.target.parentElement.remove();
                    }
                });

                // 4. Geo Location Logic (State -> Quick/Non-Quick for Visibility)
                const geoContent = document.querySelector('[data-accordion="geo"]');
                const includedPillsContainer = document.getElementById('included-pills');
                const excludedPillsContainer = document.getElementById('excluded-pills');
                const includeStateSelect = document.getElementById('include-state-select');
                const includeSpeedSelect = document.getElementById('include-speed-select');
                const excludeStateSelect = document.getElementById('exclude-state-select');
                const includeAddBtn = document.getElementById('include-add-btn');
                const excludeAddBtn = document.getElementById('exclude-add-btn');
                const quicknessHint = document.getElementById('quickness-hint');

                // Demo state list (prototype). Backend will populate this from geo metadata.
                const STATES = [
                    'Delhi', 'Maharashtra', 'Karnataka', 'Tamil Nadu', 'Gujarat',
                    'Rajasthan', 'Uttar Pradesh', 'West Bengal', 'Telangana', 'Punjab'
                ];

                // Quick/Non-Quick availability (prototype). Backend will drive this.
                const QUICKNESS_SUPPORTED = new Set(['Delhi','Maharashtra','Karnataka','Tamil Nadu','Gujarat','Telangana']);

                // Selected values
                let includedCount = 0;
                let excludedCount = 0;

                const populateStateSelect = (sel, includeAllStates = false) => {
                    if (!sel) return;
                    // preserve first two options for include select (Select state + All States)
                    sel.innerHTML = '';
                    const defaultOpt = document.createElement('option');
                    defaultOpt.value = '';
                    defaultOpt.textContent = 'Select state';
                    sel.appendChild(defaultOpt);
                    
                    if (includeAllStates) {
                        const allOpt = document.createElement('option');
                        allOpt.value = 'ALL_STATES';
                        allOpt.textContent = 'All States';
                        sel.appendChild(allOpt);
                    }
                    
                    STATES.forEach(s => {
                        const opt = document.createElement('option');
                        opt.value = s;
                        opt.textContent = s;
                        sel.appendChild(opt);
                    });
                };

                // Track included/excluded states for overlap detection
                let includedStates = new Set();
                let excludedStates = new Set();
                let allStatesIncluded = false;

                const checkOverlap = () => {
                    const overlapError = document.getElementById('geo-overlap-error');
                    if (!overlapError) return;
                    
                    let hasOverlap = false;
                    
                    // Check for direct overlap
                    for (const state of includedStates) {
                        if (excludedStates.has(state)) {
                            hasOverlap = true;
                            break;
                        }
                    }
                    
                    // If "All States" is included and any state is excluded, that's a valid use case (not an error)
                    // But if same specific state is both included AND excluded, that's an error
                    
                    if (hasOverlap) {
                        overlapError.classList.remove('hidden');
                        overlapError.style.display = 'flex';
                    } else {
                        overlapError.classList.add('hidden');
                        overlapError.style.display = 'none';
                    }
                };

                const setSpeedSelectState = () => {
                    if (!includeStateSelect || !includeSpeedSelect) return;
                    const state = includeStateSelect.value;
                    const isVisibility = window.currentCampaignType === 'visibility';

                    if (!isVisibility) {
                        // For non-visibility flows, keep it locked to ALL
                        includeSpeedSelect.value = 'ALL';
                        includeSpeedSelect.disabled = true;
                        if (quicknessHint) quicknessHint.textContent = 'Quickness available only for Visibility campaigns';
                        return;
                    }

                    if (!state || state === 'ALL_STATES') {
                        includeSpeedSelect.value = 'ALL';
                        includeSpeedSelect.disabled = true;
                        if (quicknessHint) quicknessHint.textContent = state === 'ALL_STATES' ? 'Quickness not available for All States' : 'Select a state to check availability';
                        return;
                    }

                    const supported = QUICKNESS_SUPPORTED.has(state);
                    if (supported) {
                        includeSpeedSelect.disabled = false;
                        if (quicknessHint) quicknessHint.textContent = 'Optional: refine by Quick / Non-Quick';
                    } else {
                        includeSpeedSelect.value = 'ALL';
                        includeSpeedSelect.disabled = true;
                        if (quicknessHint) quicknessHint.textContent = 'Quick / Non-Quick not available for this state';
                    }
                };

                const updateGeoSummary = () => {
                    const summaryEl = document.getElementById('geo-summary');
                    const badgeEl = document.getElementById('geo-badge');
                    let summaryText = [];
                    if (includedCount > 0) summaryText.push(`${includedCount} included`);
                    if (excludedCount > 0) summaryText.push(`${excludedCount} excluded`);

                    if (summaryText.length > 0) {
                        summaryEl.textContent = summaryText.join(', ');
                        badgeEl.textContent = 'MANUAL';
                        badgeEl.classList.add('manual');
                    } else {
                        summaryEl.textContent = '';
                        badgeEl.textContent = 'ALL STATES';
                        badgeEl.classList.remove('manual');
                    }
                };

                const makePill = ({ type, state, speed }) => {
                    const pill = document.createElement('div');
                    pill.className = `location-pill ${type === 'exclude' ? 'exclude' : ''}`;
                    pill.dataset.state = state;
                    if (speed) pill.dataset.speed = speed;

                    let label = state;
                    if (type === 'include' && speed && speed !== 'ALL') {
                        label = `${state}  ${speed === 'QUICK' ? 'Quick' : 'Non-Quick'}`;
                    }

                    pill.innerHTML = `
                        <span>${label}</span>
                        <i class="fa-solid fa-xmark remove-pill" title="Remove"></i>
                    `;
                    return pill;
                };

                const addIncluded = () => {
                    if (!includeStateSelect || !includedPillsContainer) return;
                    const state = includeStateSelect.value;
                    if (!state) return;

                    // Enforce limit
                    if (includedCount >= 20) return;

                    // Check if already added
                    if (state === 'ALL_STATES') {
                        if (allStatesIncluded) return; // Already added
                        allStatesIncluded = true;
                    } else {
                        if (includedStates.has(state)) return; // Already added
                        includedStates.add(state);
                    }

                    let speed = 'ALL';
                    const supported = QUICKNESS_SUPPORTED.has(state) && (window.currentCampaignType === 'visibility') && state !== 'ALL_STATES';
                    if (supported && includeSpeedSelect) {
                        speed = includeSpeedSelect.value || 'ALL';
                    }

                    const displayState = state === 'ALL_STATES' ? 'All States' : state;
                    const pill = makePill({ type: 'include', state: displayState, speed });
                    pill.dataset.stateValue = state; // Store original value for tracking
                    includedPillsContainer.appendChild(pill);
                    includedCount++;

                    // Reset selection
                    includeStateSelect.value = '';
                    if (includeSpeedSelect) includeSpeedSelect.value = 'ALL';
                    setSpeedSelectState();
                    updateGeoSummary();
                    checkOverlap();
                };

                const addExcluded = () => {
                    if (!excludeStateSelect || !excludedPillsContainer) return;
                    const state = excludeStateSelect.value;
                    if (!state) return;

                    // Enforce limit
                    if (excludedCount >= 20) return;

                    // Check if already added
                    if (excludedStates.has(state)) return;
                    excludedStates.add(state);

                    const pill = makePill({ type: 'exclude', state });
                    pill.dataset.stateValue = state;
                    excludedPillsContainer.appendChild(pill);
                    excludedCount++;

                    // Reset
                    excludeStateSelect.value = '';
                    updateGeoSummary();
                    checkOverlap();
                };

                if (geoContent) {
                    populateStateSelect(includeStateSelect, true); // Include "All States" option
                    populateStateSelect(excludeStateSelect, false); // No "All States" for exclude

                    if (includeStateSelect) {
                        includeStateSelect.addEventListener('change', setSpeedSelectState);
                    }

                    // Buttons
                    if (includeAddBtn) includeAddBtn.addEventListener('click', addIncluded);
                    if (excludeAddBtn) excludeAddBtn.addEventListener('click', addExcluded);

                    // Enter-to-add for convenience
                    geoContent.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            if (document.activeElement === includeStateSelect || document.activeElement === includeSpeedSelect) {
                                e.preventDefault();
                                addIncluded();
                            }
                            if (document.activeElement === excludeStateSelect) {
                                e.preventDefault();
                                addExcluded();
                            }
                        }
                    });

                    // Remove pill
                    geoContent.addEventListener('click', (e) => {
                        if (e.target.matches('.remove-pill')) {
                            const pill = e.target.parentElement;
                            const type = pill.classList.contains('exclude') ? 'exclude' : 'include';
                            const stateValue = pill.dataset.stateValue || pill.dataset.state;
                            
                            if (type === 'include') {
                                includedCount--;
                                if (stateValue === 'ALL_STATES' || stateValue === 'All States') {
                                    allStatesIncluded = false;
                                } else {
                                    includedStates.delete(stateValue);
                                }
                            } else {
                                excludedCount--;
                                excludedStates.delete(stateValue);
                            }
                            
                            pill.remove();
                            updateGeoSummary();
                            checkOverlap();
                        }
                    });

                    // Initial state
                    setSpeedSelectState();
                    updateGeoSummary();
                }
                // 5. Reach Gauge Logic
                const needle = document.getElementById('reach-needle');
                const reachValue = document.getElementById('reach-value');
                let currentReach = 76890;
                
                if (needle && reachValue) {
                    const interval = setInterval(() => {
                        if(!document.getElementById('reach-needle')) { clearInterval(interval); return; }
                        const randomChange = (Math.random() - 0.5) * 20000;
                        currentReach = Math.max(0, Math.min(150000, currentReach + randomChange));
                        const percentage = currentReach / 150000;
                        needle.style.transform = `rotate(${percentage * 180 - 90}deg)`;
                        reachValue.textContent = Math.round(currentReach).toLocaleString();
                    }, 2000);
                }
            }

            // --- STEP 3: ADS LOGIC (Gray Icons) ---
            function initializeStep3() {
                // 1. POPULATE SIDEBAR (Left Panel) - Based on Step 1 selections
                const inventoryNavList = document.getElementById('inventory-nav-list');
                const adPanelTitle = document.getElementById('ad-panel-title');
                const adPanelDesc = document.getElementById('ad-panel-desc');
                
                // Get selections from Step 1
                const wizardState = window.visibilityWizardState;
                let selectedInventories = [];
                
                if (wizardState) {
                    const selectedPlacementIds = wizardState.getSelectedPlacementIds();
                    const db = wizardState.getDb();
                    
                    if (selectedPlacementIds && selectedPlacementIds.size > 0 && db) {
                        // Build list of selected placements with their page names
                        selectedPlacementIds.forEach(placementId => {
                            for (const pageKey in db.placements) {
                                const placement = db.placements[pageKey].find(p => p.id === placementId);
                                if (placement) {
                                    const page = db.pages.find(pg => pg.id === pageKey);
                                    selectedInventories.push({
                                        id: placement.id,
                                        name: placement.name,
                                        info: page ? page.name : pageKey,
                                        pageId: pageKey
                                    });
                                    break;
                                }
                            }
                        });
                    }
                }

                if (inventoryNavList) {
                    if (selectedInventories.length === 0) {
                        // No placements selected - show empty state
                        inventoryNavList.innerHTML = `
                            <li class="inventory-nav-item" style="border-bottom:1px solid #f3f4f6; padding: 20px; text-align: center;">
                                <div style="color: #9ca3af;">
                                    <i class="fa-solid fa-box-open" style="font-size: 24px; margin-bottom: 8px;"></i>
                                    <p style="font-size: 13px;">No placements selected</p>
                                    <p style="font-size: 11px; color: #d1d5db; margin-top: 4px;">Go back to Step 1 to select placements</p>
                                </div>
                            </li>
                        `;
                        if (adPanelTitle) adPanelTitle.textContent = 'No Placements Selected';
                        if (adPanelDesc) adPanelDesc.textContent = 'Please go back to Step 1 and select at least one placement to upload ads.';
                    } else {
                        // Render selected placements
                        inventoryNavList.innerHTML = selectedInventories.map((inv, idx) => `
                            <li class="inventory-nav-item ${idx === 0 ? 'active' : ''}" data-placement-id="${inv.id}" style="border-bottom:1px solid #f3f4f6; cursor: pointer;">
                                <div class="item-header">
                                    <i class="fa-solid fa-layer-group item-icon"></i>
                                    <div class="item-info">
                                        <h5 style="font-weight:600; color:#374151;">${inv.name}</h5>
                                        <p style="font-size: 11px; color: #9ca3af;">${inv.info}</p>
                                    </div>
                                </div>
                            </li>
                        `).join('');
                        
                        // Update panel title with first selected placement
                        if (adPanelTitle && selectedInventories[0]) adPanelTitle.textContent = selectedInventories[0].name;
                        if (adPanelDesc) adPanelDesc.textContent = 'Upload creatives for this placement. New uploads go under review; approved creatives are eligible to serve.';
                        
                        // Add click handler for inventory items
                        inventoryNavList.querySelectorAll('.inventory-nav-item').forEach(item => {
                            item.addEventListener('click', () => {
                                inventoryNavList.querySelectorAll('.inventory-nav-item').forEach(i => i.classList.remove('active'));
                                item.classList.add('active');
                                const inv = selectedInventories.find(i => i.id === item.dataset.placementId);
                                if (inv && adPanelTitle) adPanelTitle.textContent = inv.name;
                            });
                        });
                    }
                }

                // 2. RENDER AD GRID (Right Panel)
                const adUploadArea = document.getElementById('ad-upload-area');
                
                // Helper to generate Card HTML
                // UPDATED: Trash icon now matches Eye icon style (Gray, no red)
                const createCardHTML = (imgSrc, statusClass, statusText, iconClass) => `
                    <div class="ad-card">
                        <div class="ad-image-wrapper">
                            <img src="${imgSrc}" alt="Ad Creative">
                            <div class="card-expand-icon" onclick="previewCreative(this)"><i class="fa-solid fa-expand"></i></div>
                        </div>
                        <div class="ad-card-footer">
                            <div class="ad-status-indicator ${statusClass}">
                                <i class="${iconClass}"></i> ${statusText}
                            </div>
                            <div class="ad-actions">
                                <i class="ri-eye-line action-icon-btn" style="font-size: 18px;" onclick="previewCreative(this)" title="Preview"></i>
                                <i class="ri-delete-bin-line action-icon-btn delete-card-btn" style="font-size: 18px;" title="Delete Ad"></i>
                            </div>
                        </div>
                    </div>`;

                if (adUploadArea) {
                    adUploadArea.innerHTML = `
                        <div class="ad-thumbnails-grid">
                            <!-- New Ad Button -->
                            <div class="add-new-ad-btn" id="add-new-ad-btn">
                                <i class="fa-solid fa-plus" style="font-size: 32px; margin-bottom: 12px;"></i>
                                <p style="font-weight: 600;">New Ad</p>
                            </div>

                            <!-- Ad 1: Under Review -->
                            ${createCardHTML('https://images.unsplash.com/photo-1522335789203-abd65232121c?auto=format&fit=crop&q=80&w=400', 'status-yellow', 'Under Review', 'fa-solid fa-circle-notch fa-spin')}

                            <!-- Ad 2: Approved -->
                            ${createCardHTML('https://images.unsplash.com/photo-1616683693504-3ea7e9ad6fec?auto=format&fit=crop&q=80&w=400', 'status-green', 'Approved', 'fa-solid fa-circle-check')}

                            <!-- Ad 3: Rejected -->
                            ${createCardHTML('https://images.unsplash.com/photo-1512496015851-a90fb38ba796?auto=format&fit=crop&q=80&w=400', 'status-red', 'Rejected', 'fa-solid fa-circle-xmark')}
                        </div>`;
                }
                // 3. MODAL LOGIC
                if (!window.__creativeModalInitialized) {
                const modalBackdrop = document.getElementById('modal-backdrop');
                const createAdModal = document.getElementById('create-ad-modal');
                const previewImg = document.getElementById('live-preview-img');
                
                const openModal = () => { if(modalBackdrop) modalBackdrop.style.display = 'block'; if(createAdModal) createAdModal.style.display = 'flex'; };
                const closeModal = () => { if(modalBackdrop) modalBackdrop.style.display = 'none'; if(createAdModal) createAdModal.style.display = 'none'; };


                // Helper: choose the correct grid depending on which wizard is currently open
                const getActiveAdGrid = () => {
                    const takeoverVisible = document.getElementById('page-create-takeover') && !document.getElementById('page-create-takeover').classList.contains('hidden');
                    if (takeoverVisible) return document.querySelector('#takeover-ad-upload-area .ad-thumbnails-grid');
                    return document.querySelector('#ad-upload-area .ad-thumbnails-grid');
                };

                // File Upload Handlers
                const handleFileUpload = (file, labelEl, iconEl, overlayId) => {
                    const overlay = document.getElementById(overlayId);
                    if (file.size > 1048576) {
                        showWizardError("Image size should be less than 1MB");
                        return;
                    }
                    const img = new Image();
                    img.src = URL.createObjectURL(file);
                    img.onload = function() {
                        if (this.width !== 320 || this.height !== 420) {
                            showWizardError(`Dimensions don't match (Expected 320x420, Got ${this.width}x${this.height})`);
                        } else {
                            labelEl.style.color = "var(--cc-primary-green)";
                            labelEl.innerText = file.name;
                            iconEl.className = "ri-check-line";
                            iconEl.style.color = "var(--cc-primary-green)";
                            previewImg.src = img.src;
                            previewImg.style.opacity = "1";
                            if(overlay) overlay.classList.add('has-file');
                        }
                    };
                };

                const resetFile = (inputId, labelId, iconId, overlayId, defaultText) => {
                    const input = document.getElementById(inputId);
                    const label = document.getElementById(labelId);
                    const icon = document.getElementById(iconId);
                    const overlay = document.getElementById(overlayId);
                    if(input) input.value = "";
                    if(label) { label.innerText = defaultText; label.style.color = "#475569"; }
                    if(icon) { icon.className = inputId.includes('web') ? "ri-upload-cloud-2-line" : "ri-smartphone-line"; icon.style.color = "#cbd5e1"; }
                    if(overlay) overlay.classList.remove('has-file');
                    previewImg.src = "https://via.placeholder.com/400x500.png?text=Ad+Preview";
                    previewImg.style.opacity = "0.5";
                };

                const webInput = document.getElementById('web-upload-input');
                const appInput = document.getElementById('app-upload-input');
                if(webInput) webInput.addEventListener('change', function() { if(this.files[0]) handleFileUpload(this.files[0], document.getElementById('web-upload-label'), document.getElementById('web-icon'), 'web-overlay'); });
                if(appInput) appInput.addEventListener('change', function() { if(this.files[0]) handleFileUpload(this.files[0], document.getElementById('app-upload-label'), document.getElementById('app-icon'), 'app-overlay'); });

                const webDel = document.getElementById('web-delete-btn');
                const appDel = document.getElementById('app-delete-btn');
                if(webDel) webDel.addEventListener('click', (e) => { e.stopPropagation(); resetFile('web-upload-input', 'web-upload-label', 'web-icon', 'web-overlay', 'Web Image'); });
                if(appDel) appDel.addEventListener('click', (e) => { e.stopPropagation(); resetFile('app-upload-input', 'app-upload-label', 'app-icon', 'app-overlay', 'App Image'); });

                // SAVE LOGIC
                const saveBtn = document.getElementById('save-ad-btn');
                if(saveBtn) {
                    const newBtn = saveBtn.cloneNode(true);
                    saveBtn.parentNode.replaceChild(newBtn, saveBtn);
                    newBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const nameInput = document.getElementById('ad-name-input');
                        if (!nameInput.value.trim()) {
                            showWizardError("Please add Name");
                            return;
                        }
                        if ((!webInput.files.length) && (!appInput.files.length)) {
                            showWizardError("Please upload at least one creative");
                            return;
                        }
                        closeModal();
                        
                        // Add New Card with Trash Icon
                        const grid = getActiveAdGrid();
                        if(grid) {
                            const tempDiv = document.createElement('div');
                            tempDiv.innerHTML = createCardHTML(previewImg.src, 'status-yellow', 'Under Review', 'fa-solid fa-circle-notch fa-spin');
                            grid.appendChild(tempDiv.firstElementChild);
                        
                            // Persist in Takeover state so switching placements retains the card (prototype behavior)
                            try {
                                const takeoverVisible = !document.getElementById('page-create-takeover').classList.contains('hidden');
                                if (takeoverVisible && window.takeoverState) {
                                    const pid = window.takeoverState.activeAdPlacementId || window.takeoverState.placementId;
                                    if (pid) {
                                        window.takeoverState.adsByPlacement = window.takeoverState.adsByPlacement || {};
                                        window.takeoverState.adsByPlacement[pid] = window.takeoverState.adsByPlacement[pid] || [];
                                        window.takeoverState.adsByPlacement[pid].unshift({
                                            img: previewImg && previewImg.src ? previewImg.src : '',
                                            statusClass: 'status-yellow',
                                            statusText: 'Under Review',
                                            iconClass: 'fa-solid fa-circle-notch fa-spin'
                                        });
                                    }
                                }
                            } catch (e) {}
}
                    });
                }

                // GLOBAL CLICKS (Modal & Delete Card)
                document.body.addEventListener('click', (e) => {
                    // Modal Open/Close
                    if (e.target.closest('#add-new-ad-btn') || e.target.closest('#takeover-add-new-ad-btn')) openModal();
                    if (e.target.closest('.close-btn') || e.target === modalBackdrop) closeModal();
                    
                    // DELETE CARD LOGIC
                    const delBtn = e.target.closest('.delete-card-btn');
                    if (delBtn) {
                        const card = delBtn.closest('.ad-card');
                        if (card) {
                            // Optional: Add confirm dialog here if you want
                            card.remove(); 
                        }
                    }
                });
            }
                window.__creativeModalInitialized = true;
                }

            // --- STEP 4: CONFIG LOGIC (Cleaned) ---
            function initializeStep4() {
                // Campaign Name validation listener
                const campaignNameInput = document.getElementById('campaign-name');
                const campaignNameError = document.getElementById('campaign-name-error');
                
                if (campaignNameInput) {
                    campaignNameInput.addEventListener('input', () => {
                        if (campaignNameInput.value.trim()) {
                            campaignNameInput.style.borderColor = '';
                            if (campaignNameError) {
                                campaignNameError.classList.add('hidden');
                                campaignNameError.style.display = 'none';
                            }
                        }
                    });
                }
                
                // 1. Set Default Dates
                const startDateInput = document.getElementById('start-date');
                const endDateInput = document.getElementById('end-date');
                const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const tomorrow = new Date(today);
                tomorrow.setDate(today.getDate() + 1);
                const nextWeek = new Date(tomorrow);
                nextWeek.setDate(tomorrow.getDate() + 7);

                const formatDate = (date) => `${date.getDate()} ${monthNames[date.getMonth()].slice(0, 3)}, ${date.getFullYear()}`;
                
                if(startDateInput) startDateInput.value = formatDate(tomorrow);
                if(endDateInput) endDateInput.value = formatDate(nextWeek);

                // 2. Calendar Popup Logic
                const createCalendar = (inputEl, calendarEl, isEndDate = false) => {
                    if(!inputEl || !calendarEl) return;
                    
                    let displayDate = new Date();
                    if(inputEl.value) displayDate = new Date(inputEl.value.replace(',', ''));
                    let currentView = 'days';

                    const render = () => {
                        calendarEl.innerHTML = '';
                        const header = document.createElement('div');
                        header.className = 'calendar-header';
                        
                        const prevBtn = document.createElement('button');
                        prevBtn.className = 'calendar-nav prev';
                        prevBtn.innerHTML = '<i class="fa-solid fa-chevron-left"></i>'; 
                        
                        const nextBtn = document.createElement('button');
                        nextBtn.className = 'calendar-nav next';
                        nextBtn.innerHTML = '<i class="fa-solid fa-chevron-right"></i>';
                        
                        const title = document.createElement('span');
                        title.className = 'calendar-title';
                        
                        if (currentView === 'years') {
                            const startYear = displayDate.getFullYear() - 5;
                            title.textContent = `${startYear} - ${startYear + 11}`;
                        } else {
                            title.innerHTML = `<span class="month-title">${monthNames[displayDate.getMonth()]}</span> <span class="year-title">${displayDate.getFullYear()}</span>`;
                        }
                        
                        header.append(prevBtn, title, nextBtn);
                        calendarEl.appendChild(header);

                        if (currentView === 'days') renderDays(prevBtn);
                        else if (currentView === 'months') renderMonths(prevBtn);
                        else if (currentView === 'years') renderYears(prevBtn);
                    };

                    const getLimitDate = () => isEndDate && startDateInput.value ? new Date(startDateInput.value.replace(',', '')) : today;

                    const renderDays = (prevBtn) => {
                        const limitDate = getLimitDate();
                        const grid = document.createElement('div');
                        grid.className = 'calendar-grid';
                        
                        ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'].forEach(day => {
                            const dayName = document.createElement('div');
                            dayName.className = 'day-name';
                            dayName.textContent = day;
                            grid.appendChild(dayName);
                        });

                        const firstDayOfMonth = new Date(displayDate.getFullYear(), displayDate.getMonth(), 1).getDay();
                        const daysInMonth = new Date(displayDate.getFullYear(), displayDate.getMonth() + 1, 0).getDate();

                        for (let i = 0; i < firstDayOfMonth; i++) grid.appendChild(document.createElement('div'));

                        for (let i = 1; i <= daysInMonth; i++) {
                            const dayEl = document.createElement('div');
                            dayEl.className = 'day';
                            dayEl.textContent = i;
                            const thisDate = new Date(displayDate.getFullYear(), displayDate.getMonth(), i);
                            
                            if (thisDate < limitDate) {
                                dayEl.classList.add('disabled');
                            } else {
                                dayEl.addEventListener('click', () => {
                                    inputEl.value = formatDate(thisDate);
                                    calendarEl.style.display = 'none';
                                    if (!isEndDate && endDateInput) {
                                        const currentEndDate = new Date(endDateInput.value.replace(',', ''));
                                        if (currentEndDate < thisDate) endDateInput.value = formatDate(thisDate);
                                    }
                                });
                            }
                            if(inputEl.value) {
                                const selectedDate = new Date(inputEl.value.replace(',', ''));
                                if (thisDate.toDateString() === selectedDate.toDateString()) dayEl.classList.add('selected');
                            }
                            grid.appendChild(dayEl);
                        }
                        calendarEl.appendChild(grid);
                    };

                    const renderMonths = (prevBtn) => {
                        const grid = document.createElement('div');
                        grid.className = 'month-grid';
                        monthNames.forEach((month, index) => {
                            const monthEl = document.createElement('div');
                            monthEl.className = 'month';
                            monthEl.textContent = month.slice(0, 3);
                            monthEl.addEventListener('click', () => { displayDate.setMonth(index); currentView = 'days'; render(); });
                            if (index === displayDate.getMonth()) monthEl.classList.add('selected');
                            grid.appendChild(monthEl);
                        });
                        calendarEl.appendChild(grid);
                    };

                    const renderYears = (prevBtn) => {
                        const startYear = displayDate.getFullYear() - 5;
                        const list = document.createElement('div');
                        list.className = 'year-list';
                        for (let i = 0; i < 12; i++) {
                            const year = startYear + i;
                            const yearEl = document.createElement('div');
                            yearEl.className = 'year';
                            yearEl.textContent = year;
                            yearEl.addEventListener('click', () => { displayDate.setFullYear(year); currentView = 'months'; render(); });
                            if (year === displayDate.getFullYear()) yearEl.classList.add('selected');
                            list.appendChild(yearEl);
                        }
                        calendarEl.appendChild(list);
                    };

                    calendarEl.addEventListener('click', e => {
                        e.stopPropagation();
                        const target = e.target.closest('button') || e.target;
                        if (target.matches('.prev') || target.closest('.prev')) {
                            if (currentView === 'days') displayDate.setMonth(displayDate.getMonth() - 1);
                            else if (currentView === 'months') displayDate.setFullYear(displayDate.getFullYear() - 1);
                            else if (currentView === 'years') displayDate.setFullYear(displayDate.getFullYear() - 12);
                            render();
                        }
                        if (target.matches('.next') || target.closest('.next')) {
                            if (currentView === 'days') displayDate.setMonth(displayDate.getMonth() + 1);
                            else if (currentView === 'months') displayDate.setFullYear(displayDate.getFullYear() + 1);
                            else if (currentView === 'years') displayDate.setFullYear(displayDate.getFullYear() + 12);
                            render();
                        }
                        if (target.matches('.month-title')) { currentView = 'months'; render(); }
                        if (target.matches('.year-title')) { currentView = 'years'; render(); }
                    });

                    const toggleCalendar = (e) => {
                        e.stopPropagation();
                        const isVisible = calendarEl.style.display === 'block';
                        document.querySelectorAll('.calendar-popup').forEach(cal => cal.style.display = 'none');
                        if (!isVisible) {
                            calendarEl.style.display = 'block';
                            if(inputEl.value) displayDate = new Date(inputEl.value.replace(',', ''));
                            currentView = 'days';
                            render();
                        }
                    };

                    inputEl.addEventListener('click', toggleCalendar);
                    const icon = inputEl.parentElement.querySelector('.calendar-icon');
                    if(icon) icon.addEventListener('click', toggleCalendar);
                };

                createCalendar(startDateInput, document.getElementById('start-date-calendar'));
                createCalendar(endDateInput, document.getElementById('end-date-calendar'), true);

                document.addEventListener('click', () => {
                    document.querySelectorAll('.calendar-popup').forEach(cal => cal.style.display = 'none');
                });
            }

            // Initialize First Step
            window.goToStep(1);
        });

        // Select Brand & Close
        window.selectBrand = function(name, count) {
            document.getElementById('brandHeaderName').innerText = name;
            document.getElementById('brandHeaderCount').innerText = count;
            window.closeAll(); 
        };

        // --- GLOBAL NAVIGATION (Updated with Sub-menu Cleanup) ---
    window.navigateTo = function(pageId, navId, breadcrumb) {
        // 1. Hide all Page Sections
        document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));
        
        // 2. Show the Target Page
        const target = document.getElementById('page-' + pageId);
        if(target) target.classList.remove('hidden');
        
        // 3. Reset Main Sidebar Items (Dim them all)
        document.querySelectorAll('.nav-item').forEach(el => {
            el.className = 'nav-item flex items-center justify-between px-4 py-3 text-white/70 hover:bg-white/10 hover:text-white rounded-lg transition group';
        });
        
        // 4. Highlight the Current Main Sidebar Item
        if(navId) {
            const nav = document.getElementById(navId);
            if(nav) nav.className = 'nav-item flex items-center justify-between px-4 py-3 text-white font-bold bg-white/10 rounded-lg transition group shadow-inner';
        }

        // 5. UPDATE BREADCRUMB
        if(breadcrumb) document.getElementById('breadcrumb-container').innerHTML = breadcrumb;

        // 6. THE FIX: Reset Performance Sub-menu if we are NOT on the Performance page
        if (pageId !== 'performance') {
            document.querySelectorAll('.perf-link').forEach(el => {
                // Remove Active Styles
                el.classList.remove('text-white', 'font-bold', 'bg-white/10');
                // Add Inactive Styles
                el.classList.add('text-white/50'); 
            });
        }
    };

        // View Switcher (Synced)
        let isRetailerView = true;

        // 1. Click on Left Sidebar Toggle
        window.toggleUserView = function() {
            isRetailerView = !isRetailerView;
            syncViewUI(isRetailerView);
        };
        
        // 2. Click on Top Header Dropdown
        window.selectView = function(mode) {
            isRetailerView = (mode === 'Retailer');
            syncViewUI(isRetailerView);
            window.closeAll();
        };

        // Helper: Updates BOTH Sidebar and Top Header
        function syncViewUI(isRetailer) {
            // Sidebar Elements
            const sbIcon = document.getElementById('userViewIcon');
            const sbTitle = document.getElementById('userViewTitle');
            const sbSub = document.getElementById('userViewSwitchText');
            // Top Header Elements
            const topText = document.getElementById('viewModeTextTop');
            const topIcon = document.getElementById('viewModeIconTop');

            if(isRetailer) {
                // Set All to Retailer
                if(sbIcon) sbIcon.innerText = 'R';
                if(sbTitle) sbTitle.innerText = 'Retailer View';
                if(sbSub) sbSub.innerText = 'Switch to Advertiser';
                if(topText) topText.innerText = 'Retailer';
                if(topIcon) topIcon.innerText = 'R';
            } else {
                // Set All to Advertiser
                if(sbIcon) sbIcon.innerText = 'A';
                if(sbTitle) sbTitle.innerText = 'Advertiser View';
                if(sbSub) sbSub.innerText = 'Switch to Retailer';
                if(topText) topText.innerText = 'Advertiser';
                if(topIcon) topIcon.innerText = 'A';
            }
        }

        // KPI Graph Toggles
        window.openKpiDropdown = (id, metric) => window.toggleId('kpiDropdown'+id);
        window.updateKpiCard = (id, metric) => {
            const title = document.getElementById('kpi-title-'+id);
            if(title) title.innerText = metric;
            window.closeAll();
        }
        
        // Campaign Table Toggles
        window.toggleCampaignView = (view) => {
        const list = document.getElementById('viewList');
        const chart = document.getElementById('viewChart');
        const btnList = document.getElementById('btnList');
        const btnChart = document.getElementById('btnChart');

        // Define Styles
        const activeClass = "p-1.5 rounded-md text-gray-700 bg-white shadow-sm transition";
        const inactiveClass = "p-1.5 rounded-md text-gray-500 hover:text-gray-700 transition";

        if(view === 'list') {
            // Show List
            list.classList.remove('hidden');
            chart.classList.add('hidden');
            
            // Update Buttons
            btnList.className = activeClass;
            btnChart.className = inactiveClass;
        }
        else {
            // Show Chart
            list.classList.add('hidden');
            chart.classList.remove('hidden');
            
            // Update Buttons
            btnList.className = inactiveClass;
            btnChart.className = activeClass;
        }
    };
        
        window.switchLayout = (view) => {
            const list = document.getElementById('viewList');
            const grid = document.getElementById('viewGrid');
            const comf = document.getElementById('viewComfortable');
            list.classList.add('hidden'); grid.classList.add('hidden'); comf.classList.add('hidden');
            if(view==='list') list.classList.remove('hidden');
            if(view==='grid') grid.classList.remove('hidden');
            if(view==='comfortable') comf.classList.remove('hidden');
            window.closeAll();
        };
        
        window.applyFilters = () => window.closeAll();
        window.clearFilters = () => { document.querySelectorAll('.filter-checkbox').forEach(c=>c.checked=false); window.closeAll(); };
// ==========================================
    // D. CREATIVE LIBRARY LOGIC
    // ==========================================

    window.openCreativeModal = function(type) {
        let modalId = type === 'upload' ? 'uploadCreativeModal' : 'previewCreativeModal';
        const modal = document.getElementById(modalId);
        const content = modal.querySelector('div[id$="Content"]'); 

        if(modal) {
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                if(content) {
                    content.classList.remove('scale-95');
                    content.classList.add('scale-100');
                }
            }, 10);
        }
    };

    window.closeCreativeModal = function(type) {
        let modalId = type === 'upload' ? 'uploadCreativeModal' : 'previewCreativeModal';
        const modal = document.getElementById(modalId);
        const content = modal.querySelector('div[id$="Content"]');

        if(modal) {
            modal.classList.add('opacity-0');
            if(content) {
                content.classList.remove('scale-100');
                content.classList.add('scale-95');
            }
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }
    };

    window.previewCreative = function(btn) {
        const card = btn.closest('.group');
        const img = card.querySelector('img');
        const target = document.getElementById('previewImageTarget');
        
        if(img && target) {
            target.src = img.src;
            window.openCreativeModal('preview');
        }
    };    
// Filter Function (Instant Auto-Apply)
    window.filterCreatives = function() {
        const showImages = document.getElementById('filterCheckImage').checked;
        const showVideos = document.getElementById('filterCheckVideo').checked;
        const searchText = document.getElementById('creativeSearchInput').value.toLowerCase();
        
        const cards = document.querySelectorAll('.creative-card');
        
        cards.forEach(card => {
            const type = card.getAttribute('data-type');
            const name = card.getAttribute('data-name').toLowerCase();
            
            let typeMatch = false;
            if(type === 'image' && showImages) typeMatch = true;
            if(type === 'video' && showVideos) typeMatch = true;
            
            let searchMatch = name.includes(searchText);
            
            // Show if BOTH type and search match
            if(typeMatch && searchMatch) {
                card.classList.remove('hidden');
            } else {
                card.classList.add('hidden');
            }
        });
    };
// ==========================================
    // E. CREATIVE PAGINATION LOGIC
    // ==========================================
    
    let currentCreativePage = 1;
    const creativeItemsPerPage = 8;

    window.renderCreativePagination = function() {
        const cards = Array.from(document.querySelectorAll('.creative-card'));
        const totalItems = cards.length;
        const totalPages = Math.ceil(totalItems / creativeItemsPerPage);
        
        // Ensure page is valid
        if(currentCreativePage < 1) currentCreativePage = 1;
        if(currentCreativePage > totalPages) currentCreativePage = totalPages;

        const start = (currentCreativePage - 1) * creativeItemsPerPage;
        const end = start + creativeItemsPerPage;

        // Show/Hide items based on index
        cards.forEach((card, index) => {
            // Only apply pagination logic if card is not filtered out by search/type
            // Note: For simplicity in this demo, pagination resets filter visibility 
            // If you want deep integration, we'd need more complex logic.
            // Here we just toggle visibility based on page index.
            if(index >= start && index < end) {
                card.style.display = 'flex'; // Restore display
            } else {
                card.style.display = 'none';
            }
        });

        // Update Button States
        const btnPrev = document.getElementById('creativePrevBtn');
        const btnNext = document.getElementById('creativeNextBtn');
        const page1 = document.getElementById('creativePage1');
        const page2 = document.getElementById('creativePage2');

        if(btnPrev) {
            btnPrev.disabled = currentCreativePage === 1;
            btnPrev.className = currentCreativePage === 1 
                ? "px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-500 cursor-not-allowed opacity-50"
                : "px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-600 hover:bg-gray-50 cursor-pointer";
        }

        if(btnNext) {
            btnNext.disabled = currentCreativePage === totalPages;
            btnNext.className = currentCreativePage === totalPages
                ? "px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-500 cursor-not-allowed opacity-50"
                : "px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-600 hover:bg-gray-50 cursor-pointer";
        }

        // Highlight Active Page Number
        if(page1) {
            page1.className = currentCreativePage === 1 
                ? "px-3 py-1 bg-primary text-white border border-primary rounded text-xs font-bold shadow-sm"
                : "px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-600 hover:bg-gray-50";
        }
        if(page2) {
            page2.className = currentCreativePage === 2
                ? "px-3 py-1 bg-primary text-white border border-primary rounded text-xs font-bold shadow-sm"
                : "px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold text-gray-600 hover:bg-gray-50";
        }
    };

    window.changeCreativePage = function(direction, specificPage) {
        if(specificPage) {
            currentCreativePage = specificPage;
        } else {
            currentCreativePage += direction;
        }
        window.renderCreativePagination();
    };

    // Initialize Pagination on Load
    window.renderCreativePagination();
// ==========================================
    // F. REPORTS PAGE LOGIC
    // ==========================================

    window.openReportModal = function() {
        const modal = document.getElementById('createReportModal');
        const content = document.getElementById('reportModalContent');
        if(modal) {
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                if(content) {
                    content.classList.remove('scale-95');
                    content.classList.add('scale-100');
                }
            }, 10);
        }
    };

    window.closeReportModal = function() {
        const modal = document.getElementById('createReportModal');
        const content = document.getElementById('reportModalContent');
        if(modal) {
            modal.classList.add('opacity-0');
            if(content) {
                content.classList.remove('scale-100');
                content.classList.add('scale-95');
            }
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }
    };
// ==========================================
    // F. REPORTS LOGIC (10 Rows, Bold Footer, Modals)
    // ==========================================

    // Sample Data
    const allReports = [
        { status: 'Active', name: 'Campaign_Performance_Q4', id: '#RPT-8832', type: 'Campaign Performance', date: '01 Oct 25 - 31 Dec 25', last: 'Today, 09:00 AM', schedule: 'Daily' },
        { status: 'Done', name: 'Transaction_Log_Nov', id: '#RPT-1209', type: 'Transaction Report', date: '01 Nov 25 - 30 Nov 25', last: '01 Dec 25, 10:30 AM', schedule: '-' },
        { status: 'Failed', name: 'SKU_Performance_v2', id: '#RPT-9921', type: 'SKU Performance', date: 'Last 30 Days', last: 'Failed at 04:00 AM', schedule: 'Weekly' },
        { status: 'Done', name: 'Wallet_History_2025', id: '#RPT-4452', type: 'Wallet History', date: '01 Jan 25 - Current', last: 'Yesterday, 06:00 PM', schedule: '-' },
        { status: 'Active', name: 'Ad_Spend_Analysis_Dec', id: '#RPT-7731', type: 'Ad Spend', date: '01 Dec 25 - 31 Dec 25', last: 'Today, 08:00 AM', schedule: 'Daily' },
        { status: 'Done', name: 'User_Acquisition_Q3', id: '#RPT-3321', type: 'User Report', date: '01 Jul 25 - 30 Sep 25', last: '05 Oct 25, 11:00 AM', schedule: '-' },
        { status: 'Active', name: 'Keyword_Ranking_Tracker', id: '#RPT-1129', type: 'Keyword Perf', date: 'Last 7 Days', last: 'Today, 07:30 AM', schedule: 'Daily' },
        { status: 'Done', name: 'Monthly_Traffic_Oct', id: '#RPT-5564', type: 'Traffic Analysis', date: '01 Oct 25 - 31 Oct 25', last: '01 Nov 25, 09:00 AM', schedule: '-' },
        { status: 'Done', name: 'Refund_Report_Q3', id: '#RPT-9988', type: 'Finance', date: '01 Jul 25 - 30 Sep 25', last: '02 Oct 25, 02:00 PM', schedule: '-' },
        { status: 'Active', name: 'Yearly_Forecast_2026', id: '#RPT-2231', type: 'Forecasting', date: 'Next 12 Months', last: 'Today, 12:00 PM', schedule: 'Monthly' },
        // Page 2 Items
        { status: 'Failed', name: 'Competitor_Analysis_v1', id: '#RPT-0012', type: 'Market Research', date: 'Last 90 Days', last: 'Failed at 03:00 AM', schedule: 'Weekly' },
        { status: 'Done', name: 'Holiday_Sales_Summary', id: '#RPT-7744', type: 'Sales Report', date: '25 Dec 25 - 31 Dec 25', last: '01 Jan 26, 10:00 AM', schedule: '-' }
    ];

    let currentReportPage = 1;
    const reportItemsPerPage = 10; // UPDATED to 10

    window.renderReports = function() {
        const tbody = document.getElementById('reportsTableBody');
        const paginationInfo = document.getElementById('reportPaginationInfo');
        if(!tbody) return;

        const start = (currentReportPage - 1) * reportItemsPerPage;
        const end = start + reportItemsPerPage;
        const pageData = allReports.slice(start, end);

        tbody.innerHTML = pageData.map(item => {
            let statusBadge = '';
            if(item.status === 'Active') statusBadge = `<span class="bg-green-100 text-green-700 border border-green-200 px-2 py-1 rounded-md font-bold text-[10px] flex items-center w-fit gap-1"><i class="ri-checkbox-circle-fill"></i> Active</span>`;
            else if(item.status === 'Done') statusBadge = `<span class="bg-gray-100 text-gray-600 border border-gray-200 px-2 py-1 rounded-md font-bold text-[10px] flex items-center w-fit gap-1"><i class="ri-check-double-line"></i> Done</span>`;
            else if(item.status === 'Failed') statusBadge = `<span class="bg-red-50 text-red-600 border border-red-100 px-2 py-1 rounded-md font-bold text-[10px] flex items-center w-fit gap-1"><i class="ri-error-warning-fill"></i> Failed</span>`;

            let lastRunClass = item.status === 'Failed' ? 'text-red-500 font-medium' : 'text-gray-500';

            return `
            <tr class="hover:bg-gray-50 transition group border-b border-gray-100">
                <td class="px-6 py-4">${statusBadge}</td>
                <td class="px-6 py-4">
                    <div class="font-bold text-gray-900">${item.name}</div>
                    <div class="text-[10px] text-gray-400">ID: ${item.id}</div>
                </td>
                <td class="px-6 py-4 text-gray-600">${item.type}</td>
                <td class="px-6 py-4 text-gray-700">${item.date}</td>
                <td class="px-6 py-4 ${lastRunClass}">${item.last}</td>
                <td class="px-6 py-4 text-gray-600">${item.schedule}</td>
                <td class="px-6 py-4 text-center">
                    <div class="flex justify-center gap-2 opacity-60 group-hover:opacity-100 transition">
                        <button class="w-7 h-7 flex items-center justify-center rounded hover:bg-gray-100 text-gray-600" title="History"><i class="ri-history-line"></i></button>
                        <button class="w-7 h-7 flex items-center justify-center rounded hover:bg-purple-50 text-primary font-bold" title="Download"><i class="ri-download-line"></i></button>
                        <button class="w-7 h-7 flex items-center justify-center rounded hover:bg-gray-100 text-gray-600"><i class="ri-more-2-fill"></i></button>
                    </div>
                </td>
            </tr>`;
        }).join('');

        // Update Info Text (Bold)
        paginationInfo.innerHTML = `Showing <span class="font-bold text-gray-800">${start + 1}-${Math.min(end, allReports.length)}</span> of <span class="font-bold text-gray-800">${allReports.length}</span> Reports`;

        // Update Buttons (With Icons)
        const btnPrev = document.getElementById('repPrevBtn');
        const btnNext = document.getElementById('repNextBtn');

        const baseClass = "flex items-center gap-1 px-3 py-1 bg-white border border-gray-200 rounded text-xs font-bold transition ";
        const disabledClass = "text-gray-500 cursor-not-allowed opacity-50";
        const activeClass = "text-gray-600 hover:bg-gray-50 cursor-pointer";

        if(btnPrev) {
            btnPrev.disabled = currentReportPage === 1;
            btnPrev.className = baseClass + (currentReportPage === 1 ? disabledClass : activeClass);
            btnPrev.innerHTML = `<i class="ri-arrow-left-s-line"></i> Previous`;
        }
        if(btnNext) {
            btnNext.disabled = end >= allReports.length;
            btnNext.className = baseClass + (end >= allReports.length ? disabledClass : activeClass);
            btnNext.innerHTML = `Next <i class="ri-arrow-right-s-line"></i>`;
        }
    };

    window.changeReportPage = function(direction) {
        currentReportPage += direction;
        renderReports();
    };

    // Modal Logic
    window.openReportModal = function() {
        const modal = document.getElementById('createReportModal');
        const content = document.getElementById('reportModalContent');
        if(modal) {
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                if(content) { content.classList.remove('scale-95'); content.classList.add('scale-100'); }
            }, 10);
        }
    };

    window.closeReportModal = function() {
        const modal = document.getElementById('createReportModal');
        const content = document.getElementById('reportModalContent');
        if(modal) {
            modal.classList.add('opacity-0');
            if(content) { content.classList.remove('scale-100'); content.classList.add('scale-95'); }
            setTimeout(() => { modal.classList.add('hidden'); }, 300);
        }
    };

    renderReports();
// ==========================================
    // G. SETTINGS PAGE LOGIC
    // ==========================================

    window.switchSettingsTab = function(tabName, btn) {
        // 1. Hide all contents
        document.querySelectorAll('.settings-content').forEach(content => {
            content.classList.add('hidden');
        });

        // 2. Show target content
        const target = document.getElementById('tab-' + tabName);
        if(target) target.classList.remove('hidden');

        // 3. Reset all buttons styling
        document.querySelectorAll('.settings-tab').forEach(b => {
            // Reset to inactive style
            b.className = "settings-tab w-full text-left px-4 py-3 rounded-lg text-sm font-medium flex items-center gap-3 text-gray-600 hover:bg-white hover:shadow-sm border border-transparent transition-all";
        });

        // 4. Highlight clicked button
        // Apply active style (Purple background, Bold text)
        btn.className = "settings-tab active w-full text-left px-4 py-3 rounded-lg text-sm font-bold flex items-center gap-3 text-primary bg-purple-50 border border-purple-100 transition-all shadow-sm";
    };

    window.logout = function() {
        if(confirm("Are you sure you want to log out?")) {
            // For demo purposes, we just reload or alert
            alert("Logging out...");
            // window.location.href = 'login.html'; // In real app
        }
    };
// --- POPULATE CAMPAIGN VIEWS (GRID & COMFORTABLE) ---
    function populateCampaignViews() {
        const tableRows = document.querySelectorAll('#campaignTable tbody tr');
        const gridContainer = document.getElementById('viewGrid');
        const comfyContainer = document.getElementById('viewComfortable');

        if(!gridContainer || !comfyContainer) return;

        let gridHTML = '';
        let comfyHTML = '';

        tableRows.forEach(row => {
            const cells = row.querySelectorAll('td');
            // Extract data from the table row
            // We use safe extraction in case cells are missing
            const status = cells[0] ? cells[0].innerHTML : ''; 
            const name = cells[1] ? cells[1].innerText : 'Campaign';
            const type = cells[2] ? cells[2].innerText : '-';
            const budget = cells[3] ? cells[3].innerText : '-';
            const spend = cells[4] ? cells[4].innerText : '-';
            const impr = cells[5] ? cells[5].innerText : '-';
            const clicks = cells[6] ? cells[6].innerText : '-';
            const ctr = cells[7] ? cells[7].innerText : '-';

            // Template for Grid View Card
            gridHTML += `
                <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm hover:shadow-md transition flex flex-col h-full">
                    <div class="flex justify-between items-start mb-3">
                        <div class="font-bold text-gray-800 text-sm truncate pr-2" title="${name}">${name}</div>
                        ${status}
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-xs text-gray-600 mb-4 flex-grow">
                        <div class="bg-gray-50 p-2 rounded">Type: <span class="font-semibold block text-gray-900">${type}</span></div>
                        <div class="bg-gray-50 p-2 rounded">Budget: <span class="font-semibold block text-gray-900">${budget}</span></div>
                    </div>
                    <div class="border-t border-gray-100 pt-3 flex justify-between text-xs items-end mt-auto">
                        <div class="text-center">
                            <div class="text-gray-400 text-[10px] uppercase">Spend</div>
                            <div class="font-bold text-primary text-sm">${spend}</div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-400 text-[10px] uppercase">Impr</div>
                            <div class="font-bold text-gray-800 text-sm">${impr}</div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-400 text-[10px] uppercase">CTR</div>
                            <div class="font-bold text-orange-500 text-sm">${ctr}</div>
                        </div>
                    </div>
                </div>
            `;

            // Template for Comfortable View Card
            comfyHTML += `
                <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm hover:shadow-md transition flex flex-col sm:flex-row justify-between items-center gap-4">
                    <div class="flex items-center gap-4 w-full sm:w-auto">
                        <div class="w-12 h-12 rounded-full bg-purple-50 flex items-center justify-center text-primary border border-purple-100"><i class="ri-megaphone-fill text-xl"></i></div>
                        <div>
                            <div class="font-bold text-gray-800 text-sm">${name}</div>
                            <div class="text-xs text-gray-500 mt-1 flex items-center gap-2">
                                <span>${type}</span>
                                <span class="w-1 h-1 bg-gray-300 rounded-full"></span>
                                <span>Budget: ${budget}</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center justify-between w-full sm:w-auto gap-8 bg-gray-50 px-6 py-2 rounded-lg">
                        <div class="text-center">
                            <div class="text-[10px] text-gray-400 uppercase font-bold">Spend</div>
                            <div class="font-bold text-sm text-primary">${spend}</div>
                        </div>
                        <div class="text-center">
                            <div class="text-[10px] text-gray-400 uppercase font-bold">Clicks</div>
                            <div class="font-bold text-sm text-gray-800">${clicks}</div>
                        </div>
                        <div class="text-center">
                            <div class="text-[10px] text-gray-400 uppercase font-bold">CTR</div>
                            <div class="font-bold text-sm text-orange-500">${ctr}</div>
                        </div>
                    </div>
                    <div class="pl-4 border-l border-gray-100 hidden sm:block">
                        ${status}
                    </div>
                </div>
            `;
        });

        gridContainer.innerHTML = gridHTML;
        comfyContainer.innerHTML = comfyHTML;
    }

    // Call this function immediately
    populateCampaignViews();
</script>
<script>
    // Force render just in case
    setTimeout(function() {
        if(typeof renderAllCalendars === 'function') {
            renderAllCalendars();
        }
    }, 500);
// --- UNIVERSAL GRAPH INTERACTION LOGIC (Fixes All Pages) ---
document.querySelectorAll('.chart-container').forEach(container => {
    const graphArea = container.querySelector('.group'); // The hover area
    
    // Attempt to find dot/tooltip by ID (old way) or create them dynamically if missing
    let chartDot = container.querySelector('#chartDot') || container.querySelector('.chart-dot');
    let chartTooltip = container.querySelector('#chartTooltip') || container.querySelector('.chart-tooltip');
    
    // Fallback: If Elements are missing (Performance/Awareness pages), create them on the fly
    if (!chartDot) {
        chartDot = document.createElement('div');
        chartDot.className = 'chart-dot absolute w-3 h-3 bg-primary rounded-full border-2 border-white shadow-sm z-20 pointer-events-none transition-all duration-75 opacity-0 group-hover:opacity-100';
        graphArea.appendChild(chartDot);
    }
    if (!chartTooltip) {
        chartTooltip = document.createElement('div');
        chartTooltip.className = 'chart-tooltip absolute bg-white border border-gray-100 shadow-xl rounded-lg p-2 z-30 pointer-events-none transition-all duration-75 opacity-0 group-hover:opacity-100';
        chartTooltip.style.top = '20%';
        chartTooltip.style.minWidth = '140px';
        chartTooltip.innerHTML = '<div></div>';
        graphArea.appendChild(chartTooltip);
    }

    const chartTooltipText = chartTooltip.querySelector('div');
    // Find the first path (Purple line usually) to track
    const purpleLine = container.querySelector('path'); 

    if (graphArea && purpleLine) {
        graphArea.addEventListener('mousemove', (e) => {
            const rect = graphArea.getBoundingClientRect();
            let x = e.clientX - rect.left;
            let percent = (x / rect.width) * 100;
            percent = Math.max(0, Math.min(100, percent));

            // Calculate Y based on line path
            const pathLength = purpleLine.getTotalLength();
            const pointOnLine = purpleLine.getPointAtLength(pathLength * (percent / 100));
            const yPercent = (pointOnLine.y / 200) * 100; // Assuming 200 viewBox height

            // Apply positions
            chartDot.style.left = percent + '%';
            chartDot.style.top = yPercent + '%';
            chartTooltip.style.left = Math.min(percent, 85) + '%'; // Prevent tooltip going off-screen

            // Update Text
            const days = ["Nov 20", "Nov 21", "Nov 22", "Nov 23", "Nov 24", "Nov 25", "Nov 26"];
            const index = Math.round((percent / 100) * (days.length - 1));
            
            if (chartTooltipText && days[index]) {
                const visualSpend = Math.round((1 - (pointOnLine.y / 200)) * 100000);
                chartTooltipText.innerHTML = `
                    <div class="text-[10px] text-gray-400 font-bold mb-2">${days[index]}</div>
                    <div class="flex justify-between items-center mb-1"><span class="text-[10px] text-gray-600">Spend</span><span class="text-xs font-bold text-primary">${visualSpend.toLocaleString()}</span></div>
                    <div class="flex justify-between items-center mb-1"><span class="text-[10px] text-gray-600">Impr.</span><span class="text-xs font-bold text-lemon-green">${(0.8 + index * 0.1).toFixed(1)}M</span></div>
                    <div class="flex justify-between items-center mb-1"><span class="text-[10px] text-gray-600">CTR</span><span class="text-xs font-bold text-primary-orange">${(3 + index * 0.4).toFixed(1)}%</span></div>
                `;
            }
        });
    }
});
// --- FORCE CREATE WALLET MODAL ---
    window.openCreateWalletModal = function() {
        const modal = document.getElementById('createWalletModal');
        const content = document.getElementById('createWalletContent');
        
        if (modal && content) {
            // 1. Unhide
            modal.classList.remove('hidden');
            
            // 2. Animate In (Small delay ensures transition plays)
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                content.classList.remove('scale-95');
                content.classList.add('scale-100');
            }, 10);
        } else {
            console.error("Error: Modal elements not found. Check if HTML is pasted correctly.");
        }
    };

    window.closeCreateWalletModal = function() {
        const modal = document.getElementById('createWalletModal');
        const content = document.getElementById('createWalletContent');
        
        if (modal && content) {
            // 1. Animate Out
            modal.classList.add('opacity-0');
            content.classList.remove('scale-100');
            content.classList.add('scale-95');
            
            // 2. Hide after animation
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }
    };
// 1. PERFORMANCE VIEW TOGGLE (Updates Breadcrumbs & Button Logic & Full Table Data)
window.updatePerfView = function(element, type) {
    // A. Highlight Sidebar Link
    document.querySelectorAll('.perf-link').forEach(el => {
        el.classList.remove('text-white', 'font-bold', 'bg-white/10');
        el.classList.add('text-white/50');
    });
    element.classList.remove('text-white/50');
    element.classList.add('text-white', 'font-bold', 'bg-white/10');

    // B. Update Breadcrumb
    const breadcrumb = document.getElementById('breadcrumb-container');
    if(breadcrumb) {
        breadcrumb.innerHTML = `Home / Performance / <span class='text-primary font-bold'>${type}</span>`;
    }

    // C. Update "Create Campaign" Button Routing
    const createBtn = document.getElementById('createPerfBtn');
    if(createBtn) {
        const newBtn = createBtn.cloneNode(true);
        createBtn.parentNode.replaceChild(newBtn, createBtn);
        
        if(type === 'Smart Shopping') {
            newBtn.onclick = function() { openPerformanceCreator('smart-shopping'); };
        } else {
            newBtn.onclick = function() { openPerformanceCreator('search-only'); };
        }
    }

    // D. Update Table Rows (FULL 20 ROWS DATA)
    const tbody = document.getElementById('perfTableBody') || document.querySelector('#campaignTable tbody');
    if(tbody) {
        let rows = '';
        if(type === 'Smart Shopping') {
            // SMART SHOPPING DATA (20 ROWS)
            rows = `
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Catalog Sales - Best Sellers</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">150,000</td><td class="px-4 py-3 text-right">120,400</td><td class="px-4 py-3 text-right">5.2M</td><td class="px-4 py-3 text-right">3,400</td><td class="px-4 py-3 text-right">4.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Dynamic Retargeting Q4</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">80,000</td><td class="px-4 py-3 text-right">75,400</td><td class="px-4 py-3 text-right">2.8M</td><td class="px-4 py-3 text-right">1,200</td><td class="px-4 py-3 text-right">5.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Summer Collection Push</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">60,000</td><td class="px-4 py-3 text-right">42,000</td><td class="px-4 py-3 text-right">1.9M</td><td class="px-4 py-3 text-right">950</td><td class="px-4 py-3 text-right">3.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Flash Sale (Expired)</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">20,000</td><td class="px-4 py-3 text-right">5,000</td><td class="px-4 py-3 text-right">150K</td><td class="px-4 py-3 text-right">80</td><td class="px-4 py-3 text-right">2.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">New Arrivals Auto</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">45,000</td><td class="px-4 py-3 text-right">40,000</td><td class="px-4 py-3 text-right">1.1M</td><td class="px-4 py-3 text-right">890</td><td class="px-4 py-3 text-right">6.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">High Value Products</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">90,000</td><td class="px-4 py-3 text-right">88,000</td><td class="px-4 py-3 text-right">3.5M</td><td class="px-4 py-3 text-right">2,100</td><td class="px-4 py-3 text-right">4.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Holiday Special</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">100,000</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Clearance Stock</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">15,000</td><td class="px-4 py-3 text-right">14,500</td><td class="px-4 py-3 text-right">600K</td><td class="px-4 py-3 text-right">450</td><td class="px-4 py-3 text-right">7.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Accessories Cross-Sell</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">25,000</td><td class="px-4 py-3 text-right">12,000</td><td class="px-4 py-3 text-right">400K</td><td class="px-4 py-3 text-right">300</td><td class="px-4 py-3 text-right">3.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Brand Loyalty</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">35,000</td><td class="px-4 py-3 text-right">30,000</td><td class="px-4 py-3 text-right">900K</td><td class="px-4 py-3 text-right">800</td><td class="px-4 py-3 text-right">5.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Top Rated Items</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">70,000</td><td class="px-4 py-3 text-right">65,000</td><td class="px-4 py-3 text-right">2.5M</td><td class="px-4 py-3 text-right">1,500</td><td class="px-4 py-3 text-right">4.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Black Friday Deals</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">200,000</td><td class="px-4 py-3 text-right">198,000</td><td class="px-4 py-3 text-right">8.0M</td><td class="px-4 py-3 text-right">5,000</td><td class="px-4 py-3 text-right">6.0%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">End of Season</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">40,000</td><td class="px-4 py-3 text-right">38,000</td><td class="px-4 py-3 text-right">1.0M</td><td class="px-4 py-3 text-right">850</td><td class="px-4 py-3 text-right">3.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Cart Abandoners</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">55,000</td><td class="px-4 py-3 text-right">50,000</td><td class="px-4 py-3 text-right">1.8M</td><td class="px-4 py-3 text-right">1,100</td><td class="px-4 py-3 text-right">7.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Valentine Gift Ideas</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">80,000</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Skin Care Bundles</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">30,000</td><td class="px-4 py-3 text-right">28,500</td><td class="px-4 py-3 text-right">750K</td><td class="px-4 py-3 text-right">600</td><td class="px-4 py-3 text-right">4.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Hair Care Launch</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">95,000</td><td class="px-4 py-3 text-right">90,000</td><td class="px-4 py-3 text-right">3.0M</td><td class="px-4 py-3 text-right">2,500</td><td class="px-4 py-3 text-right">5.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Low Inventory Items</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">5,000</td><td class="px-4 py-3 text-right">2,000</td><td class="px-4 py-3 text-right">50K</td><td class="px-4 py-3 text-right">20</td><td class="px-4 py-3 text-right">1.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Regional Best Sellers</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">45,000</td><td class="px-4 py-3 text-right">40,000</td><td class="px-4 py-3 text-right">1.2M</td><td class="px-4 py-3 text-right">900</td><td class="px-4 py-3 text-right">4.6%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Influencer Picks</td><td class="px-4 py-3">Shopping</td><td class="px-4 py-3 text-right">120,000</td><td class="px-4 py-3 text-right">110,000</td><td class="px-4 py-3 text-right">4.0M</td><td class="px-4 py-3 text-right">3,000</td><td class="px-4 py-3 text-right">6.8%</td><td class="px-4 py-3 text-center">...</td></tr>
            `;
        } else {
            // SEARCH ONLY DATA (20 ROWS)
            rows = `
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Brand Keywords - Exact</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">25,000</td><td class="px-4 py-3 text-right">24,500</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">2,500</td><td class="px-4 py-3 text-right">12.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Competitor Conquesting</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">50,000</td><td class="px-4 py-3 text-right">38,000</td><td class="px-4 py-3 text-right">1.2M</td><td class="px-4 py-3 text-right">900</td><td class="px-4 py-3 text-right">3.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Generic Category Terms</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">100,000</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-yellow-50 text-yellow-600 px-2 py-1 rounded-md font-bold border border-yellow-100">Paused</span></td><td class="px-4 py-3 font-bold">Long Tail Keywords</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">10,000</td><td class="px-4 py-3 text-right">8,000</td><td class="px-4 py-3 text-right">400K</td><td class="px-4 py-3 text-right">320</td><td class="px-4 py-3 text-right">6.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Lipstick Generic</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">30,000</td><td class="px-4 py-3 text-right">28,000</td><td class="px-4 py-3 text-right">950K</td><td class="px-4 py-3 text-right">1,100</td><td class="px-4 py-3 text-right">8.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Eyeliner Broad</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">22,000</td><td class="px-4 py-3 text-right">20,000</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">750</td><td class="px-4 py-3 text-right">5.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Foundation Exact</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">40,000</td><td class="px-4 py-3 text-right">39,000</td><td class="px-4 py-3 text-right">1.5M</td><td class="px-4 py-3 text-right">1,800</td><td class="px-4 py-3 text-right">9.1%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Skincare Broad</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">15,000</td><td class="px-4 py-3 text-right">10,000</td><td class="px-4 py-3 text-right">500K</td><td class="px-4 py-3 text-right">400</td><td class="px-4 py-3 text-right">4.0%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Old Product Keywords</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">5,000</td><td class="px-4 py-3 text-right">4,500</td><td class="px-4 py-3 text-right">200K</td><td class="px-4 py-3 text-right">150</td><td class="px-4 py-3 text-right">2.8%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Gift Set Keywords</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">60,000</td><td class="px-4 py-3 text-right">55,000</td><td class="px-4 py-3 text-right">2.0M</td><td class="px-4 py-3 text-right">2,000</td><td class="px-4 py-3 text-right">10.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Winter Care Search</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">35,000</td><td class="px-4 py-3 text-right">32,000</td><td class="px-4 py-3 text-right">1.1M</td><td class="px-4 py-3 text-right">950</td><td class="px-4 py-3 text-right">5.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Serum Keywords</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">28,000</td><td class="px-4 py-3 text-right">25,000</td><td class="px-4 py-3 text-right">900K</td><td class="px-4 py-3 text-right">850</td><td class="px-4 py-3 text-right">6.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Face Wash Phrase</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">18,000</td><td class="px-4 py-3 text-right">15,000</td><td class="px-4 py-3 text-right">600K</td><td class="px-4 py-3 text-right">500</td><td class="px-4 py-3 text-right">3.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-gray-200 text-gray-600 px-2 py-1 rounded-md font-bold">Draft</span></td><td class="px-4 py-3 font-bold text-gray-500">Mascara Exact</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">20,000</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-right">-</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Nail Polish Broad</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">12,000</td><td class="px-4 py-3 text-right">10,000</td><td class="px-4 py-3 text-right">400K</td><td class="px-4 py-3 text-right">300</td><td class="px-4 py-3 text-right">4.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Blush Palette</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">16,000</td><td class="px-4 py-3 text-right">14,000</td><td class="px-4 py-3 text-right">550K</td><td class="px-4 py-3 text-right">450</td><td class="px-4 py-3 text-right">5.0%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Moisturizer Generic</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">45,000</td><td class="px-4 py-3 text-right">42,000</td><td class="px-4 py-3 text-right">1.5M</td><td class="px-4 py-3 text-right">1,200</td><td class="px-4 py-3 text-right">7.2%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-orange-50 text-orange-600 px-2 py-1 rounded-md font-bold border border-orange-100">Paused</span></td><td class="px-4 py-3 font-bold">Sunscreen Summer</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">50,000</td><td class="px-4 py-3 text-right">48,000</td><td class="px-4 py-3 text-right">1.8M</td><td class="px-4 py-3 text-right">1,500</td><td class="px-4 py-3 text-right">6.5%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Eye Shadow Terms</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">22,000</td><td class="px-4 py-3 text-right">20,000</td><td class="px-4 py-3 text-right">800K</td><td class="px-4 py-3 text-right">700</td><td class="px-4 py-3 text-right">4.9%</td><td class="px-4 py-3 text-center">...</td></tr>
                <tr class="hover:bg-secondary/30 transition"><td class="px-4 py-3"><span class="bg-secondary-green text-primary-green px-2 py-1 rounded-md font-bold">Active</span></td><td class="px-4 py-3 font-bold">Brand Name Misspellings</td><td class="px-4 py-3">Search</td><td class="px-4 py-3 text-right">5,000</td><td class="px-4 py-3 text-right">4,000</td><td class="px-4 py-3 text-right">100K</td><td class="px-4 py-3 text-right">50</td><td class="px-4 py-3 text-right">10.0%</td><td class="px-4 py-3 text-center">...</td></tr>
            `;
        }
        
        tbody.innerHTML = rows;
    }
};

// --- PERFORMANCE SUMMARY TABS (Full Data Update) ---
    window.switchSummaryTab = function(btn, type) {
        // 1. Update Tab Styles
        const container = btn.parentElement;
        container.querySelectorAll('.summary-tab').forEach(tab => {
            tab.className = "summary-tab text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 pb-1 transition";
        });
        btn.className = "summary-tab active text-sm font-bold text-primary border-b-2 border-primary pb-1 transition";

        // 2. Update Table Data
        const tbody = document.getElementById('summaryTableBody');
        if(!tbody) return;

        let rows = '';

        if(type === 'product') {
            // PRODUCT DATA (10 Rows)
            rows = `
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">FACES CANADA Weightless Matte Finish Foundation</td><td class="px-6 py-3">15.6 K</td><td class="px-6 py-3">37.9 K</td><td class="px-6 py-3">781</td><td class="px-6 py-3 font-bold">2.06%</td><td class="px-6 py-3">12.00</td><td class="px-6 py-3">150.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Magneteyes Kajal - Deep Black</td><td class="px-6 py-3">9,179</td><td class="px-6 py-3">29 K</td><td class="px-6 py-3">422</td><td class="px-6 py-3 font-bold">1.45%</td><td class="px-6 py-3">15.00</td><td class="px-6 py-3">180.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Peaches N Cream Tinted Moisturizer</td><td class="px-6 py-3">8,400</td><td class="px-6 py-3">18 K</td><td class="px-6 py-3">320</td><td class="px-6 py-3 font-bold">4.1%</td><td class="px-6 py-3">9.00</td><td class="px-6 py-3">100.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Ultime Pro HD Intense Matte Lips + Primer</td><td class="px-6 py-3">28,400</td><td class="px-6 py-3">95 K</td><td class="px-6 py-3">410</td><td class="px-6 py-3 font-bold">3.9%</td><td class="px-6 py-3">14.00</td><td class="px-6 py-3">130.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Canada Urban Glow Dark Spots Reducer</td><td class="px-6 py-3">5,200</td><td class="px-6 py-3">12 K</td><td class="px-6 py-3">150</td><td class="px-6 py-3 font-bold">1.8%</td><td class="px-6 py-3">18.00</td><td class="px-6 py-3">110.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Magneteyes Eyeliner - Black</td><td class="px-6 py-3">11,500</td><td class="px-6 py-3">32 K</td><td class="px-6 py-3">600</td><td class="px-6 py-3 font-bold">2.5%</td><td class="px-6 py-3">10.00</td><td class="px-6 py-3">140.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Berry Blush - Soft Pink</td><td class="px-6 py-3">6,800</td><td class="px-6 py-3">15 K</td><td class="px-6 py-3">280</td><td class="px-6 py-3 font-bold">3.1%</td><td class="px-6 py-3">16.00</td><td class="px-6 py-3">160.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Comfy Matte Liquid Lipstick</td><td class="px-6 py-3">18,900</td><td class="px-6 py-3">50 K</td><td class="px-6 py-3">900</td><td class="px-6 py-3 font-bold">4.8%</td><td class="px-6 py-3">13.00</td><td class="px-6 py-3">125.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Splash Nail Enamel - Red</td><td class="px-6 py-3">3,200</td><td class="px-6 py-3">8 K</td><td class="px-6 py-3">110</td><td class="px-6 py-3 font-bold">1.5%</td><td class="px-6 py-3">8.00</td><td class="px-6 py-3">90.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Vitamin C Serum 30ml</td><td class="px-6 py-3">22,100</td><td class="px-6 py-3">60 K</td><td class="px-6 py-3">1200</td><td class="px-6 py-3 font-bold">5.2%</td><td class="px-6 py-3">11.00</td><td class="px-6 py-3">145.00</td></tr>
            `;
        } else if(type === 'category') {
            rows = `
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Makeup > Face > Foundation</td><td class="px-6 py-3">45,000</td><td class="px-6 py-3">1.2M</td><td class="px-6 py-3">4,500</td><td class="px-6 py-3 font-bold">3.2%</td><td class="px-6 py-3">10.00</td><td class="px-6 py-3">120.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Makeup > Eyes > Kajal</td><td class="px-6 py-3">32,000</td><td class="px-6 py-3">800K</td><td class="px-6 py-3">2,200</td><td class="px-6 py-3 font-bold">2.8%</td><td class="px-6 py-3">14.00</td><td class="px-6 py-3">140.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Skincare > Moisturizers</td><td class="px-6 py-3">28,000</td><td class="px-6 py-3">600K</td><td class="px-6 py-3">1,800</td><td class="px-6 py-3 font-bold">4.5%</td><td class="px-6 py-3">11.00</td><td class="px-6 py-3">110.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Makeup > Lips > Lipstick</td><td class="px-6 py-3">55,000</td><td class="px-6 py-3">1.5M</td><td class="px-6 py-3">5,100</td><td class="px-6 py-3 font-bold">5.1%</td><td class="px-6 py-3">9.00</td><td class="px-6 py-3">130.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">Skincare > Serums</td><td class="px-6 py-3">40,000</td><td class="px-6 py-3">900K</td><td class="px-6 py-3">3,000</td><td class="px-6 py-3 font-bold">4.8%</td><td class="px-6 py-3">12.50</td><td class="px-6 py-3">150.00</td></tr>
            `;
        } else if(type === 'keyword') {
            rows = `
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">"matte lipstick"</td><td class="px-6 py-3">12,000</td><td class="px-6 py-3">500K</td><td class="px-6 py-3">2,000</td><td class="px-6 py-3 font-bold">5.5%</td><td class="px-6 py-3">6.00</td><td class="px-6 py-3">90.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">"waterproof eyeliner"</td><td class="px-6 py-3">8,500</td><td class="px-6 py-3">300K</td><td class="px-6 py-3">1,500</td><td class="px-6 py-3 font-bold">6.2%</td><td class="px-6 py-3">5.50</td><td class="px-6 py-3">85.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">"foundation for oily skin"</td><td class="px-6 py-3">15,000</td><td class="px-6 py-3">450K</td><td class="px-6 py-3">1,200</td><td class="px-6 py-3 font-bold">3.8%</td><td class="px-6 py-3">12.00</td><td class="px-6 py-3">150.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">"vitamin c serum"</td><td class="px-6 py-3">18,000</td><td class="px-6 py-3">600K</td><td class="px-6 py-3">2,500</td><td class="px-6 py-3 font-bold">4.9%</td><td class="px-6 py-3">8.50</td><td class="px-6 py-3">120.00</td></tr>
                <tr class="hover:bg-gray-50"><td class="px-6 py-3 font-medium text-gray-900">"long lasting kajal"</td><td class="px-6 py-3">9,000</td><td class="px-6 py-3">350K</td><td class="px-6 py-3">1,800</td><td class="px-6 py-3 font-bold">7.1%</td><td class="px-6 py-3">5.00</td><td class="px-6 py-3">100.00</td></tr>
            `;
        }

        tbody.innerHTML = rows;
    };
// --- MASTER GRAPH LOGIC (Fixes All Pages) ---
    window.updateGraph = function(btn, period) {
        // Step A: Find the graph container closest to the button that was clicked.
        const chartContainer = btn.closest('.chart-container');
        if (!chartContainer) return;

        // Step B: Update the Day/Week/Month buttons inside that specific container.
        const tabsContainer = btn.parentElement;
        Array.from(tabsContainer.children).forEach(c => c.className = "px-4 py-1 text-xs font-medium text-gray-500 hover:bg-white rounded-md transition");
        btn.className = "px-4 py-1 text-xs font-bold text-gray-900 bg-white shadow rounded-md transition";

        // Step C: Find the 4 graph lines inside that specific container.
        const line1 = chartContainer.querySelector('.graph-line-1'); // Purple
        const line2 = chartContainer.querySelector('.graph-line-2'); // Green
        const line3 = chartContainer.querySelector('.graph-line-3'); // Red
        const line4 = chartContainer.querySelector('.graph-line-4'); // Orange

        // Step D: Change the shape of the lines based on which button was clicked.
        if(period === 'day') {
            if(line1) line1.setAttribute('d', "M0,180 L150,120 L300,160 L450,40 L600,100 L800,20 L1000,80");
            if(line2) line2.setAttribute('d', "M0,150 C200,180 300,50 500,100 S800,150 1000,60");
            if(line3) line3.setAttribute('d', "M0,190 L200,180 L400,140 L600,120 L800,60 L1000,40");
            if(line4) line4.setAttribute('d', "M0,100 Q300,150 600,50 T1000,20");
        }
        else if(period === 'week') {
            if(line1) line1.setAttribute('d', "M0,160 Q250,20 500,120 T1000,40");
            if(line2) line2.setAttribute('d', "M0,180 L200,160 L400,100 L600,110 L800,90 L1000,70");
            if(line3) line3.setAttribute('d', "M0,140 C300,100 500,200 700,50 S1000,100");
            if(line4) line4.setAttribute('d', "M0,80 L250,60 L500,90 L750,40 L1000,10");
        }
        else if(period === 'month') {
            if(line1) line1.setAttribute('d', "M0,100 L100,80 L200,120 L300,60 L400,90 L500,40 L600,70 L700,30 L800,50 L900,20 L1000,60");
            if(line2) line2.setAttribute('d', "M0,120 Q500,200 1000,50");
            if(line3) line3.setAttribute('d', "M0,150 L1000,100");
            if(line4) line4.setAttribute('d', "M0,170 C200,150 400,180 600,100 S800,50 1000,10");
        }
    };
    // 2. OPEN PERFORMANCE CREATOR (Router Logic with Correct IDs & Breadcrumbs)
    window.openPerformanceCreator = function(type) {
        if (type === 'smart-shopping') {
            // Target the ROAS Page (ID Fixed in Correction 2)
            navigateTo('create-smart-shopping', 'nav-camp', `Home / Performance / Smart Shopping / <span class='text-primary font-bold'>Create</span>`);
        } 
        else if (type === 'search-only') {
            // Target the Manual Page
            navigateTo('create-search-only', 'nav-camp', `Home / Performance / Search Only / <span class='text-primary font-bold'>Create</span>`);
            
            // Init Bidding Rows for Manual (Wait for DOM)
            setTimeout(() => { 
                if(typeof addBiddingRow === 'function' && document.getElementById('bidding-rows-container')) {
                    if(document.getElementById('bidding-rows-container').children.length === 0) addBiddingRow();
                }
            }, 100);
        } 
        else {
            // Fallback (Selection Screen)
            navigateTo('create-performance', 'nav-camp', `Home / Create`);
        }
    };

    // 3. HELPER FOR MANUAL BIDDING (REQUIRED)
    function addBiddingRow(k='',m='Exact',b='0'){
        const c=document.getElementById('bidding-rows-container'); 
        if(!c)return; 
        const r=document.createElement('div'); 
        r.className="grid grid-cols-12 gap-3 items-center animate-fade-in"; 
        r.innerHTML=`<div class="col-span-6"><input type="text" value="${k}" class="w-full border border-gray-300 rounded-lg px-3 py-2.5 text-sm focus:border-primary focus:outline-none" placeholder="Enter keyword"></div><div class="col-span-3"><div class="relative"><select class="w-full border border-gray-300 rounded-lg px-3 py-2.5 text-sm focus:border-primary focus:outline-none bg-white appearance-none cursor-pointer"><option ${m==='Exact'?'selected':''}>Exact</option><option ${m==='Broad'?'selected':''}>Broad</option></select><i class="ri-arrow-down-s-line absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"></i></div></div><div class="col-span-2"><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-xs"></span><input type="number" value="${b}" class="w-full border border-gray-300 rounded-lg pl-6 pr-3 py-2.5 text-sm focus:border-primary focus:outline-none"></div></div><div class="col-span-1 flex justify-center"><button onclick="this.closest('.grid').remove()" class="text-gray-400 hover:text-red-500 transition p-2 rounded-full hover:bg-red-50"><i class="ri-delete-bin-line text-lg"></i></button></div>`; 
        c.appendChild(r);
    }

    // 4. SELECTION LOGIC (For the fallback screen)
    window.selectPerfType = function(type) {
        selectedPerfType = type;
        document.getElementById('select-smart-shopping').classList.toggle('selected', type === 'smart-shopping');
        document.getElementById('select-search-only').classList.toggle('selected', type === 'search-only');
    };

    window.goToPerfCreationPage = function() {
        if (selectedPerfType === 'smart-shopping') {
            navigateTo('create-smart-shopping', 'nav-camp', `Home / Performance / Smart Shopping / <span class='text-primary font-bold'>Create</span>`);
        } else if (selectedPerfType === 'search-only') {
            navigateTo('create-search-only', 'nav-camp', `Home / Performance / Search Only / <span class='text-primary font-bold'>Create</span>`);
        } else {
            alert("Please select a campaign type.");
        }
    };

// --- AWARENESS VIEW TOGGLE (Visibility & Takeover) ---
    window.selectedAwarenessType = 'Visibility'; // Default to Visibility
    
    window.updateAwarenessView = function(element, type) {
        // Ensure Awareness sub-menu is open when navigating
        const awSub = document.getElementById('awarenessSub');
        if (awSub && !awSub.classList.contains('open')) { window.toggleSubmenu('awarenessSub'); }

        window.selectedAwarenessType = type;
        
        // 1. HIGHLIGHT LOGIC
        document.querySelectorAll('.awareness-link').forEach(el => {
            el.classList.remove('text-white', 'font-bold', 'bg-white/10');
            el.classList.add('text-white/50'); 
        });
        element.classList.remove('text-white/50');
        element.classList.add('text-white', 'font-bold', 'bg-white/10');

        // 2. BREADCRUMB LOGIC
        const breadcrumb = document.getElementById('breadcrumb-container');
        if(breadcrumb) {
            breadcrumb.innerHTML = `Home / Campaigns / Awareness / <span class='text-primary font-bold'>${type}</span>`;
        }

        // 3. UPDATE BANNER TEXT AND RIGHT SIDE BASED ON TYPE
        const bannerTitle = document.getElementById('awareness-banner-title');
        const bannerDesc = document.getElementById('awareness-banner-desc');
        const bannerIllustration = document.getElementById('awareness-banner-illustration');
        const bannerCalendar = document.getElementById('awareness-banner-calendar');
        const takeoverBidSection = document.getElementById('takeover-bid-status-section');
        
        if (bannerTitle && bannerDesc) {
            if (type === 'Takeover') {
                bannerTitle.textContent = 'Own the Spotlight';
                bannerDesc.textContent = 'Own the spotlight for the dayguaranteed premium visibility on high-traffic pages, perfect for launches, sales, and big moments.';
                // Show calendar, hide illustration
                if (bannerIllustration) bannerIllustration.classList.add('hidden');
                if (bannerCalendar) bannerCalendar.classList.remove('hidden');
                // Show takeover bid section
                if (takeoverBidSection) takeoverBidSection.classList.remove('hidden');
            } else {
                bannerTitle.textContent = 'Boost Your Brand Reach';
                bannerDesc.textContent = 'Reach millions of new customers. Increase recall with high-impact visuals.';
                // Show illustration, hide calendar
                if (bannerIllustration) bannerIllustration.classList.remove('hidden');
                if (bannerCalendar) bannerCalendar.classList.add('hidden');
                // Hide takeover bid section
                if (takeoverBidSection) takeoverBidSection.classList.add('hidden');
            }
        }
    };
    
    
    // Bundles
    window.openBundleCreator = function(defaultTier) {
        navigateTo('create-bundle', '', `Home / Campaigns / Bundles / <span class='text-primary font-bold'>Create</span>`);
        if (defaultTier) {
            const sel = document.getElementById('bundleTierSelect');
            if (sel) sel.value = defaultTier;
        }
    };


        window.openAwarenessCreator = function(type, activeNavLinkId) {
        if (type === 'Visibility') {
            navigateTo('create-campaign', activeNavLinkId, `Home / Awareness / Visibility / <span class='text-primary font-bold'>Create Campaign</span>`);
            // Set campaign type flag for Step 1 restrictions
            window.currentCampaignType = 'visibility';
        } else if (type === 'Takeover') {
            // Takeover has its own wizard
            navigateTo('create-takeover', activeNavLinkId, `Home / Awareness / Takeover / <span class='text-primary font-bold'>Create Campaign</span>`);
            window.currentCampaignType = 'takeover';
            if (window.openTakeoverWizard) { window.openTakeoverWizard(); }
        }
        
        // Re-highlight the sidebar link
        if (activeNavLinkId) {
            const link = document.getElementById(activeNavLinkId);
            if (link) {
                document.querySelectorAll('.awareness-link').forEach(el => {
                    el.classList.remove('text-white', 'font-bold', 'bg-white/10');
                    el.classList.add('text-white/50');
                });
                link.classList.remove('text-white/50');
                link.classList.add('text-white', 'font-bold', 'bg-white/10');
            }
        }
    };
    
    // ==============================
    // TAKEOVER WIZARD (Awareness)
    // ==============================

    (function setupTakeoverWizard() {
        const MONTH = 1; // February (0-indexed)
        const YEAR = 2026;
        const IHB_START = 5;
        const IHB_END = 15;

        // State
        window.takeoverState = window.takeoverState || {
            step: 1,
            selectedDay: null,
            dayLabel: '',
            dayType: '',
            ihbDayIndex: null,
            takeoverType: '', // FULL_HP | HALF_HP | L1
            priceL: null,
            pageId: null,
            placementId: null,
            bidAmount: null // User's bid amount in Lakhs
        };

        // Minimum bids and expected impressions by takeover type
        const takeoverBidConfig = {
            'FULL_HP': { minBid: 7.5, impressionsMin: '10,00,000', impressionsMax: '12,00,000', impressionsLabel: '1 Million - 1.2 Million' },
            'HALF_HP': { minBid: 3.75, impressionsMin: '7,00,000', impressionsMax: '7,50,000', impressionsLabel: '7 Lakh - 7.5 Lakh' },
            'L1': { minBid: 2.5, impressionsMin: '1,50,000', impressionsMax: '2,50,000', impressionsLabel: '1.5 Lakh - 2.5 Lakh' }
        };

        const takeoverPages = [
            { id: 'home_27659', name: 'Home Page', pageId: 27659, pageType: 'home', icon: 'fa-solid fa-house' },

            // L1 Category Pages (explicit list; excludes Brand page & Shop More)
            { id: 'l1_21868', name: 'L1 Page Bath & Body', pageId: 21868, pageType: 'l1', icon: 'fa-solid fa-layer-group' },
            { id: 'l1_41682', name: 'L1 Page Combo', pageId: 41682, pageType: 'l1', icon: 'fa-solid fa-layer-group' },
            { id: 'l1_41520', name: 'L1 Page Feminine Hygiene', pageId: 41520, pageType: 'l1', icon: 'fa-solid fa-layer-group' },
            { id: 'l1_21032', name: 'L1 Page Fragrance', pageId: 21032, pageType: 'l1', icon: 'fa-solid fa-layer-group' },
            { id: 'l1_41626', name: 'L1 Page Haircare', pageId: 41626, pageType: 'l1', icon: 'fa-solid fa-layer-group' },
            { id: 'l1_41624', name: 'L1 Page Makeup', pageId: 41624, pageType: 'l1', icon: 'fa-solid fa-layer-group' },
            { id: 'l1_41622', name: 'L1 Page Skin', pageId: 41622, pageType: 'l1', icon: 'fa-solid fa-layer-group' }
        ];

        // Placements for Full Homepage Takeover (all require contacting Business Team)
        const fullHomepagePlacements = [
            { id: 'home_top_carousel', name: 'Top Carousel', contactRequired: true },
            { id: 'home_cover_widget_bg', name: 'Cover Widget Background', contactRequired: true },
            { id: 'home_cover_scroll', name: 'Cover Widget Scrollable Product Display', contactRequired: true },
            { id: 'home_thick_strip', name: 'Thick Strip Banner', contactRequired: true },
            { id: 'home_product_widget', name: 'Product Widget', contactRequired: true }
        ];

        // Placements for Half Homepage Takeover (all require contacting Business Team)
        const halfHomepagePlacements = [
            { id: 'home_cover_widget_bg', name: 'Cover Widget Background', contactRequired: true },
            { id: 'home_cover_scroll', name: 'Cover Widget Scrollable Product Display', contactRequired: true },
            { id: 'home_thick_strip', name: 'Thick Strip Banner', contactRequired: true }
        ];

        // Placements for L1 Category Takeover (all require contacting Business Team)
        const l1TakeoverPlacements = [
            { id: 'l1_cover_widget_bg', name: 'Cover Widget Background', contactRequired: true },
            { id: 'l1_cover_scroll', name: 'Cover Widget Scrollable Product Display', contactRequired: true },
            { id: 'l1_thin_banner', name: '"Powered by" Thin Banner', contactRequired: true }
        ];

        // Expose placement arrays globally for toast lookups
        window.fullHomepagePlacements = fullHomepagePlacements;
        window.halfHomepagePlacements = halfHomepagePlacements;
        window.l1TakeoverPlacements = l1TakeoverPlacements;

        // Legacy structure kept for compatibility
        const takeoverPlacements = {
            'home_27659': fullHomepagePlacements,
            'l1_21868': l1TakeoverPlacements,
            'l1_41682': l1TakeoverPlacements,
            'l1_41520': l1TakeoverPlacements,
            'l1_21032': l1TakeoverPlacements,
            'l1_41626': l1TakeoverPlacements,
            'l1_41624': l1TakeoverPlacements,
            'l1_41622': l1TakeoverPlacements
        };

        // Helper to get placements based on takeover type
        function getPlacementsForTakeoverType(takeoverType, pageId) {
            if (takeoverType === 'FULL_HP') return fullHomepagePlacements;
            if (takeoverType === 'HALF_HP') return halfHomepagePlacements;
            if (takeoverType === 'L1') return l1TakeoverPlacements;
            return [];
        }

        function takeoverTypeLabel(type) {
            if (type === 'FULL_HP') return 'Full Homepage takeover';
            if (type === 'HALF_HP') return 'Half Homepage takeover';
            if (type === 'L1') return 'L1 category takeover';
            return '';
        }

        function formatPriceL(priceL) {
            if (priceL == null) return '';
            return '' + priceL + 'L';
        }

        function dayTypeFor(day) {
            const d = new Date(YEAR, MONTH, day);
            const dow = d.getDay();
            const isWeekend = (dow === 0 || dow === 6);
            const isIhb = (day >= IHB_START && day <= IHB_END);
            if (isIhb) return 'IHB Sale';
            if (isWeekend) return 'Weekend Sale';
            return 'BAU';
        }

        function dateLabel(day) {
            const d = new Date(YEAR, MONTH, day);
            const opts = { weekday: 'short', day: '2-digit', month: 'short', year: 'numeric' };
            // en-GB gives DD Mon YYYY
            return d.toLocaleDateString('en-GB', opts).replace(',', '');
        }

        function ihbIndex(day) {
            return (day - IHB_START);
        }

        function pricingFor(dayType, takeoverType) {
            const isSale = (dayType === 'IHB Sale' || dayType === 'Weekend Sale');
            if (isSale) {
                if (takeoverType === 'FULL_HP') return 15;
                if (takeoverType === 'HALF_HP') return 7.5;
                if (takeoverType === 'L1') return 5;
            } else {
                if (takeoverType === 'FULL_HP') return 7.5;
                if (takeoverType === 'HALF_HP') return 3.75;
                if (takeoverType === 'L1') return 2.5;
            }
            return null;
        }

        function eligibleTypes(day) {
            const type = dayTypeFor(day);
            // IHB rules
            if (type === 'IHB Sale') {
                const idx = ihbIndex(day);
                const last = ihbIndex(IHB_END);
                if (idx === 0) return ['L1'];
                if (idx === 1) return ['FULL_HP'];
                if (idx === 2) return ['HALF_HP'];
                if (idx === last - 1) return ['HALF_HP'];
                if (idx === last) return ['FULL_HP'];
                // Other IHB days: keep only L1 to avoid ambiguity
                return ['L1'];
            }
            // BAU or Weekend: all allowed
            return ['FULL_HP','HALF_HP','L1'];
        }

        function cellBg(dayType) {
            if (dayType === 'IHB Sale') return '#fee2e2';
            if (dayType === 'Weekend Sale') return '#fef3c7';
            return '#f9fafb';
        }

        function renderCalendar() {
            const cal = document.getElementById('takeover-calendar');
            if (!cal) return;

            // Calendar header + weekdays
            const weekdays = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            const firstDay = new Date(YEAR, MONTH, 1);
            const startDow = firstDay.getDay();
            const daysInMonth = new Date(YEAR, MONTH + 1, 0).getDate();

            let html = '';
            html += '<div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:12px;">';
            html += '<div style="font-weight:800; color:#111827;">February 2026</div>';
            html += '<div style="font-size:12px; color:#64748b;">IHB Sale: Feb 515</div>';
            html += '</div>';

            html += '<div style="display:grid; grid-template-columns:repeat(7,1fr); gap:8px; margin-bottom:8px;">';
            weekdays.forEach(w => {
                html += '<div style="font-size:11px; color:#94a3b8; text-align:center; font-weight:700;">' + w + '</div>';
            });
            html += '</div>';

            html += '<div style="display:grid; grid-template-columns:repeat(7,1fr); gap:8px;">';
            // leading blanks
            for (let i=0;i<startDow;i++) {
                html += '<div></div>';
            }

            for (let day=1; day<=daysInMonth; day++) {
                const dt = dayTypeFor(day);
                const eligible = eligibleTypes(day);
                const isSelected = (window.takeoverState.selectedDay === day);

                const idx = (dt === 'IHB Sale') ? ihbIndex(day) : null;
                const idxLabel = (dt === 'IHB Sale') ? ('Day ' + idx) : '';

                const cellBorder = isSelected ? '2px solid #9c00ad' : '1px solid #e5e7eb';
                const cellShadow = isSelected ? 'box-shadow: 0 0 0 3px rgba(156, 0, 173, 0.1);' : '';
                html += '<div style="border:' + cellBorder + '; background:' + cellBg(dt) + '; border-radius:12px; padding:10px; min-height:128px; transition: all 0.15s ease; ' + cellShadow + '">';
                html += '<div style="display:flex; align-items:center; justify-content:space-between;">';
                html += '<div style="font-weight:800; color:#111827;">' + day + '</div>';
                html += '<div style="font-size:10px; color:#64748b;"><span style="font-weight:800;">' + (idxLabel || dt) + '</span></div>';
                html += '</div>';

                // options
                html += '<div style="display:flex; flex-direction:column; gap:6px; margin-top:10px;">';

                function optionButton(type, label) {
                    const allowed = eligible.indexOf(type) !== -1;
                    const price = pricingFor(dt, type);
                    const disabled = (!allowed);
                    const isThisSelected = (window.takeoverState.selectedDay === day && window.takeoverState.takeoverType === type);
                    
                    let btnStyle;
                    if (disabled) {
                        btnStyle = 'opacity:0.35; cursor:not-allowed; border:1px dashed #cbd5e1; background:#fff;';
                    } else if (isThisSelected) {
                        btnStyle = 'cursor:pointer; border:2px solid #9c00ad; background:#fdf1ff; box-shadow: 0 0 0 3px rgba(156, 0, 173, 0.15);';
                    } else {
                        btnStyle = 'cursor:pointer; border:1px solid #cbd5e1; background:#fff;';
                    }
                    
                    const checkIcon = isThisSelected ? '<i class="fa-solid fa-circle-check" style="color:#9c00ad; margin-right:6px;"></i>' : '';
                    const labelColor = isThisSelected ? 'color:#9c00ad;' : 'color:#111827;';
                    const priceColor = isThisSelected ? 'color:#9c00ad; font-weight:900;' : 'color:#0f172a;';
                    
                    return '<button data-day="' + day + '" data-type="' + type + '" ' + (disabled ? 'disabled' : '') + ' style="text-align:left; padding:8px 10px; border-radius:10px; font-size:11px; font-weight:800; display:flex; justify-content:space-between; align-items:center; transition: all 0.15s ease; ' + btnStyle + '">'
                        + '<span style="display:flex; align-items:center; ' + labelColor + '">' + checkIcon + label + '</span>'
                        + '<span style="' + priceColor + '">' + formatPriceL(price) + '</span>'
                        + '</button>';
                }

                html += optionButton('FULL_HP','Full Homepage');
                html += optionButton('HALF_HP','Half Homepage');
                html += optionButton('L1','L1 Category');

                html += '</div>';
                html += '</div>';
            }

            html += '</div>';
            cal.innerHTML = html;
        }

        function updateDaySummary() {
            const t = document.getElementById('takeover-day-summary-text');
            const p = document.getElementById('takeover-day-summary-price');
            if (!t || !p) return;

            if (!window.takeoverState.selectedDay || !window.takeoverState.takeoverType) {
                t.innerText = 'No day selected';
                p.innerText = '';
                return;
            }

            const day = window.takeoverState.selectedDay;
            const dt = window.takeoverState.dayType;
            const label = dateLabel(day);
            const idx = window.takeoverState.ihbDayIndex;
            const idxText = (dt === 'IHB Sale' && idx != null) ? (' (Day ' + idx + ')') : '';

            t.innerText = label + '  ' + dt + idxText + '  ' + takeoverTypeLabel(window.takeoverState.takeoverType);
            p.innerText = formatPriceL(window.takeoverState.priceL);
        }

        function resetInventorySelection() {
            window.takeoverState.pageId = null;
            window.takeoverState.placementId = null;
        }

        function allowedPagesForType() {
            const t = window.takeoverState.takeoverType;
            if (t === 'FULL_HP' || t === 'HALF_HP') {
                return takeoverPages.filter(p => p.id === 'home_27659');
            }
            // L1 takeover: only L1 category pages (exclude brand page)
            return takeoverPages.filter(p => p.pageType === 'l1');
        }

        function renderInventory() {
            const pageList = document.getElementById('takeover-page-list');
            const placeList = document.getElementById('takeover-placement-list');
            const summary = document.getElementById('takeover-summary');
            const summaryCount = document.getElementById('takeover-summary-count');
            if (!pageList || !placeList || !summary || !summaryCount) return;

            const takeoverType = window.takeoverState.takeoverType;
            const isHomepageTakeover = (takeoverType === 'FULL_HP' || takeoverType === 'HALF_HP');
            const isL1Takeover = (takeoverType === 'L1');

            // For Homepage takeovers, auto-select the homepage
            if (isHomepageTakeover && !window.takeoverState.pageId) {
                window.takeoverState.pageId = 'home_27659';
            }

            const pages = allowedPagesForType();
            const placements = getPlacementsForTakeoverType(takeoverType, window.takeoverState.pageId);

            // --- Pages (Left Column) ---
            if (isHomepageTakeover) {
                // For Full/Half Homepage: Show homepage as auto-selected (not clickable)
                const homePage = takeoverPages.find(p => p.id === 'home_27659');
                pageList.innerHTML = `
                    <div class="page-card selected" style="cursor: default; pointer-events: none;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <i class="${homePage.icon}" style="font-size: 20px; color: #9c00ad;"></i>
                            <div>
                                <div class="page-name" style="font-weight: 700; color: #111827;">${homePage.name}</div>
                                <div style="font-size: 11px; color: #9c00ad; font-weight: 600; margin-top: 4px;">
                                    <i class="fa-solid fa-circle-check" style="margin-right: 4px;"></i>Auto-selected for ${takeoverType === 'FULL_HP' ? 'Full' : 'Half'} Homepage Takeover
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (isL1Takeover) {
                // For L1 Takeover: Show L1 pages for selection
                pageList.innerHTML = `
                    <div style="font-size: 12px; color: #64748b; margin-bottom: 12px; font-weight: 600;">
                        <i class="fa-solid fa-info-circle" style="margin-right: 6px;"></i>Select an L1 category page
                    </div>
                ` + pages.map(p => {
                    const selected = (window.takeoverState.pageId === p.id) ? 'selected' : '';
                    return `
                        <div class="page-card ${selected}" data-page="${p.id}" style="cursor: pointer; padding: 14px; margin-bottom: 8px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <i class="${p.icon}" style="font-size: 18px; color: ${selected ? '#9c00ad' : '#64748b'};"></i>
                                <div class="page-name" style="font-weight: 600; color: ${selected ? '#9c00ad' : '#111827'};">${p.name}</div>
                                ${selected ? '<i class="fa-solid fa-circle-check" style="margin-left: auto; color: #9c00ad;"></i>' : ''}
                            </div>
                        </div>
                    `;
                }).join('');
            }

            // --- Placements (Middle Column) - Display included placements ---
            const showPlacements = isHomepageTakeover || (isL1Takeover && window.takeoverState.pageId);
            
            if (!showPlacements) {
                placeList.innerHTML = `
                    <div class="placeholder" style="height: 100%; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:10px; color:#64748b;">
                        <i class="fa-solid fa-hand-pointer" style="font-size:18px;"></i>
                        <p style="margin:0;">Select an L1 page to view included placements.</p>
                    </div>
                `;
            } else {
                let rows = '';
                placements.forEach(pl => {
                    const contactNote = pl.contactRequired 
                        ? `<div style="font-size: 10px; color: #f59e0b; margin-top: 4px;"><i class="fa-solid fa-phone" style="margin-right: 4px;"></i>Contact Business Team to enable</div>`
                        : '';
                    
                    rows += `
                        <tr style="background-color: #fdf1ff;">
                            <td style="padding: 14px;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <i class="fa-solid fa-image" style="color:#9c00ad; margin-top: 2px;"></i>
                                    <div>
                                        <div style="font-weight: 600; color: #111827;">${pl.name}</div>
                                        ${contactNote}
                                    </div>
                                </div>
                            </td>
                            <td style="padding: 14px; text-align: center;">
                                <span style="display: inline-flex; align-items: center; gap: 6px; color: #16a34a; font-weight: 700; font-size: 12px;">
                                    <i class="fa-solid fa-circle-check"></i> Included
                                </span>
                            </td>
                        </tr>
                    `;
                });

                const headerText = isHomepageTakeover 
                    ? `Placements included in ${takeoverType === 'FULL_HP' ? 'Full' : 'Half'} Homepage Takeover`
                    : 'Placements included in L1 Category Takeover';

                placeList.innerHTML = `
                    <div style="font-size: 12px; color: #64748b; margin-bottom: 12px; font-weight: 600;">
                        <i class="fa-solid fa-box-open" style="margin-right: 6px;"></i>${headerText}
                    </div>
                    <div class="placement-table-wrapper" style="border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                        <table class="placement-table" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f9fafb;">
                                    <th style="padding: 12px; text-align: left; font-size: 12px; color: #64748b; font-weight: 700;">Placement Name</th>
                                    <th style="padding: 12px; text-align: center; font-size: 12px; color: #64748b; font-weight: 700; width: 120px;">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${rows}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // --- Summary (Right Column) ---
            const page = takeoverPages.find(p => p.id === window.takeoverState.pageId);
            const placementCount = showPlacements ? placements.length : 0;
            summaryCount.textContent = placementCount;

            if (!page) {
                summary.innerHTML = `
                    <div class="placeholder" style="height: 100%; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:10px; color:#64748b;">
                        <i class="fa-solid fa-circle-info" style="font-size:18px;"></i>
                        <p style="margin:0; text-align:center;">Select a page to see the<br/>takeover package summary.</p>
                    </div>
                `;
            } else {
                const typeLabel = takeoverTypeLabel(takeoverType);
                const placementList = placements.map(pl => `
                    <div style="display: flex; align-items: center; gap: 8px; padding: 8px 0; border-bottom: 1px solid #f1f5f9;">
                        <i class="fa-solid fa-check" style="color: #16a34a; font-size: 10px;"></i>
                        <span style="font-size: 12px; color: #374151;">${pl.name}</span>
                        ${pl.contactRequired ? '<span style="font-size: 9px; color: #f59e0b; margin-left: auto;"><i class="fa-solid fa-phone"></i></span>' : ''}
                    </div>
                `).join('');

                summary.innerHTML = `
                    <div style="background: linear-gradient(135deg, #9c00ad, #7c3aed); color: white; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                        <div style="font-size: 11px; opacity: 0.8; margin-bottom: 4px;">TAKEOVER PACKAGE</div>
                        <div style="font-size: 14px; font-weight: 700;">${typeLabel}</div>
                    </div>
                    <div class="summary-card" style="margin-bottom: 12px;">
                        <div style="font-size: 11px; color: #64748b; font-weight: 600; margin-bottom: 6px;">PAGE</div>
                        <div style="font-size: 13px; font-weight: 700; color: #111827;">${page.name}</div>
                    </div>
                    <div class="summary-card">
                        <div style="font-size: 11px; color: #64748b; font-weight: 600; margin-bottom: 8px;">INCLUDED PLACEMENTS (${placementCount})</div>
                        ${placementList}
                    </div>
                `;
            }

            // --- Click Handlers (Only for L1 page selection) ---
            if (isL1Takeover) {
                pageList.querySelectorAll('.page-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const pageId = card.getAttribute('data-page');
                        if (pageId) {
                            window.takeoverState.pageId = pageId;
                            renderInventory();
                        }
                    });
                });
            }
        }

        function renderAdsStep() {
            const area = document.getElementById('takeover-ad-upload-area');
            const navList = document.getElementById('takeover-inventory-nav-list');
            const title = document.getElementById('takeover-ad-panel-title');
            const desc = document.getElementById('takeover-ad-panel-desc');
            const addBtn = document.getElementById('takeover-add-new-ad-btn');
            if (!area || !navList) return;

            const page = takeoverPages.find(p => p.id === window.takeoverState.pageId);
            const placementsAll = takeoverPlacements[window.takeoverState.pageId] || [];

            // Visibility parity: sidebar lists ONLY selected placements (takeover is single-select today)
            const selectedPlacements = window.takeoverState.placementId
                ? placementsAll.filter(pl => pl.id === window.takeoverState.placementId)
                : [];

            // Determine active placement for Ads step
            if (!window.takeoverState.activeAdPlacementId) {
                window.takeoverState.activeAdPlacementId = window.takeoverState.placementId || null;
            }
            const activePlacement = selectedPlacements.find(pl => pl.id === window.takeoverState.activeAdPlacementId) || null;
            const hasInv = !!(page && window.takeoverState.placementId);

            // Sidebar list (Visibility-style)
            if (!page || !selectedPlacements.length) {
                navList.innerHTML = `
                    <li class="inventory-nav-item active">
                        <div class="inventory-nav-title">Select an Inventory</div>
                        <div class="inventory-nav-sub">Choose a page & placement in Step 2.</div>
                    </li>
                `;
            } else {
                navList.innerHTML = selectedPlacements.map(pl => {
                    const isActive = (pl.id === window.takeoverState.activeAdPlacementId);
                    const activeClass = isActive ? 'active' : '';
                    return `
                        <li class="inventory-nav-item ${activeClass}" data-placement="${pl.id}">
                            <div class="inventory-nav-title">
                                ${pl.name}
                                <span class="tag" style="margin-left:8px; background:#ecfdf5; color:#065f46; border:1px solid #a7f3d0;">Selected</span>
                            </div>
                            <div class="inventory-nav-sub">${page.name}</div>
                        </li>
                    `;
                }).join('');
            }

            // Click handlers for sidebar
            navList.querySelectorAll('.inventory-nav-item[data-placement]').forEach(item => {
                item.addEventListener('click', () => {
                    window.takeoverState.activeAdPlacementId = item.getAttribute('data-placement');
                    renderAdsStep();
                });
            });

            // Right panel header copy
            if (title) title.innerText = activePlacement ? activePlacement.name : 'Select an Inventory';
            if (desc) {
                if (!page || !selectedPlacements.length) desc.innerText = 'Choose a page and placement in Step 2 to start uploading ads.';
                else desc.innerText = 'Upload creatives for the selected placement. New uploads go under review; approved creatives are eligible to serve.';
            }

            // New Ad button enabled only when placement is selected in Step 2
            if (addBtn) {
                addBtn.style.opacity = hasInv ? '1' : '0.5';
                addBtn.style.pointerEvents = hasInv ? 'auto' : 'none';
            }

            // Seed & render the grid (Visibility-style cards)
            window.takeoverState.adsByPlacement = window.takeoverState.adsByPlacement || {};

            const createCardHTML = (imgSrc, statusClass, statusText, iconClass) => `
                <div class="ad-card">
                    <div class="ad-image-wrapper">
                        <img src="${imgSrc}" alt="Ad Creative">
                        <div class="card-expand-icon" onclick="previewCreative(this)"><i class="fa-solid fa-expand"></i></div>
                    </div>
                    <div class="ad-card-footer">
                        <div class="ad-status-indicator ${statusClass}">
                            <i class="${iconClass}"></i> ${statusText}
                        </div>
                        <button class="delete-card-btn" title="Remove">
                            <i class="fa-solid fa-trash-can"></i>
                        </button>
                    </div>
                </div>
            `;

            const pid = window.takeoverState.activeAdPlacementId;

            if (pid && !window.takeoverState.adsByPlacement[pid]) {
                window.takeoverState.adsByPlacement[pid] = [
                    {
                        img: 'https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?auto=format&fit=crop&q=80&w=900',
                        statusClass: 'status-green',
                        statusText: 'Approved',
                        iconClass: 'fa-solid fa-circle-check'
                    },
                    {
                        img: 'https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&q=80&w=900',
                        statusClass: 'status-yellow',
                        statusText: 'Under Review',
                        iconClass: 'fa-solid fa-circle-notch fa-spin'
                    }
                ];
            }

            const cards = (pid && window.takeoverState.adsByPlacement[pid])
                ? window.takeoverState.adsByPlacement[pid].map(a => createCardHTML(a.img, a.statusClass, a.statusText, a.iconClass)).join('')
                : `<div class="placeholder" style="padding: 18px; color:#64748b;">Select a placement to view ads.</div>`;

            area.innerHTML = `<div class="ad-thumbnails-grid">${cards}</div>`;
        }

        // NEW: Render Bid Step (Step 3)
        function renderBidStep() {
            const summaryEl = document.getElementById('takeover-bid-summary');
            const impressionsEl = document.getElementById('takeover-expected-impressions');
            const minBidEl = document.getElementById('takeover-min-bid-display');
            const bidInput = document.getElementById('takeover-bid-input');
            const bidError = document.getElementById('takeover-bid-error');
            const bidSuccess = document.getElementById('takeover-bid-success');
            const bidErrorText = document.getElementById('takeover-bid-error-text');
            
            if (!summaryEl) return;

            const takeoverType = window.takeoverState.takeoverType;
            const config = takeoverBidConfig[takeoverType] || takeoverBidConfig['FULL_HP'];
            const page = takeoverPages.find(p => p.id === window.takeoverState.pageId);
            const day = window.takeoverState.selectedDay;
            const dayType = window.takeoverState.dayType;

            // Summary card at top
            const typeLabel = takeoverTypeLabel(takeoverType);
            const pageLabel = page ? page.name : '';
            const dayLabel = day ? dateLabel(day) : '';
            const dayTypeLabel = dayType || '';

            summaryEl.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; text-align: center;">
                    <div>
                        <div style="font-size: 11px; opacity: 0.8; margin-bottom: 4px;">TAKEOVER TYPE</div>
                        <div style="font-size: 14px; font-weight: 700;">${typeLabel}</div>
                    </div>
                    <div>
                        <div style="font-size: 11px; opacity: 0.8; margin-bottom: 4px;">PAGE</div>
                        <div style="font-size: 14px; font-weight: 700;">${pageLabel}</div>
                    </div>
                    <div>
                        <div style="font-size: 11px; opacity: 0.8; margin-bottom: 4px;">DATE</div>
                        <div style="font-size: 14px; font-weight: 700;">${dayLabel}</div>
                    </div>
                    <div>
                        <div style="font-size: 11px; opacity: 0.8; margin-bottom: 4px;">DAY TYPE</div>
                        <div style="font-size: 14px; font-weight: 700;">${dayTypeLabel}</div>
                    </div>
                </div>
            `;

            // Expected impressions
            impressionsEl.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div>
                        <div style="font-size: 12px; color: #64748b; margin-bottom: 4px;">Expected Impressions</div>
                        <div style="font-size: 20px; font-weight: 800; color: #111827;">${config.impressionsLabel}</div>
                    </div>
                    <div style="width: 48px; height: 48px; background: #ecfdf5; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="fa-solid fa-eye" style="color: #16a34a; font-size: 20px;"></i>
                    </div>
                </div>
            `;

            // Minimum bid display
            if (minBidEl) {
                minBidEl.textContent = '' + config.minBid + 'L';
            }

            // Set bid input value if exists
            if (bidInput && window.takeoverState.bidAmount !== null) {
                bidInput.value = window.takeoverState.bidAmount;
            }

            // Bid input validation on change
            if (bidInput && !bidInput.hasAttribute('data-listener-attached')) {
                bidInput.setAttribute('data-listener-attached', 'true');
                bidInput.addEventListener('input', function() {
                    const value = parseFloat(this.value);
                    const minBid = config.minBid;
                    
                    if (this.value === '' || isNaN(value)) {
                        bidError.style.display = 'none';
                        bidSuccess.style.display = 'none';
                        window.takeoverState.bidAmount = null;
                        return;
                    }
                    
                    window.takeoverState.bidAmount = value;
                    
                    if (value < minBid) {
                        bidErrorText.textContent = `Bid must be at least ${minBid}L (minimum bid for ${typeLabel})`;
                        bidError.style.display = 'block';
                        bidSuccess.style.display = 'none';
                        this.style.borderColor = '#dc2626';
                    } else {
                        bidError.style.display = 'none';
                        bidSuccess.style.display = 'block';
                        this.style.borderColor = '#16a34a';
                    }
                });
            }

            // Trigger validation if value exists
            if (bidInput && bidInput.value) {
                bidInput.dispatchEvent(new Event('input'));
            }
        }

        function renderConfigSummary() {
            const box = document.getElementById('takeover-config-summary');
            if (!box) return;

            const day = window.takeoverState.selectedDay;
            const dt = window.takeoverState.dayType;
            const idx = window.takeoverState.ihbDayIndex;
            const idxText = (dt === 'IHB Sale' && idx != null) ? ('Day ' + idx) : '';
            const page = takeoverPages.find(p => p.id === window.takeoverState.pageId);
            const takeoverType = window.takeoverState.takeoverType;
            const config = takeoverBidConfig[takeoverType] || {};
            const placements = getPlacementsForTakeoverType(takeoverType, window.takeoverState.pageId);
            const bidAmount = window.takeoverState.bidAmount;

            box.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                    <!-- Left Column: Booking Details -->
                    <div>
                        <div style="font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fa-solid fa-calendar-check" style="color: #9c00ad;"></i> Booking Details
                        </div>
                        
                        <div style="background: #f9fafb; border-radius: 8px; padding: 16px;">
                            <div style="display: grid; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                                    <span style="font-size: 13px; color: #64748b;">Date</span>
                                    <span style="font-size: 13px; font-weight: 700; color: #111827;">${day ? dateLabel(day) : ''}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                                    <span style="font-size: 13px; color: #64748b;">Day Type</span>
                                    <span style="font-size: 13px; font-weight: 700; color: #111827;">${dt ? (dt + (idxText ? '  ' + idxText : '')) : ''}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                                    <span style="font-size: 13px; color: #64748b;">Takeover Type</span>
                                    <span style="font-size: 13px; font-weight: 700; color: #9c00ad;">${takeoverTypeLabel(takeoverType)}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="font-size: 13px; color: #64748b;">Page</span>
                                    <span style="font-size: 13px; font-weight: 700; color: #111827;">${page ? page.name : ''}</span>
                                </div>
                            </div>
                        </div>

                        <div style="font-size: 14px; font-weight: 700; color: #111827; margin: 20px 0 12px 0; display: flex; align-items: center; gap: 8px;">
                            <i class="fa-solid fa-rectangle-ad" style="color: #9c00ad;"></i> Included Placements (${placements.length})
                        </div>
                        
                        <div style="background: #f9fafb; border-radius: 8px; padding: 12px;">
                            ${placements.map(pl => `
                                <div style="display: flex; align-items: center; gap: 8px; padding: 8px 0; ${placements.indexOf(pl) < placements.length - 1 ? 'border-bottom: 1px solid #e5e7eb;' : ''}">
                                    <i class="fa-solid fa-check-circle" style="color: #16a34a; font-size: 12px;"></i>
                                    <span style="font-size: 12px; color: #374151;">${pl.name}</span>
                                    ${pl.contactRequired ? '<span style="font-size: 9px; color: #f59e0b; margin-left: auto;"><i class="fa-solid fa-phone"></i></span>' : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Right Column: Bid Summary -->
                    <div>
                        <div style="font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                            <i class="fa-solid fa-gavel" style="color: #9c00ad;"></i> Bid Summary
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #9c00ad 0%, #7c3aed 100%); color: white; border-radius: 12px; padding: 24px; text-align: center;">
                            <div style="font-size: 12px; opacity: 0.8; margin-bottom: 8px;">YOUR BID AMOUNT</div>
                            <div style="font-size: 36px; font-weight: 800;">${bidAmount || 0}L</div>
                            <div style="font-size: 11px; opacity: 0.7; margin-top: 8px;">Minimum bid: ${config.minBid || 0}L</div>
                        </div>

                        <div style="background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <i class="fa-solid fa-chart-line" style="color: #16a34a;"></i>
                                <span style="font-size: 13px; font-weight: 700; color: #166534;">Expected Performance</span>
                            </div>
                            <div style="font-size: 12px; color: #166534;">
                                Estimated impressions: <strong>${config.impressionsLabel || ''}</strong>
                            </div>
                        </div>

                        <div style="background: #fef3c7; border: 1px solid #fde68a; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <div style="display: flex; align-items: flex-start; gap: 8px;">
                                <i class="fa-solid fa-info-circle" style="color: #d97706; margin-top: 2px;"></i>
                                <div style="font-size: 11px; color: #92400e; line-height: 1.5;">
                                    By submitting, you agree to the T&C. Bid results will be announced after the 20th. Creatives must be approved by the 24th.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Wizard navigation
        function goToTakeoverStep(step) {
            window.takeoverState.step = step;

            const stepper = document.getElementById('takeover-stepper');
            if (stepper) {
                stepper.querySelectorAll('.cc-step').forEach(el => {
                    el.classList.toggle('active', parseInt(el.getAttribute('data-step'),10) === step);
                });
            }
            for (let i=1;i<=4;i++) {
                const el = document.getElementById('takeover-step-' + i);
                if (el) el.classList.toggle('active', i === step);
            }

            const backBtn = document.getElementById('takeover-back-btn');
            const nextBtn = document.getElementById('takeover-next-btn');
            if (backBtn) backBtn.style.display = (step > 1) ? 'inline-block' : 'none';
            if (nextBtn) nextBtn.textContent = (step === 4) ? 'Submit for Approval' : 'Next';

            // Init step content
            if (step === 1) {
                renderCalendar();
                updateDaySummary();
            }
            if (step === 2) {
                renderInventory();
            }
            if (step === 3) {
                renderBidStep();
            }
            if (step === 4) {
                renderConfigSummary();
                
                // Add input listener for campaign name to clear errors
                const campaignNameInput = document.getElementById('takeover-campaign-name');
                const campaignNameError = document.getElementById('takeover-campaign-name-error');
                
                if (campaignNameInput && !campaignNameInput.dataset.listenerAdded) {
                    campaignNameInput.addEventListener('input', () => {
                        if (campaignNameInput.value.trim()) {
                            campaignNameInput.style.borderColor = '';
                            if (campaignNameError) {
                                campaignNameError.classList.add('hidden');
                                campaignNameError.style.display = 'none';
                            }
                        }
                    });
                    campaignNameInput.dataset.listenerAdded = 'true';
                }
            }
        }

        function showTakeoverError(msg) {
            // Reuse existing wizard toast
            let toast = document.getElementById('wizard-error-toast');
            if (!toast) {
                toast = document.createElement('div');
                toast.id = 'wizard-error-toast';
                toast.className = 'error-toast';
                document.body.appendChild(toast);
            }
            toast.innerHTML = '<i class="ri-error-warning-fill" style="color:#f87171; font-size:20px;"></i> ' + msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Calendar click handler (delegated)
        function hookCalendarClicks() {
            const cal = document.getElementById('takeover-calendar');
            if (!cal) return;
            cal.addEventListener('click', (e) => {
                const btn = e.target.closest('button[data-day][data-type]');
                if (!btn) return;
                const day = parseInt(btn.getAttribute('data-day'),10);
                const type = btn.getAttribute('data-type');

                window.takeoverState.selectedDay = day;
                window.takeoverState.dayType = dayTypeFor(day);
                window.takeoverState.ihbDayIndex = (window.takeoverState.dayType === 'IHB Sale') ? ihbIndex(day) : null;
                window.takeoverState.takeoverType = type;
                window.takeoverState.priceL = pricingFor(window.takeoverState.dayType, type);

                // Reset inventory if selection changes
                resetInventorySelection();

                renderCalendar();
                updateDaySummary();
            });
        }

        // Creative modal is initialised in the Visibility wizard code block and shared across modules.
        // For Takeover, we only need to ensure the shared modal handler supports the Takeover 'New Ad' button and grid.
                // Creative modal is shared across wizards (Visibility + Takeover).
        // This initialiser is idempotent and guarded by window.__creativeModalInitialized.
        function ensureCreativeModalReady() {
            if (window.__creativeModalInitialized) return;

            const modalBackdrop = document.getElementById('modal-backdrop');
            const createAdModal = document.getElementById('create-ad-modal');
            const previewImg = document.getElementById('live-preview-img');

            if (!createAdModal) return;

            const openModal = () => { if (modalBackdrop) modalBackdrop.style.display = 'block'; createAdModal.style.display = 'flex'; };
            const closeModal = () => { if (modalBackdrop) modalBackdrop.style.display = 'none'; createAdModal.style.display = 'none'; };

            // Helper: choose the correct grid depending on which wizard is currently open
            const getActiveAdGrid = () => {
                const takeoverVisible = document.getElementById('page-create-takeover') && !document.getElementById('page-create-takeover').classList.contains('hidden');
                if (takeoverVisible) return document.querySelector('#takeover-ad-upload-area .ad-thumbnails-grid');
                return document.querySelector('#ad-upload-area .ad-thumbnails-grid');
            };

            // Helper to generate Card HTML
            const createCardHTML = (imgSrc, statusClass, statusText, iconClass) => `
                <div class="ad-card">
                    <div class="ad-image-wrapper">
                        <img src="${imgSrc}" alt="Ad Creative">
                        <div class="card-expand-icon" onclick="previewCreative(this)"><i class="fa-solid fa-expand"></i></div>
                    </div>
                    <div class="ad-card-footer">
                        <div class="ad-status-indicator ${statusClass}">
                            <i class="${iconClass}"></i> ${statusText}
                        </div>
                        <div class="ad-actions">
                            <i class="ri-eye-line action-icon-btn" style="font-size: 18px;" onclick="previewCreative(this)" title="Preview"></i>
                            <i class="ri-delete-bin-line action-icon-btn delete-card-btn" style="font-size: 18px;" title="Delete Ad"></i>
                        </div>
                    </div>
                </div>`;

            // File Upload Handlers
            const handleFileUpload = (file, labelEl, iconEl, overlayId) => {
                const overlay = document.getElementById(overlayId);
                if (!file) return;
                if (file.size > 1048576) {
                    if (window.showWizardError) window.showWizardError("Image size should be less than 1MB");
                    else alert("Image size should be less than 1MB");
                    return;
                }
                const img = new Image();
                img.src = URL.createObjectURL(file);
                img.onload = function() {
                    if (this.width !== 320 || this.height !== 420) {
                        const msg = `Dimensions don't match (Expected 320x420, Got ${this.width}x${this.height})`;
                        if (window.showWizardError) window.showWizardError(msg);
                        else alert(msg);
                    } else {
                        if (labelEl) { labelEl.style.color = "var(--cc-primary-green)"; labelEl.innerText = file.name; }
                        if (iconEl) { iconEl.className = "ri-check-line"; iconEl.style.color = "var(--cc-primary-green)"; }
                        if (previewImg) { previewImg.src = img.src; previewImg.style.opacity = "1"; }
                        if (overlay) overlay.classList.add('has-file');
                    }
                };
            };

            const resetFile = (inputId, labelId, iconId, overlayId, defaultText) => {
                const input = document.getElementById(inputId);
                const label = document.getElementById(labelId);
                const icon = document.getElementById(iconId);
                const overlay = document.getElementById(overlayId);
                if (input) input.value = "";
                if (label) { label.innerText = defaultText; label.style.color = "#475569"; }
                if (icon) { icon.className = inputId.includes('web') ? "ri-upload-cloud-2-line" : "ri-smartphone-line"; icon.style.color = "#cbd5e1"; }
                if (overlay) overlay.classList.remove('has-file');
                if (previewImg) { previewImg.src = "https://via.placeholder.com/400x500.png?text=Ad+Preview"; previewImg.style.opacity = "0.5"; }
            };

            const webInput = document.getElementById('web-upload-input');
            const appInput = document.getElementById('app-upload-input');
            if (webInput) webInput.addEventListener('change', function() { if (this.files && this.files[0]) handleFileUpload(this.files[0], document.getElementById('web-upload-label'), document.getElementById('web-icon'), 'web-overlay'); });
            if (appInput) appInput.addEventListener('change', function() { if (this.files && this.files[0]) handleFileUpload(this.files[0], document.getElementById('app-upload-label'), document.getElementById('app-icon'), 'app-overlay'); });

            const webDel = document.getElementById('web-delete-btn');
            const appDel = document.getElementById('app-delete-btn');
            if (webDel) webDel.addEventListener('click', (e) => { e.stopPropagation(); resetFile('web-upload-input', 'web-upload-label', 'web-icon', 'web-overlay', 'Web Image'); });
            if (appDel) appDel.addEventListener('click', (e) => { e.stopPropagation(); resetFile('app-upload-input', 'app-upload-label', 'app-icon', 'app-overlay', 'App Image'); });

            // SAVE LOGIC
            const saveBtn = document.getElementById('save-ad-btn');
            if (saveBtn) {
                const newBtn = saveBtn.cloneNode(true);
                saveBtn.parentNode.replaceChild(newBtn, saveBtn);
                newBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const nameInput = document.getElementById('ad-name-input');
                    if (!nameInput || !nameInput.value.trim()) {
                        if (window.showWizardError) window.showWizardError("Please add Name");
                        else alert("Please add Name");
                        return;
                    }
                    if ((!webInput || !webInput.files.length) && (!appInput || !appInput.files.length)) {
                        if (window.showWizardError) window.showWizardError("Please upload at least one creative");
                        else alert("Please upload at least one creative");
                        return;
                    }
                    closeModal();

                    const grid = getActiveAdGrid();
                    if (grid) {
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = createCardHTML(previewImg ? previewImg.src : '', 'status-yellow', 'Under Review', 'fa-solid fa-circle-notch fa-spin');
                        grid.appendChild(tempDiv.firstElementChild);
                    
                            // Persist in Takeover state so switching placements retains the card (prototype behavior)
                            try {
                                const takeoverVisible = !document.getElementById('page-create-takeover').classList.contains('hidden');
                                if (takeoverVisible && window.takeoverState) {
                                    const pid = window.takeoverState.activeAdPlacementId || window.takeoverState.placementId;
                                    if (pid) {
                                        window.takeoverState.adsByPlacement = window.takeoverState.adsByPlacement || {};
                                        window.takeoverState.adsByPlacement[pid] = window.takeoverState.adsByPlacement[pid] || [];
                                        window.takeoverState.adsByPlacement[pid].unshift({
                                            img: previewImg && previewImg.src ? previewImg.src : '',
                                            statusClass: 'status-yellow',
                                            statusText: 'Under Review',
                                            iconClass: 'fa-solid fa-circle-notch fa-spin'
                                        });
                                    }
                                }
                            } catch (e) {}
}
                });
            }

            // GLOBAL CLICKS (Modal & Delete Card)
            document.body.addEventListener('click', (e) => {
                // Modal Open/Close
                if (e.target.closest('#add-new-ad-btn') || e.target.closest('#takeover-add-new-ad-btn')) openModal();
                if (e.target.closest('.close-btn') || e.target === modalBackdrop) closeModal();

                // DELETE CARD LOGIC
                const delBtn = e.target.closest('.delete-card-btn');
                if (delBtn) {
                    const card = delBtn.closest('.ad-card');
                    if (card) card.remove();
                }
            });

            window.__creativeModalInitialized = true;
        }

        function validateStep(step) {
            if (step === 1) {
                if (!window.takeoverState.selectedDay || !window.takeoverState.takeoverType) {
                    showTakeoverError('Please select a day and takeover type');
                    return false;
                }
                return true;
            }
            if (step === 2) {
                // For L1 takeover, user must select a page
                // For Full/Half HP, page is auto-selected
                if (!window.takeoverState.pageId) {
                    showTakeoverError('Please select an L1 category page');
                    return false;
                }
                // Placements are now automatically included based on takeover type, no selection needed
                return true;
            }
            if (step === 3) {
                // Validate bid amount
                const bidAmount = window.takeoverState.bidAmount;
                const takeoverType = window.takeoverState.takeoverType;
                const config = takeoverBidConfig[takeoverType];
                
                if (bidAmount === null || bidAmount === undefined || isNaN(bidAmount)) {
                    showTakeoverError('Please enter a bid amount');
                    return false;
                }
                
                if (bidAmount < config.minBid) {
                    showTakeoverError(`Bid must be at least ${config.minBid}L for ${takeoverTypeLabel(takeoverType)}`);
                    return false;
                }
                return true;
            }
            if (step === 4) {
                // Validate campaign name
                const campaignNameInput = document.getElementById('takeover-campaign-name');
                const campaignNameError = document.getElementById('takeover-campaign-name-error');
                
                if (!campaignNameInput || !campaignNameInput.value.trim()) {
                    showTakeoverError('Please enter a Campaign Name');
                    if (campaignNameError) {
                        campaignNameError.classList.remove('hidden');
                        campaignNameError.style.display = 'flex';
                    }
                    if (campaignNameInput) {
                        campaignNameInput.style.borderColor = '#dc2626';
                        campaignNameInput.focus();
                    }
                    return false;
                } else {
                    if (campaignNameError) {
                        campaignNameError.classList.add('hidden');
                        campaignNameError.style.display = 'none';
                    }
                    if (campaignNameInput) {
                        campaignNameInput.style.borderColor = '';
                    }
                }
                return true;
            }
            return true;
        }

        function hookFooterButtons() {
            const backBtn = document.getElementById('takeover-back-btn');
            const nextBtn = document.getElementById('takeover-next-btn');
            if (backBtn) backBtn.addEventListener('click', () => {
                if (window.takeoverState.step > 1) goToTakeoverStep(window.takeoverState.step - 1);
            });
            if (nextBtn) nextBtn.addEventListener('click', () => {
                const s = window.takeoverState.step;
                if (!validateStep(s)) return;
                if (s < 4) {
                    goToTakeoverStep(s + 1);
                } else {
                    // Show success modal instead of alert
                    showTakeoverSuccessModal();
                    window.navigateTo('awareness', 'nav-overview', 'Home');
                }
            });
        }

        // Initialise when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            // Ensure calendar is interactive
            hookCalendarClicks();
            hookFooterButtons();

            // Stepper click support
            const stepper = document.getElementById('takeover-stepper');
            if (stepper) {
                stepper.querySelectorAll('.cc-step').forEach(el => {
                    el.addEventListener('click', () => {
                        const s = parseInt(el.getAttribute('data-step'),10);
                        // Only allow navigation forward if current step is valid
                        if (s > window.takeoverState.step) {
                            if (!validateStep(window.takeoverState.step)) return;
                        }
                        goToTakeoverStep(s);
                    });
                });
            }

            // Takeover: ensure first render when page is visited
            // (goToTakeoverStep will be invoked when navigating to this page)
        });

        // Expose a helper so navigation can initialise correctly
        window.openTakeoverWizard = function() {
            // Reset wizard state (for demo)
            window.takeoverState.step = 1;
            window.takeoverState.selectedDay = null;
            window.takeoverState.dayType = '';
            window.takeoverState.ihbDayIndex = null;
            window.takeoverState.takeoverType = '';
            window.takeoverState.priceL = null;
            window.takeoverState.bidAmount = null;
            resetInventorySelection();

            // Reset bid input if exists
            const bidInput = document.getElementById('takeover-bid-input');
            if (bidInput) bidInput.value = '';

            goToTakeoverStep(1);
        };

        // ================== TAKEOVER SUCCESS MODAL ==================
        window.showTakeoverSuccessModal = function() {
            const overlay = document.getElementById('takeover-success-overlay');
            const summary = document.getElementById('takeover-success-summary');
            
            if (!overlay) return;

            // Build summary from state
            const state = window.takeoverState;
            const typeLabel = state.takeoverType === 'FULL_HP' ? 'Full Homepage Takeover' 
                            : state.takeoverType === 'HALF_HP' ? 'Half Homepage Takeover' 
                            : 'L1 Category Takeover';
            
            const pageName = state.takeoverType === 'L1' 
                ? (takeoverPages.find(p => p.id === state.pageId)?.name || 'L1 Page')
                : 'Homepage';

            if (summary) {
                summary.innerHTML = `
                    <div class="grid grid-cols-2 gap-3 text-sm">
                        <div>
                            <div class="text-gray-500 text-xs">Takeover Type</div>
                            <div class="font-bold text-gray-900">${typeLabel}</div>
                        </div>
                        <div>
                            <div class="text-gray-500 text-xs">Page</div>
                            <div class="font-bold text-gray-900">${pageName}</div>
                        </div>
                        <div>
                            <div class="text-gray-500 text-xs">Date</div>
                            <div class="font-bold text-gray-900">${state.selectedDay || 'N/A'} February 2026</div>
                        </div>
                        <div>
                            <div class="text-gray-500 text-xs">Your Bid</div>
                            <div class="font-bold text-green-600">${state.bidAmount ? state.bidAmount.toLocaleString() : '0'}</div>
                        </div>
                    </div>
                `;
            }

            overlay.classList.remove('hidden');
        };

        window.closeTakeoverSuccessModal = function() {
            const overlay = document.getElementById('takeover-success-overlay');
            if (overlay) overlay.classList.add('hidden');
        };

        // ================== TAKEOVER DETAILS DRAWER ==================
        window.openTakeoverDetailsDrawer = function(bidId) {
            const overlay = document.getElementById('takeover-details-overlay');
            const drawer = document.getElementById('takeover-details-drawer');
            const content = document.getElementById('takeover-details-content');
            
            if (!overlay || !drawer || !content) return;

            // Mock bid data (in real app this would come from backend)
            const bidData = {
                'full_hp_7feb': {
                    type: 'Full Homepage Takeover',
                    status: 'won',
                    page: 'Homepage',
                    date: '7th February 2026',
                    dayType: 'Weekend',
                    floorBid: 750000,
                    yourBid: 1000000,
                    submittedOn: '18th January 2026',
                    expectedImpressions: '1M - 1.2M',
                    placements: ['Top Carousel', 'Cover Widget Background', 'Cover Widget Scrollable', 'Thick Strip Banner', 'Product Widget']
                },
                'half_hp_7feb': {
                    type: 'Half Homepage Takeover',
                    status: 'rejected',
                    page: 'Homepage',
                    date: '7th February 2026',
                    dayType: 'Weekend',
                    floorBid: 375000,
                    yourBid: 600000,
                    submittedOn: '18th January 2026',
                    expectedImpressions: '700K - 750K',
                    rejectionReason: 'Full Homepage Takeover was won for this day. All Half Homepage bids are auto-rejected when Full Homepage is booked.',
                    placements: ['Cover Widget Background', 'Cover Widget Scrollable', 'Thick Strip Banner']
                },
                'l1_skin_8feb': {
                    type: 'L1 Skin Takeover',
                    status: 'won',
                    page: 'L1 Page Skin',
                    date: '8th February 2026',
                    dayType: 'BAU',
                    floorBid: 250000,
                    yourBid: 400000,
                    submittedOn: '19th January 2026',
                    expectedImpressions: '150K - 250K',
                    placements: ['Cover Widget Background', 'Cover Widget Scrollable', '"Powered by" Thin Banner']
                }
            };

            const bid = bidData[bidId];
            if (!bid) return;

            // Status badge
            let statusBadge = '';
            if (bid.status === 'won') {
                statusBadge = '<span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full"><i class="ri-check-line"></i> Bid Won</span>';
            } else if (bid.status === 'rejected') {
                statusBadge = '<span class="px-3 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full"><i class="ri-close-line"></i> Bid Rejected</span>';
            }

            content.innerHTML = `
                <div class="space-y-6">
                    <!-- Header -->
                    <div class="flex items-start justify-between">
                        <div>
                            <h3 class="font-bold text-gray-900 text-lg">${bid.type}</h3>
                            <p class="text-sm text-gray-500 mt-1">${bid.page}  ${bid.date}</p>
                        </div>
                        ${statusBadge}
                    </div>

                    <!-- Bid Info -->
                    <div class="bg-gray-50 rounded-xl p-4">
                        <div class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Bid Information</div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-xs text-gray-500">Floor Bid</div>
                                <div class="font-bold text-gray-900">${bid.floorBid.toLocaleString()}</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500">Your Bid</div>
                                <div class="font-bold ${bid.status === 'rejected' ? 'text-red-600' : 'text-green-600'}">${bid.yourBid.toLocaleString()}</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500">Day Type</div>
                                <div class="font-semibold text-gray-700">${bid.dayType}</div>
                            </div>
                            <div>
                                <div class="text-xs text-gray-500">Submitted On</div>
                                <div class="font-semibold text-gray-700">${bid.submittedOn}</div>
                            </div>
                        </div>
                    </div>

                    <!-- Expected Performance -->
                    <div class="bg-purple-50 rounded-xl p-4">
                        <div class="text-xs font-bold text-purple-600 uppercase tracking-wider mb-2">Expected Performance</div>
                        <div class="flex items-center gap-2">
                            <i class="ri-eye-line text-purple-500"></i>
                            <span class="font-bold text-purple-900">${bid.expectedImpressions} impressions</span>
                        </div>
                    </div>

                    ${bid.rejectionReason ? `
                        <div class="bg-red-50 border border-red-100 rounded-xl p-4">
                            <div class="text-xs font-bold text-red-600 uppercase tracking-wider mb-2">Rejection Reason</div>
                            <p class="text-sm text-red-700">${bid.rejectionReason}</p>
                        </div>
                    ` : ''}

                    <!-- Placements -->
                    <div>
                        <div class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Included Placements</div>
                        <div class="space-y-2">
                            ${bid.placements.map(p => `
                                <div class="flex items-center gap-2 text-sm text-gray-700">
                                    <i class="ri-checkbox-circle-line text-green-500"></i>
                                    ${p}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Timeline -->
                    <div>
                        <div class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Timeline</div>
                        <div class="space-y-3">
                            <div class="flex gap-3 text-sm">
                                <div class="w-2 h-2 bg-green-500 rounded-full mt-1.5"></div>
                                <div>
                                    <div class="font-semibold text-gray-900">Bid Submitted</div>
                                    <div class="text-gray-500 text-xs">${bid.submittedOn}</div>
                                </div>
                            </div>
                            <div class="flex gap-3 text-sm">
                                <div class="w-2 h-2 ${bid.status === 'rejected' ? 'bg-red-500' : 'bg-green-500'} rounded-full mt-1.5"></div>
                                <div>
                                    <div class="font-semibold text-gray-900">Auction Results</div>
                                    <div class="text-gray-500 text-xs">20th January 2026</div>
                                </div>
                            </div>
                            ${bid.status !== 'rejected' ? `
                                <div class="flex gap-3 text-sm">
                                    <div class="w-2 h-2 bg-gray-300 rounded-full mt-1.5"></div>
                                    <div>
                                        <div class="font-semibold text-gray-400">Campaign Live</div>
                                        <div class="text-gray-500 text-xs">${bid.date}</div>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;

            // Show drawer
            overlay.classList.remove('hidden');
            setTimeout(() => {
                drawer.classList.remove('translate-x-full');
            }, 10);
        };

        window.closeTakeoverDetailsDrawer = function() {
            const overlay = document.getElementById('takeover-details-overlay');
            const drawer = document.getElementById('takeover-details-drawer');
            
            if (drawer) drawer.classList.add('translate-x-full');
            setTimeout(() => {
                if (overlay) overlay.classList.add('hidden');
            }, 300);
        };

    })();

// --- BIDDING SECTION LOGIC ---
    
    // 1. Function to Add a Row
    function addBiddingRow(keyword = '', match = 'Exact', bid = '0') {
        const container = document.getElementById('bidding-rows-container');
        if(!container) return;

        const row = document.createElement('div');
        row.className = "grid grid-cols-12 gap-3 items-center animate-fade-in";
        row.innerHTML = `
            <div class="col-span-6">
                <input type="text" value="${keyword}" class="w-full border border-gray-300 rounded-lg px-3 py-2.5 text-sm focus:border-primary focus:outline-none" placeholder="Enter keyword">
            </div>
            <div class="col-span-3">
                <div class="relative">
                    <select class="w-full border border-gray-300 rounded-lg px-3 py-2.5 text-sm focus:border-primary focus:outline-none bg-white appearance-none cursor-pointer">
                        <option ${match === 'Exact' ? 'selected' : ''}>Exact</option>
                        <option ${match === 'Broad' ? 'selected' : ''}>Broad</option>
                        <option ${match === 'Phrase' ? 'selected' : ''}>Phrase</option>
                    </select>
                    <i class="ri-arrow-down-s-line absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"></i>
                </div>
            </div>
            <div class="col-span-2">
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-xs"></span>
                    <input type="number" value="${bid}" class="w-full border border-gray-300 rounded-lg pl-6 pr-3 py-2.5 text-sm focus:border-primary focus:outline-none">
                </div>
            </div>
            <div class="col-span-1 flex justify-center">
                <button onclick="this.closest('.grid').remove()" class="text-gray-400 hover:text-red-500 transition p-2 rounded-full hover:bg-red-50">
                    <i class="ri-delete-bin-line text-lg"></i>
                </button>
            </div>
        `;
        container.appendChild(row);
    }

    // 2. Initialize with one empty row when the Bidding Accordion is opened
    // (We hook into the existing toggle function logic or just run it once safely)
    document.addEventListener('DOMContentLoaded', () => {
        // Check if container exists (in case we navigated back/forth)
        if(document.getElementById('bidding-rows-container')) {
            // Add one default row
            addBiddingRow();
        }
    });
// --- SMART SHOPPING STEPPER LOGIC ---
    let ssCurrentStep = 1;
    function ssWizardNav(direction) {
        if (direction === 1 && ssCurrentStep < 4) ssCurrentStep++;
        else if (direction === -1 && ssCurrentStep > 1) ssCurrentStep--;
        else if (direction === 1 && ssCurrentStep === 4) {
            alert('Smart Shopping Campaign Created!');
            navigateTo('performance', 'nav-camp');
            return;
        }
        updateWizardUI('ss', ssCurrentStep);
    }

    // --- SEARCH ONLY STEPPER LOGIC ---
    let soCurrentStep = 1;
    function soWizardNav(direction) {
        if (direction === 1 && soCurrentStep < 4) soCurrentStep++;
        else if (direction === -1 && soCurrentStep > 1) soCurrentStep--;
        else if (direction === 1 && soCurrentStep === 4) {
            alert('Search Only Campaign Created!');
            navigateTo('performance', 'nav-camp');
            return;
        }
        updateWizardUI('so', soCurrentStep);
    }

    // --- SHARED UI UPDATER (Fixes "Hidden" Steps) ---
    function updateWizardUI(prefix, step) {
        // 1. Headers
        document.querySelectorAll(`#${prefix}-stepper .cc-step`).forEach(el => {
            el.classList.toggle('active', parseInt(el.dataset.step) === step);
        });
        
        // 2. Content Visibility (Explicit display block/none)
        for(let i=1; i<=4; i++) {
            const content = document.getElementById(`${prefix}-step-${i}`);
            if(content) {
                if(i === step) {
                    content.classList.add('active');
                    content.style.display = 'block';
                } else {
                    content.classList.remove('active');
                    content.style.display = 'none';
                }
            }
        }
        
        // 3. Buttons
        const back = document.getElementById(`${prefix}-back-btn`);
        const next = document.getElementById(`${prefix}-next-btn`);
        if(back) back.style.display = step > 1 ? 'block' : 'none';
        if(next) next.textContent = step === 4 ? 'Save & Launch' : 'Next';
    }
// --- UNIFIED PRODUCT SELECTION LOGIC ---

// 1. Switch Views (Filter vs Individual)
function toggleProductView(value, filterId, indivId, labelId) {
    const filters = document.getElementById(filterId);
    const indiv = document.getElementById(indivId);
    const label = document.getElementById(labelId);

    if (value === 'filters') {
        filters.style.display = 'block';
        indiv.style.display = 'none';
    } else {
        filters.style.display = 'none';
        indiv.style.display = 'block';
        
        if (value === 'exclude') {
            label.innerHTML = 'Select products to <span class="text-red-500 font-bold">EXCLUDE</span> from this campaign';
        } else {
            label.innerHTML = 'Select products to <span class="text-gray-500 font-bold">INCLUDE</span> in this campaign';
        }
    }
}

// 2. Add Filter Row (Generic)
function addFilterRowGeneric(containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    const row = document.createElement('div');
    row.className = "grid grid-cols-12 gap-3 items-center mb-3 animate-fade-in";
    row.innerHTML = `
        <div class="col-span-3 relative"><select class="w-full border border-gray-200 rounded px-3 py-2 text-sm focus:border-primary outline-none bg-white appearance-none"><option>Product Name</option><option>Category</option><option>Price</option></select><i class="ri-arrow-down-s-line absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i></div>
        <div class="col-span-3 relative"><select class="w-full border border-gray-200 rounded px-3 py-2 text-sm focus:border-primary outline-none bg-white appearance-none"><option>contains</option><option>equals</option></select><i class="ri-arrow-down-s-line absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i></div>
        <div class="col-span-5"><input type="text" class="w-full border border-gray-200 rounded px-3 py-2 text-sm focus:border-primary outline-none" placeholder="Value"></div>
        <div class="col-span-1"><button onclick="this.closest('.grid').remove()" class="text-gray-400 hover:text-red-500 transition"><i class="ri-delete-bin-line text-lg"></i></button></div>
    `;
    container.appendChild(row);
}

// 3. Open Modal with Target context
let currentProductTargetBody = '';
let currentProductTargetList = '';
let currentProductTargetCount = '';

function openProductModal(targetBodyId, targetListId, targetCountId) {
    // If arguments provided, set them (for Creator flow)
    if(targetBodyId) {
        currentProductTargetBody = targetBodyId;
        currentProductTargetList = targetListId;
        currentProductTargetCount = targetCountId;
    } 
    // Fallback for older calls
    else {
        currentProductTargetBody = 'ps-selected-tbody';
        currentProductTargetList = 'ps-selected-list';
        currentProductTargetCount = 'selected-count';
    }

    const modal = document.getElementById('productModal'); 
    if(modal) {
        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.remove('opacity-0');
            modal.children[0].classList.remove('scale-95');
            modal.children[0].classList.add('scale-100');
        }, 10);
    }
}

function addSelectedProducts() {
    // Generic adder that knows which table to populate based on openProductModal call
    const rows = document.querySelectorAll('#productModal tbody tr');
    const tb = document.getElementById(currentProductTargetBody);
    const listDiv = document.getElementById(currentProductTargetList);
    const countSpan = document.getElementById(currentProductTargetCount);

    if(!tb) return;

    let added = false;
    rows.forEach(r => {
        const cb = r.querySelector('input[type="checkbox"]');
        if(cb.checked) {
            added = true;
            const cells = r.querySelectorAll('td');
            const img = cells[1].innerHTML;
            const name = cells[2].innerText;
            const cat = cells[3].innerText;
            const price = cells[6].innerText; // Sale Price

            const tr = document.createElement('tr');
            tr.className = "hover:bg-gray-50 border-b border-gray-100";
            tr.innerHTML = `<td class="p-3 flex items-center gap-3">${img} <span class="font-medium text-gray-900">${name}</span></td><td class="p-3 text-gray-500">${cat}</td><td class="p-3 font-bold text-gray-900">${price}</td><td class="p-3 text-green-600 font-bold text-[10px]">In Stock</td><td class="p-3 text-center"><button onclick="this.closest('tr').remove(); updateGenericCount('${currentProductTargetBody}', '${currentProductTargetCount}', '${currentProductTargetList}')" class="text-gray-400 hover:text-red-500"><i class="ri-delete-bin-line"></i></button></td>`;
            tb.appendChild(tr);
        }
    });

    if(added) {
        listDiv.classList.remove('hidden');
        updateGenericCount(currentProductTargetBody, currentProductTargetCount, currentProductTargetList);
        closeProductModal();
    } else {
        alert("Please select at least one product.");
    }
}

function updateGenericCount(tbodyId, countId, listId) {
    const tb = document.getElementById(tbodyId);
    const count = document.getElementById(countId);
    const list = document.getElementById(listId);
    
    if(tb && count) {
        count.innerText = tb.children.length;
        if(tb.children.length === 0) list.classList.add('hidden');
    }
}

function clearSelectedGeneric(tbodyId, listId) {
    document.getElementById(tbodyId).innerHTML = '';
    document.getElementById(listId).classList.add('hidden');
}

// ==========================================
    // 4. WIZARD SIDEBAR LOGIC (SCROLL SPY)
    // ==========================================
    
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize all split wizards
        const splitContainers = document.querySelectorAll('.wizard-body-split');
        
        splitContainers.forEach(container => {
            const sidebarItems = container.querySelectorAll('.wiz-toc-item, .wiz-nav-item');
            const contentArea = container.querySelector('.wizard-content-area');
            const cards = container.querySelectorAll('.wiz-section-card, .wiz-card');

            // 1. Click to Scroll
            sidebarItems.forEach((item, index) => {
                item.addEventListener('click', () => {
                    // Remove active class from all
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    // Add to clicked
                    item.classList.add('active');
                    
                    // Scroll target card into view
                    if(cards[index]) {
                        cards[index].scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            // 2. Optional: Scroll to highlight (Simple version)
            if(contentArea) {
                contentArea.addEventListener('scroll', () => {
                    let current = "";
                    cards.forEach((card, index) => {
                        const cardTop = card.offsetTop - contentArea.offsetTop;
                        if (contentArea.scrollTop >= cardTop - 60) {
                            sidebarItems.forEach(i => i.classList.remove('active'));
                            if(sidebarItems[index]) sidebarItems[index].classList.add('active');
                        }
                    });
                });
            }
        });
    });
// --- GENERIC FILTER ROW ADDER (Required for Smart Shopping & Search Only) ---
    window.addFilterRowGeneric = function(containerId) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        const row = document.createElement('div');
        row.className = "grid grid-cols-12 gap-3 items-center mb-3 animate-fade-in";
        row.innerHTML = `
            <div class="col-span-3 relative">
                <select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none;">
                    <option>Product Name</option>
                    <option>Category</option>
                    <option>Price</option>
                </select>
                <i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none"></i>
            </div>
            <div class="col-span-3 relative">
                <select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none;">
                    <option>contains</option>
                    <option>equals</option>
                </select>
                <i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none"></i>
            </div>
            <div class="col-span-5">
                <input type="text" class="clean-input" placeholder="Value">
            </div>
            <div class="col-span-1">
                <button onclick="this.closest('.grid').remove()" class="w-8 h-8 rounded-full text-gray-400 hover:text-red-500 hover:bg-red-50 flex items-center justify-center transition">
                    <i class="ri-delete-bin-line text-lg"></i>
                </button>
            </div>
        `;
        container.appendChild(row);
    };
// --- FORCE FIX: SEARCH ONLY FILTER ENGINE ---
    // This makes the + buttons work even if other parts of the dashboard have errors.
    window.addFilterRowGeneric = function(containerId) {
        console.log("Adding filter row to:", containerId); // Debug check
        
        const container = document.getElementById(containerId);
        if (!container) {
            console.error("Container not found:", containerId);
            return;
        }
        
        const row = document.createElement('div');
        row.className = "grid grid-cols-12 gap-3 items-center mb-3 animate-fade-in";
        row.innerHTML = `
            <div class="col-span-3 relative">
                <select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none; width:100%; border-bottom:1px solid #e2e8f0; padding:10px 0;">
                    <option>Product Name</option>
                    <option>Category</option>
                    <option>Price</option>
                </select>
                <i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none text-gray-400"></i>
            </div>
            <div class="col-span-3 relative">
                <select class="clean-input bg-white" style="-webkit-appearance: none; appearance: none; width:100%; border-bottom:1px solid #e2e8f0; padding:10px 0;">
                    <option>contains</option>
                    <option>equals</option>
                </select>
                <i class="ri-arrow-down-s-line absolute right-0 top-3 pointer-events-none text-gray-400"></i>
            </div>
            <div class="col-span-5">
                <input type="text" class="clean-input" placeholder="Enter value..." style="width:100%; border-bottom:1px solid #e2e8f0; padding:10px 0;">
            </div>
            <div class="col-span-1">
                <button onclick="this.closest('.grid').remove()" class="w-8 h-8 rounded-full text-gray-400 hover:text-red-500 hover:bg-red-50 flex items-center justify-center transition">
                    <i class="ri-delete-bin-line text-lg"></i>
                </button>
            </div>
        `;
        container.appendChild(row);
    };
</script>
</body>
</html>